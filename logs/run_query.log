2025-12-19 20:45:13,395 | INFO    | RUN_QUERY | 
2025-12-19 20:44:57,656 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
Running query: except_distinct
2025-12-19 20:45:13,529 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-19 20:45:13,570 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-19 20:45:16,913 | INFO    | RUN_QUERY | ‚úÖ Running testcases for table 'agency'
2025-12-19 20:45:16,914 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-19 20:45:16,922 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-19 20:45:16,923 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-19 20:45:16,929 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-19 20:45:16,931 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-19 20:45:18,845 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-19 20:45:18,851 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-19 20:45:18,852 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-19 20:45:18,859 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-19 20:45:18,860 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-19 20:45:20,576 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-19 20:45:20,585 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251219_204513.csv
2025-12-19 20:45:20,587 | INFO    | RUN_QUERY | Finished query: except_distinct in 7.19 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251219_204513.csv
2025-12-19 20:47:31,379 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-19 20:47:46,817 | INFO    | RUN_QUERY | 
Running query: expect_distinct
2025-12-19 20:47:47,166 | ERROR   | RUN_QUERY | Error running query expect_distinct: SQL file 'sqls\expect_distinct.sql' not found
2025-12-19 20:48:20,620 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-19 20:48:29,524 | INFO    | RUN_QUERY | 
Running query: excett_distinct
2025-12-19 20:48:29,800 | ERROR   | RUN_QUERY | Error running query excett_distinct: SQL file 'sqls\excett_distinct.sql' not found
2025-12-19 20:48:46,841 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-19 20:48:55,615 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-19 20:48:55,775 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-19 20:48:55,821 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-19 20:48:59,694 | INFO    | RUN_QUERY | ‚úÖ Running testcases for table 'agency'
2025-12-19 20:48:59,695 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-19 20:48:59,705 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-19 20:48:59,707 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-19 20:48:59,714 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-19 20:48:59,715 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-19 20:49:01,467 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-19 20:49:01,481 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-19 20:49:01,483 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-19 20:49:01,501 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-19 20:49:01,503 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-19 20:49:03,822 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-19 20:49:03,967 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251219_204855.csv
2025-12-19 20:49:03,996 | INFO    | RUN_QUERY | Finished query: except_distinct in 8.37 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251219_204855.csv
2025-12-22 20:03:49,201 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-22 20:04:10,693 | INFO    | RUN_QUERY | 
Running query: count
2025-12-22 20:04:10,899 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:04:10,925 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-22 20:05:25,293 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_think_nq_count_20251222_200410.sql

2025-12-22 20:05:25,294 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2025-12-22 20:05:25,310 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-22 20:05:25,311 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:05:25,312 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251222_200410.csv
2025-12-22 20:05:25,313 | INFO    | RUN_QUERY | Finished query: count in 74.59 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251222_200410.csv
2025-12-22 20:09:11,422 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-22 20:09:22,117 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-22 20:09:23,453 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:09:23,503 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-22 20:09:28,514 | INFO    | RUN_QUERY | ‚úÖ Running testcases for table 'agency'
2025-12-22 20:09:28,515 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-22 20:09:28,528 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:09:28,529 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:09:28,540 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-22 20:09:28,542 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:09:30,316 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:09:30,324 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:09:30,326 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:09:30,331 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-22 20:09:30,333 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:09:32,146 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:09:32,161 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251222_200922.csv
2025-12-22 20:09:32,162 | INFO    | RUN_QUERY | Finished query: except_distinct in 10.00 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251222_200922.csv
2025-12-22 20:10:39,273 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-22 20:10:49,539 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-22 20:10:49,659 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:10:49,697 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-22 20:10:54,529 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'agency'
2025-12-22 20:10:54,530 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-22 20:10:54,536 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:10:54,538 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:10:54,545 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-22 20:10:54,546 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:10:56,566 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:10:56,577 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:10:56,578 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:10:56,588 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-22 20:10:56,590 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:10:58,212 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:10:58,244 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251222_201049.csv
2025-12-22 20:10:58,248 | INFO    | RUN_QUERY | Finished query: except_distinct in 8.71 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251222_201049.csv
2025-12-22 20:12:11,590 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-22 20:12:20,646 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-22 20:12:20,768 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:12:20,813 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-22 20:12:24,025 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'address_'
2025-12-22 20:12:24,026 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-22 20:12:24,030 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:12:24,032 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:12:24,036 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-22 20:12:24,037 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:12:25,951 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:12:25,955 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:12:25,956 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:12:25,960 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-22 20:12:25,961 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:12:27,771 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:12:27,775 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:12:27,779 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:12:27,787 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-22 20:12:27,789 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:12:29,704 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:12:29,708 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-22 20:12:29,709 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-22 20:12:29,713 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-22 20:12:29,714 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-22 20:12:31,426 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-22 20:12:31,430 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251222_201220.csv
2025-12-22 20:12:31,431 | INFO    | RUN_QUERY | Finished query: except_distinct in 10.78 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251222_201220.csv
2025-12-23 08:39:32,925 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 08:39:55,327 | INFO    | RUN_QUERY | 
Running query: undefined
2025-12-23 08:39:55,332 | ERROR   | RUN_QUERY | Error running query undefined: SQL file 'sqls\undefined.sql' not found
2025-12-23 08:41:43,442 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 08:41:57,134 | INFO    | RUN_QUERY | 
Running query: undefined
2025-12-23 08:41:57,136 | ERROR   | RUN_QUERY | Error running query undefined: SQL file 'sqls\undefined.sql' not found
2025-12-23 08:42:19,874 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 08:42:29,939 | INFO    | RUN_QUERY | 
Running query: undefined
2025-12-23 08:42:29,940 | ERROR   | RUN_QUERY | Error running query undefined: SQL file 'sqls\undefined.sql' not found
2025-12-23 08:43:52,350 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 08:44:01,339 | INFO    | RUN_QUERY | 
Running query: undefined
2025-12-23 08:44:01,341 | ERROR   | RUN_QUERY | Error running query undefined: SQL file 'sqls\undefined.sql' not found
2025-12-23 08:59:34,953 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 08:59:55,270 | INFO    | RUN_QUERY | 
Running query: count
2025-12-23 08:59:55,430 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 08:59:55,462 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:01:05,163 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_085955.sql

2025-12-23 09:01:05,164 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2025-12-23 09:01:05,497 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:01:05,499 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:01:05,509 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_085955.csv
2025-12-23 09:01:05,509 | INFO    | RUN_QUERY | Finished query: count in 70.21 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_085955.csv
2025-12-23 09:03:28,319 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 09:03:46,408 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 09:03:46,789 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:03:46,834 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 09:03:51,566 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'address_'
2025-12-23 09:03:51,567 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 09:03:51,574 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:03:51,575 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:03:51,582 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 09:03:51,583 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:03:53,425 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:03:53,431 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:03:53,432 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:03:53,439 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 09:03:53,439 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:03:54,966 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:03:54,970 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:03:54,971 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:03:54,975 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 09:03:54,976 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:03:56,690 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:03:56,696 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:03:56,697 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:03:56,704 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 09:03:56,705 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:03:58,232 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:03:58,243 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_090346.csv
2025-12-23 09:03:58,244 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.59 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_090346.csv
2025-12-23 09:08:34,371 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 09:08:46,473 | INFO    | RUN_QUERY | 
Running query: count
2025-12-23 09:08:46,584 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:08:46,611 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:09:49,073 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_090846.sql

2025-12-23 09:09:49,073 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2025-12-23 09:09:49,089 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:09:49,091 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:09:49,092 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_090846.csv
2025-12-23 09:09:49,093 | INFO    | RUN_QUERY | Finished query: count in 62.61 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_090846.csv
2025-12-23 09:10:47,359 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 09:10:58,418 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 09:10:58,566 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:10:58,628 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 09:11:02,415 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'address_'
2025-12-23 09:11:02,415 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 09:11:02,421 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:11:02,422 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:11:02,426 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 09:11:02,427 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:11:04,458 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:11:04,466 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:11:04,467 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:11:04,475 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 09:11:04,476 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:11:06,211 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:11:06,215 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:11:06,217 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:11:06,224 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 09:11:06,226 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:11:07,843 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:11:07,847 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 09:11:07,848 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:11:07,852 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 09:11:07,853 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:11:09,470 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 09:11:09,479 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_091058.csv
2025-12-23 09:11:09,480 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.06 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_091058.csv
2025-12-23 09:12:53,622 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 09:13:03,554 | INFO    | RUN_QUERY | 
Running query: count
2025-12-23 09:13:03,652 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:13:03,679 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:14:17,361 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_091303.sql

2025-12-23 09:14:17,361 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2025-12-23 09:14:17,389 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:14:17,391 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:14:17,392 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_091303.csv
2025-12-23 09:14:17,393 | INFO    | RUN_QUERY | Finished query: count in 73.84 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_091303.csv
2025-12-23 09:21:54,227 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 09:22:07,423 | INFO    | RUN_QUERY | 
Running query: count
2025-12-23 09:22:07,534 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:22:07,564 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:23:21,551 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_092207.sql

2025-12-23 09:23:21,551 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2025-12-23 09:23:21,587 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 09:23:21,589 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 09:23:21,592 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_092207.csv
2025-12-23 09:23:21,593 | INFO    | RUN_QUERY | Finished query: count in 74.17 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_092207.csv
2025-12-23 09:25:00,059 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 09:25:14,177 | INFO    | RUN_QUERY | 
Running query: schema_compare
2025-12-23 09:25:14,417 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 09:25:14,447 | INFO    | RUN_QUERY | WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2025-12-23 09:25:20,284 | INFO    | RUN_QUERY | 
üìÅ Schema differences saved: output/failed_testcases\sdm_think_nq_schema_compare_20251223_092514_schema_diff.csv
2025-12-23 09:25:20,284 | INFO    | RUN_QUERY | Finished query: schema_compare in 6.00 seconds, CSV saved at output\testcase_results\sdm_think_nq_schema_compare_20251223_092514.csv
2025-12-23 11:22:24,553 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 11:22:40,761 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 11:22:41,030 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:22:41,071 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 11:22:45,222 | INFO    | RUN_QUERY | ‚úÖ Running testcases for table 'agency'
2025-12-23 11:22:45,224 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 11:22:45,236 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:22:45,237 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:22:45,246 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:22:45,248 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:22:46,975 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:22:46,985 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí agency ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:22:46,986 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:22:46,993 | INFO    | RUN_QUERY | SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "agency" AS TABLE_NAME,
       `customer_id`,
       `payment_threshold`,
       `agency_code`,
       `remit`,
       `discounts`,
       `accept_ord`,
       `agency_pays_tax`,
       `tax_based_on_gross`,
       `agency_bill_to`,
       `agency_renew_to`,
       `ren_commission`,
       `new_commission`,
       `company`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:22:46,994 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:22:48,786 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:22:48,833 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_112240.csv
2025-12-23 11:22:48,834 | INFO    | RUN_QUERY | Finished query: except_distinct in 8.06 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_112240.csv
2025-12-23 11:47:10,176 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 11:47:22,737 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 11:47:22,894 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:47:22,919 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 11:47:26,978 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 11:47:26,981 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 11:47:26,989 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:47:26,991 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:47:26,997 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:47:26,998 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:47:28,834 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:47:28,853 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:47:28,856 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:47:28,863 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:47:28,866 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:47:30,585 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:47:30,590 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:47:30,591 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:47:30,596 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:47:30,597 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:47:32,266 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:47:32,271 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:47:32,272 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:47:32,276 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:47:32,277 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:47:34,069 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:47:34,069 | ERROR   | RUN_QUERY | Error running query except_distinct: can only concatenate list (not "str") to list
2025-12-23 11:52:24,327 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 11:52:35,689 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 11:52:35,861 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:52:35,905 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 11:52:39,327 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 11:52:39,328 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 11:52:39,335 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:52:39,336 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:52:39,343 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:52:39,346 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:52:41,055 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:52:41,064 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:52:41,065 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:52:41,073 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:52:41,075 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:52:42,834 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:52:42,840 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:52:42,841 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:52:42,845 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:52:42,846 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:52:44,462 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:52:44,469 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:52:44,471 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:52:44,478 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:52:44,480 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:52:46,149 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:52:46,151 | ERROR   | RUN_QUERY | Error running query except_distinct: 'set' object has no attribute 'keys'
2025-12-23 11:53:50,987 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 11:54:03,808 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 11:54:04,305 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:54:04,379 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 11:54:11,068 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 11:54:11,070 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 11:54:11,080 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:54:11,081 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:54:11,087 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:54:11,088 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:54:13,138 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:54:13,291 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:54:13,293 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:54:13,300 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:54:13,300 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:54:14,999 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:54:15,004 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:54:15,005 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:54:15,011 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:54:15,012 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:54:16,644 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:54:16,649 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:54:16,650 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:54:16,659 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:54:16,661 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:54:18,282 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:54:18,286 | ERROR   | RUN_QUERY | Error running query except_distinct: 'str' object has no attribute 'keys'
2025-12-23 11:55:11,863 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 11:55:22,251 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 11:55:22,411 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:55:22,454 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 11:55:26,193 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 11:55:26,194 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 11:55:26,199 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:55:26,200 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:55:26,205 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:55:26,206 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:55:28,179 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:55:28,185 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:55:28,186 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:55:28,191 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:55:28,192 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:55:29,708 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:55:29,713 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:55:29,715 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:55:29,719 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 11:55:29,721 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:55:31,273 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:55:31,281 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 11:55:31,282 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 11:55:31,286 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 11:55:31,286 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 11:55:32,908 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 11:55:32,921 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_115522.csv
2025-12-23 11:55:32,922 | INFO    | RUN_QUERY | Finished query: except_distinct in 10.66 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_115522.csv
2025-12-23 12:00:20,201 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:00:41,063 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:00:42,404 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:00:42,441 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:00:46,681 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:00:46,681 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:00:46,690 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:00:46,691 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:00:46,698 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:00:46,699 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:00:49,207 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:00:49,247 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:00:49,248 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:00:49,258 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:00:49,259 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:00:51,018 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:00:51,038 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:00:51,040 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:00:51,046 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:00:51,047 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:00:54,663 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:00:55,515 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:00:55,518 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:00:55,528 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:00:55,529 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:00:57,254 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:00:57,498 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_120041.csv
2025-12-23 12:00:57,499 | INFO    | RUN_QUERY | Finished query: except_distinct in 15.93 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_120041.csv
2025-12-23 12:07:46,846 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:08:01,784 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:08:01,952 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:08:01,990 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:08:06,568 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:08:06,568 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:08:06,579 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:08:06,580 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:08:06,601 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:08:06,602 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:08:08,556 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:08:08,571 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:08:08,572 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:08:08,579 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:08:08,580 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:08:10,235 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:08:10,251 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:08:10,252 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:08:10,258 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:08:10,259 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:08:11,921 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:08:12,002 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:08:12,004 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:08:12,011 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:08:12,013 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:08:13,574 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:08:13,596 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_120801.csv
2025-12-23 12:08:13,598 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.78 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_120801.csv
2025-12-23 12:17:28,019 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:17:41,998 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:17:42,164 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:17:42,214 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:17:46,084 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:17:46,084 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:17:46,092 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:17:46,093 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:17:46,099 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:17:46,100 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:17:47,694 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:17:47,704 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:17:47,705 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:17:47,710 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:17:47,710 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:17:49,228 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:17:49,233 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:17:49,238 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:17:49,242 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:17:49,243 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:17:50,758 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:17:50,765 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:17:50,766 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:17:50,770 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:17:50,771 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:17:52,283 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:17:52,299 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_121742.csv
2025-12-23 12:17:52,300 | INFO    | RUN_QUERY | Finished query: except_distinct in 10.30 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_121742.csv
2025-12-23 12:26:34,595 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:28:19,328 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:28:36,936 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:28:47,547 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:28:48,195 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:28:48,240 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:28:52,097 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:28:52,098 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:28:52,105 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:28:52,106 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:28:52,110 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:28:52,111 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:28:53,871 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:28:53,877 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:28:53,878 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:28:53,884 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:28:53,884 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:28:55,313 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:28:55,322 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:28:55,323 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:28:55,331 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:28:55,332 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:28:57,058 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:28:57,064 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:28:57,065 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:28:57,072 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:28:57,074 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:28:58,899 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:28:58,919 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_122847.csv
2025-12-23 12:28:58,922 | INFO    | RUN_QUERY | Finished query: except_distinct in 10.99 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_122847.csv
2025-12-23 12:31:03,160 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:31:18,334 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:31:18,501 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:31:18,546 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:31:22,513 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:31:22,710 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:31:22,772 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:31:22,774 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:31:22,906 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:31:22,922 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:31:25,186 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:31:25,197 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:31:25,199 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:31:25,207 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:31:25,208 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:31:26,957 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:31:26,965 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:31:26,966 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:31:26,974 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:31:26,975 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:31:28,443 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:31:28,448 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:31:28,451 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:31:28,458 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:31:28,460 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:31:30,009 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:31:30,063 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_123118.csv
2025-12-23 12:31:30,064 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.72 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_123118.csv
2025-12-23 12:33:52,845 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:34:02,363 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:34:02,905 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:34:02,951 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:34:07,160 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:34:07,162 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:34:07,243 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:34:07,244 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:34:07,280 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:34:07,286 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:34:08,978 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:34:08,989 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:34:08,991 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:34:08,996 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:34:08,999 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:34:10,638 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:34:10,644 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:34:10,645 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:34:10,659 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:34:10,660 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:34:12,176 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:34:12,183 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:34:12,185 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:34:12,192 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:34:12,193 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:34:13,925 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:34:13,939 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_123402.csv
2025-12-23 12:34:13,940 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.56 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_123402.csv
2025-12-23 12:36:26,681 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:36:36,044 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:36:36,156 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:36:36,198 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:36:39,021 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:36:39,023 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:36:39,035 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:36:39,036 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:36:39,042 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:36:39,044 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:36:40,900 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:36:40,910 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:36:40,911 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:36:40,915 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:36:40,918 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:36:42,438 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:36:42,443 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:36:42,445 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:36:42,450 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:36:42,451 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:36:44,201 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:36:44,209 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:36:44,210 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:36:44,221 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:36:44,222 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:36:45,660 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:36:45,672 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_123636.csv
2025-12-23 12:36:45,673 | INFO    | RUN_QUERY | Finished query: except_distinct in 9.62 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_123636.csv
2025-12-23 12:37:36,041 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:37:45,822 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:37:45,949 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:37:46,001 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:37:49,362 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:37:49,363 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:37:49,453 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:37:49,454 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:37:49,462 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:37:49,463 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:37:51,101 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:37:51,108 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:37:51,109 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:37:51,114 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:37:51,115 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:37:52,534 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:37:52,540 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:37:52,541 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:37:52,549 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:37:52,550 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:37:54,065 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:37:54,071 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:37:54,072 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:37:54,078 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:37:54,079 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:37:55,590 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:37:55,600 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_123745.csv
2025-12-23 12:37:55,601 | INFO    | RUN_QUERY | Finished query: except_distinct in 9.77 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_123745.csv
2025-12-23 12:40:37,743 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:40:55,297 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:40:55,496 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:40:55,537 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:40:59,099 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:40:59,101 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:40:59,114 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:40:59,118 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:40:59,128 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:40:59,129 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:41:00,771 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:41:00,777 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:41:00,779 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:41:00,787 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:41:00,788 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:41:02,408 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:41:02,413 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:41:02,414 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:41:02,419 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:41:02,420 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:41:04,244 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:41:04,249 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:41:04,251 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:41:04,255 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:41:04,256 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:41:05,989 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:41:06,399 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_124055.csv
2025-12-23 12:41:07,280 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.94 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_124055.csv
2025-12-23 12:41:44,517 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:41:54,356 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:41:55,111 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:41:55,157 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:41:58,000 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2025-12-23 12:41:58,002 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:41:58,014 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:41:58,015 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:41:58,023 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:41:58,025 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:41:59,739 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:41:59,750 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:41:59,753 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:41:59,761 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:41:59,763 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:42:01,292 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:42:01,297 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:42:01,298 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:42:01,305 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";
2025-12-23 12:42:01,306 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:42:03,475 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:42:03,520 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:42:03,521 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:42:03,531 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";
2025-12-23 12:42:03,532 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:42:05,185 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:42:05,217 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_124154.csv
2025-12-23 12:42:05,220 | INFO    | RUN_QUERY | Finished query: except_distinct in 10.78 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_124154.csv
2025-12-23 12:42:42,585 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:42:52,338 | INFO    | RUN_QUERY | 
Running query: schema_compare
2025-12-23 12:42:52,435 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:42:52,468 | INFO    | RUN_QUERY | WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2025-12-23 12:42:58,466 | INFO    | RUN_QUERY | 
üìÅ Schema differences saved: output/failed_testcases\sdm_think_nq_schema_compare_20251223_124252_schema_diff.csv
2025-12-23 12:42:58,467 | INFO    | RUN_QUERY | Finished query: schema_compare in 6.12 seconds, CSV saved at output\testcase_results\sdm_think_nq_schema_compare_20251223_124252.csv
2025-12-23 12:43:21,937 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:43:37,403 | INFO    | RUN_QUERY | 
Running query: count
2025-12-23 12:43:37,527 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:43:37,565 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 12:44:51,248 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_124337.sql

2025-12-23 12:44:51,249 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2025-12-23 12:44:51,264 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2025-12-23 12:44:51,266 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:44:51,268 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_124337.csv
2025-12-23 12:44:51,269 | INFO    | RUN_QUERY | Finished query: count in 73.85 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_124337.csv
2025-12-23 12:53:08,684 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2025-12-23 12:53:22,150 | INFO    | RUN_QUERY | 
Running query: except_distinct
2025-12-23 12:53:22,269 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:53:22,307 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2025-12-23 12:53:31,919 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'address_'
2025-12-23 12:53:31,919 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2025-12-23 12:53:31,924 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:53:31,925 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:53:31,930 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";
2025-12-23 12:53:31,931 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:53:33,945 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:53:33,949 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_status ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:53:33,950 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:53:33,955 | INFO    | RUN_QUERY | SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"
EXCEPT DISTINCT
SELECT "address_status" AS TABLE_NAME,
       `address_status`,
       `description`,
       `address_undeliverable`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";
2025-12-23 12:53:33,956 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:53:35,766 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:53:35,770 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:53:35,771 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:53:35,775 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";
2025-12-23 12:53:35,776 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:53:37,589 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:53:37,593 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí address_type ‚ñ∂‚ñ∂‚ñ∂
2025-12-23 12:53:37,594 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2025-12-23 12:53:37,602 | INFO    | RUN_QUERY | SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"
EXCEPT DISTINCT
SELECT "address_type" AS TABLE_NAME,
       `address_type`,
       `description`,
       `row_version`
FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";
2025-12-23 12:53:37,604 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2025-12-23 12:53:39,313 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2025-12-23 12:53:39,331 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_125322.csv
2025-12-23 12:53:39,333 | INFO    | RUN_QUERY | Finished query: except_distinct in 17.18 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_125322.csv
2026-01-08 08:42:38,178 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 08:42:52,401 | INFO    | RUN_QUERY | 
Running query: count
2026-01-08 08:42:52,594 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 08:42:52,619 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm__nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm__nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2026-01-08 08:42:54,536 | ERROR   | RUN_QUERY | Error running query count: 404 Not found: Dataset ncau-data-newsquery-sit:sdm__nq was not found in location US; reason: notFound, message: Not found: Dataset ncau-data-newsquery-sit:sdm__nq was not found in location US

Location: US
Job ID: f5297ee2-7e9b-46a0-804b-db2c2f11a4fb

2026-01-08 08:44:02,749 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 08:44:32,577 | INFO    | RUN_QUERY | 
Running query: count
2026-01-08 08:44:32,824 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 08:44:32,862 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2026-01-08 08:44:39,895 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_rcti_nq_count_20260108_084432.sql

2026-01-08 08:44:39,896 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2026-01-08 08:44:39,913 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2026-01-08 08:44:39,914 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2026-01-08 08:44:39,918 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_rcti_nq_count_20260108_084432.csv
2026-01-08 08:44:39,919 | INFO    | RUN_QUERY | Finished query: count in 7.32 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_count_20260108_084432.csv
2026-01-08 08:52:13,582 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 08:52:25,591 | INFO    | RUN_QUERY | 
Running query: count
2026-01-08 08:52:25,722 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 08:52:25,756 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2026-01-08 08:52:32,354 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_rcti_nq_count_20260108_085225.sql

2026-01-08 08:52:32,355 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2026-01-08 08:52:32,381 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1
2026-01-08 08:52:32,382 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2026-01-08 08:52:32,385 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_rcti_nq_count_20260108_085225.csv
2026-01-08 08:52:32,386 | INFO    | RUN_QUERY | Finished query: count in 6.78 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_count_20260108_085225.csv
2026-01-08 08:53:50,416 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 08:54:00,531 | INFO    | RUN_QUERY | 
Running query: count
2026-01-08 08:54:00,679 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 08:54:00,705 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1 ASC,
         3 DESC;
2026-01-08 08:54:06,986 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_rcti_nq_count_20260108_085400.sql

2026-01-08 08:54:06,989 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2026-01-08 08:54:07,025 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1 ASC,
         3 DESC;
2026-01-08 08:54:07,026 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2026-01-08 08:54:07,039 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_rcti_nq_count_20260108_085400.csv
2026-01-08 08:54:07,051 | INFO    | RUN_QUERY | Finished query: count in 6.49 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_count_20260108_085400.csv
2026-01-08 08:56:00,763 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 08:56:12,147 | INFO    | RUN_QUERY | 
Running query: count
2026-01-08 08:56:12,701 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 08:56:12,732 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-08 08:56:20,389 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_rcti_nq_count_20260108_085612.sql

2026-01-08 08:56:20,390 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2026-01-08 08:56:20,417 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-08 08:56:20,419 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2026-01-08 08:56:20,423 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_rcti_nq_count_20260108_085612.csv
2026-01-08 08:56:20,424 | INFO    | RUN_QUERY | Finished query: count in 8.19 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_count_20260108_085612.csv
2026-01-08 09:08:33,025 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 09:08:48,174 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-08 09:08:48,375 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 09:08:48,403 | INFO    | RUN_QUERY | WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-08 09:08:52,473 | INFO    | RUN_QUERY | 
üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260108_090848_schema_diff.csv
2026-01-08 09:08:52,473 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.27 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_schema_compare_20260108_090848.csv
2026-01-08 09:16:51,283 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 09:17:01,545 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-08 09:17:01,616 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 09:17:01,632 | INFO    | RUN_QUERY | WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-08 09:17:06,746 | INFO    | RUN_QUERY | 
üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260108_091701_schema_diff.csv
2026-01-08 09:17:06,747 | INFO    | RUN_QUERY | Finished query: schema_compare in 5.20 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_schema_compare_20260108_091701.csv
2026-01-08 10:58:52,221 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 10:59:12,250 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-08 10:59:12,480 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 10:59:12,506 | INFO    | RUN_QUERY | WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-08 10:59:17,421 | INFO    | RUN_QUERY | 
üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260108_105912_schema_diff.csv
2026-01-08 10:59:17,422 | INFO    | RUN_QUERY | Finished query: schema_compare in 5.13 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_schema_compare_20260108_105912.csv
2026-01-08 11:23:55,791 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 11:24:11,159 | INFO    | RUN_QUERY | 
Running query: count
2026-01-08 11:24:11,276 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 11:24:11,304 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-08 11:24:21,113 | INFO    | RUN_QUERY | 
‚ùå DIFF FOUND ‚Üí SQL saved to: output/failed_testcases\sdm_rcti_nq_count_20260108_112411.sql

2026-01-08 11:24:21,114 | INFO    | RUN_QUERY | ‚ñ∂ SQL Preview:

2026-01-08 11:24:21,130 | INFO    | RUN_QUERY | WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-08 11:24:21,132 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2026-01-08 11:24:21,133 | INFO    | RUN_QUERY | CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_rcti_nq_count_20260108_112411.csv
2026-01-08 11:24:21,134 | INFO    | RUN_QUERY | Finished query: count in 9.97 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_count_20260108_112411.csv
2026-01-08 11:28:41,329 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 11:28:50,875 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-08 11:28:51,036 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 11:28:51,074 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-08 11:28:54,090 | ERROR   | RUN_QUERY | Error running query except_distinct: ‚ùå No testcases found matching tables starting with 'address_'.
2026-01-08 11:30:32,426 | INFO    | RUN_QUERY | Started fetching and parsing all the configuration files ... 
2026-01-08 11:30:59,648 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-08 11:30:59,826 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 11:30:59,869 | INFO    | RUN_QUERY | WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-08 11:31:03,334 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_wool'
2026-01-08 11:31:03,334 | INFO    | RUN_QUERY | 
Executing EXCEPT DISTINCT testcases...

2026-01-08 11:31:03,342 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [prod-SIT] for table ‚Üí rcti_woolies_bluebook_ext ‚ñ∂‚ñ∂‚ñ∂
2026-01-08 11:31:03,343 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 11:31:03,352 | INFO    | RUN_QUERY | SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,
       `pubid`,
       `pubdate`,
       `routeid`,
       `periodsalescharge`,
       `perioddrawcopycount`,
       `periodsalescopycount`,
       `periodreturns`,
       `periodchargerate`,
       `periodrevenuecharge`,
       `periodreturnscharge`,
       `prevperioddrawcopycount`,
       `prevperiodsalescopycount`,
       `prevperiodreturns`,
       `prevperiodchargerate`,
       `prevperiodrevenuecharge`,
       `prevperiodreturnscharge`
FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"
EXCEPT DISTINCT
SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,
       `pubid`,
       `pubdate`,
       `routeid`,
       `periodsalescharge`,
       `perioddrawcopycount`,
       `periodsalescopycount`,
       `periodreturns`,
       `periodchargerate`,
       `periodrevenuecharge`,
       `periodreturnscharge`,
       `prevperioddrawcopycount`,
       `prevperiodsalescopycount`,
       `prevperiodreturns`,
       `prevperiodchargerate`,
       `prevperiodrevenuecharge`,
       `prevperiodreturnscharge`
FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";
2026-01-08 11:31:03,353 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2026-01-08 11:31:13,666 | INFO    | RUN_QUERY | ‚ö†Ô∏è Saved failing SQL ‚Üí output/failed_testcases\prod-SIT_rcti_woolies_bluebook_ext_FAILED.sql
2026-01-08 11:31:13,668 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-08 11:31:13,681 | INFO    | RUN_QUERY | 
‚ñ∂‚ñ∂‚ñ∂ Running testcase [SIT-prod] for table ‚Üí rcti_woolies_bluebook_ext ‚ñ∂‚ñ∂‚ñ∂
2026-01-08 11:31:13,684 | INFO    | RUN_QUERY | 
‚ñ∂ Generated SQL:

2026-01-08 11:31:13,697 | INFO    | RUN_QUERY | SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,
       `pubid`,
       `pubdate`,
       `routeid`,
       `periodsalescharge`,
       `perioddrawcopycount`,
       `periodsalescopycount`,
       `periodreturns`,
       `periodchargerate`,
       `periodrevenuecharge`,
       `periodreturnscharge`,
       `prevperioddrawcopycount`,
       `prevperiodsalescopycount`,
       `prevperiodreturns`,
       `prevperiodchargerate`,
       `prevperiodrevenuecharge`,
       `prevperiodreturnscharge`
FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`
WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"
EXCEPT DISTINCT
SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,
       `pubid`,
       `pubdate`,
       `routeid`,
       `periodsalescharge`,
       `perioddrawcopycount`,
       `periodsalescopycount`,
       `periodreturns`,
       `periodchargerate`,
       `periodrevenuecharge`,
       `periodreturnscharge`,
       `prevperioddrawcopycount`,
       `prevperiodsalescopycount`,
       `prevperiodreturns`,
       `prevperiodchargerate`,
       `prevperiodrevenuecharge`,
       `prevperiodreturnscharge`
FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`
WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";
2026-01-08 11:31:13,705 | INFO    | RUN_QUERY | --------------------------------------------------------------------------------
2026-01-08 11:31:16,227 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-08 11:31:16,241 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output\testcase_results\sdm_rcti_nq_except_distinct_20260108_113059.csv
2026-01-08 11:31:16,242 | INFO    | RUN_QUERY | Finished query: except_distinct in 16.59 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_except_distinct_20260108_113059.csv
2026-01-09 13:29:51,232 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 13:30:06,653 | INFO    | RUN_QUERY | 
Running query: count
2026-01-09 13:30:06,945 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-09 13:30:16,618 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-09 13:30:16,642 | INFO    | RUN_QUERY | Finished query: count in 9.90s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260109_133006.csv
2026-01-09 13:30:16,648 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-09 19:07:29,445 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 19:07:40,955 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-09 19:07:41,544 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-09 19:08:11,007 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260109_190741_schema_diff.csv
2026-01-09 19:08:11,008 | INFO    | RUN_QUERY | Finished query: schema_compare in 29.62s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260109_190741.csv
2026-01-09 19:08:11,010 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-09 19:10:51,298 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 19:11:02,928 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-09 19:11:03,073 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-09 19:11:53,584 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260109_191102_schema_diff.csv
2026-01-09 19:11:53,585 | INFO    | RUN_QUERY | Finished query: schema_compare in 50.65s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260109_191102.csv
2026-01-09 19:11:53,587 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-09 19:12:42,555 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 19:12:54,214 | INFO    | RUN_QUERY | 
Running query: count
2026-01-09 19:12:54,449 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-09 19:13:06,874 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-09 19:13:06,875 | INFO    | RUN_QUERY | Finished query: count in 12.65s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260109_191254.csv
2026-01-09 19:13:06,876 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-09 19:23:06,198 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 19:23:19,225 | INFO    | RUN_QUERY | 
Running query: count
2026-01-09 19:23:19,474 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-09 19:23:27,051 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-09 19:23:27,052 | INFO    | RUN_QUERY | Finished query: count in 7.82s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260109_192319.csv
2026-01-09 19:23:27,054 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-09 14:30:41,888 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 14:30:55,690 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-09 14:30:56,063 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-09 14:30:59,293 | ERROR   | RUN_QUERY | Error running query except_distinct: 'TestExecutor' object has no attribute 'filter_testcases_by_table'
2026-01-09 14:30:59,296 | ERROR   | RUN_QUERY | Fatal error: 'TestExecutor' object has no attribute 'filter_testcases_by_table'
2026-01-09 14:33:25,384 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 14:33:37,853 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-09 14:33:38,035 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-09 14:33:41,170 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-09 14:34:15,786 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 96315 differing row(s) found
2026-01-09 14:34:18,120 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:34:23,883 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9772 differing row(s) found
2026-01-09 14:34:25,725 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:34:27,256 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:34:28,776 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:34:34,427 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-09 14:34:36,258 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:34:43,058 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-09 14:34:44,928 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:34:53,059 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-09 14:34:54,718 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:34:54,751 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260109_143337.csv
2026-01-09 14:34:54,758 | INFO    | RUN_QUERY | Finished query: except_distinct in 76.89s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260109_143337.csv
2026-01-09 14:34:54,760 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-09 14:43:12,336 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 14:43:24,408 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 14:44:22,869 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 14:44:35,538 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-09 14:44:36,156 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-09 14:44:39,593 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-09 14:44:41,323 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:45:08,515 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 96315 differing row(s) found
2026-01-09 14:45:10,391 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:45:15,019 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9772 differing row(s) found
2026-01-09 14:45:16,473 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:45:17,945 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:45:19,773 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:45:24,022 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-09 14:45:25,645 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:45:30,499 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-09 14:45:32,249 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 14:45:38,387 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-09 14:45:38,475 | INFO    | RUN_QUERY | 
üìÅ Testcase results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260109_144435.csv
2026-01-09 14:45:38,617 | INFO    | RUN_QUERY | Finished query: except_distinct in 62.93s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260109_144435.csv
2026-01-09 14:45:38,619 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-09 15:03:44,481 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 15:05:38,526 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-09 15:05:59,367 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-09 15:06:00,531 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-09 15:06:05,207 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_wool'
2026-01-09 15:06:05,208 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-09 15:06:07,018 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-09 15:06:13,869 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-09 15:06:13,985 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260109_150559_filtered_tables.csv
2026-01-09 15:06:13,987 | INFO    | RUN_QUERY | Finished query: except_distinct in 14.49s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260109_150559.csv
2026-01-09 15:06:13,997 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:01:10,701 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:01:31,703 | INFO    | RUN_QUERY | 
Running query: count
2026-01-12 14:01:32,104 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-12 14:01:41,088 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-12 14:01:41,089 | INFO    | RUN_QUERY | Finished query: count in 9.36s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260112_140131.csv
2026-01-12 14:01:41,091 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:03:09,482 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:03:24,297 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-12 14:03:24,466 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-12 14:03:27,906 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260112_140324_schema_diff.csv
2026-01-12 14:03:27,907 | INFO    | RUN_QUERY | Finished query: schema_compare in 3.56s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260112_140324.csv
2026-01-12 14:03:27,910 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:05:28,457 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:05:48,953 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-12 14:05:49,342 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-12 14:05:53,397 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260112_140549_schema_diff.csv
2026-01-12 14:05:53,397 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.22s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260112_140549.csv
2026-01-12 14:05:53,399 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:07:26,146 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:07:35,428 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-12 14:07:35,601 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-12 14:07:39,470 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_wool'
2026-01-12 14:07:39,471 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-12 14:07:41,491 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:07:49,031 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-12 14:07:49,046 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_140735_filtered_tables.csv
2026-01-12 14:07:49,047 | INFO    | RUN_QUERY | Finished query: except_distinct in 13.58s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260112_140735.csv
2026-01-12 14:07:49,048 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:09:52,143 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:10:27,707 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:10:35,756 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-12 14:10:35,918 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-12 14:10:39,516 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-12 14:10:39,517 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-12 14:10:41,157 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:10:42,780 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:10:44,547 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:10:51,093 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-12 14:10:52,856 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:11:01,056 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-12 14:11:01,067 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_141035_filtered_tables.csv
2026-01-12 14:11:01,069 | INFO    | RUN_QUERY | Finished query: except_distinct in 25.30s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260112_141035.csv
2026-01-12 14:11:01,069 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:26:55,385 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:27:07,017 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-12 14:27:07,177 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-12 14:27:10,453 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-12 14:27:10,453 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-12 14:27:12,061 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:27:13,586 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:27:15,526 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:27:19,843 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-12 14:27:21,614 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:27:26,395 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-12 14:27:26,418 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_142707_filtered_tables.csv
2026-01-12 14:27:26,419 | INFO    | RUN_QUERY | Finished query: except_distinct in 19.40s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260112_142707.csv
2026-01-12 14:27:26,420 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:29:34,007 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:29:46,077 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-12 14:29:46,222 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-12 14:29:49,230 | INFO    | RUN_QUERY | Finished query: except_distinct in 3.15s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260112_142946.csv
2026-01-12 14:29:49,232 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:32:40,275 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:32:50,695 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-12 14:32:50,841 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-12 14:32:55,660 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with ''
2026-01-12 14:32:55,667 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-12 14:33:29,028 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 96315 differing row(s) found
2026-01-12 14:33:31,395 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:33:40,832 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9772 differing row(s) found
2026-01-12 14:33:42,648 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:33:44,066 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:33:45,584 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:33:49,454 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-12 14:33:51,372 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:33:56,031 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-12 14:33:57,546 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:34:03,446 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-12 14:34:05,070 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:34:05,087 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143250_filtered_tables.csv
2026-01-12 14:34:05,088 | INFO    | RUN_QUERY | Finished query: except_distinct in 74.39s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143250.csv
2026-01-12 14:34:05,090 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-12 14:38:18,716 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-12 14:38:32,396 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-12 14:38:32,603 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-12 14:38:37,043 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-12 14:38:37,044 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-12 14:38:38,362 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:38:39,678 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:38:43,164 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-12 14:38:44,995 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:38:50,685 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-12 14:38:52,535 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-12 14:38:52,550 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143832_filtered_tables_result.csv
2026-01-12 14:38:52,551 | INFO    | RUN_QUERY | Finished query: except_distinct in 20.15s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143832.csv
2026-01-12 14:38:52,554 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-13 09:46:44,895 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-13 09:47:02,003 | INFO    | RUN_QUERY | 
Running query: count
2026-01-13 09:47:02,189 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-13 09:47:09,107 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-13 09:47:09,107 | INFO    | RUN_QUERY | Finished query: count in 7.07s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260113_094702.csv
2026-01-13 09:47:09,109 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-13 09:47:22,788 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-13 09:47:34,483 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-13 09:47:35,094 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-13 09:47:40,382 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with ''
2026-01-13 09:47:40,382 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-13 09:48:33,920 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 96315 differing row(s) found
2026-01-13 09:48:40,076 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 09:48:47,615 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9772 differing row(s) found
2026-01-13 09:48:49,504 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 09:48:50,969 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 09:48:52,968 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 09:49:00,767 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-13 09:49:02,607 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 09:49:10,161 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-13 09:49:11,983 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 09:49:19,894 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-13 09:49:21,715 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 09:49:21,735 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260113_094734_filtered_tables_result.csv
2026-01-13 09:49:21,736 | INFO    | RUN_QUERY | Finished query: except_distinct in 107.07s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260113_094734.csv
2026-01-13 09:49:21,738 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-13 09:49:29,484 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-13 09:49:42,157 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-13 09:49:42,371 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-13 09:49:46,647 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260113_094942_schema_diff.csv
2026-01-13 09:49:46,647 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.40s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260113_094942.csv
2026-01-13 09:49:46,648 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-13 14:21:10,800 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-13 14:21:31,961 | INFO    | RUN_QUERY | 
Running query: count
2026-01-13 14:21:32,113 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-13 14:21:38,038 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-13 14:21:38,039 | INFO    | RUN_QUERY | Finished query: count in 6.08s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260113_142131.csv
2026-01-13 14:21:38,043 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-13 14:21:46,951 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-13 14:21:58,039 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-13 14:21:58,182 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-13 14:22:01,945 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-13 14:22:01,946 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-13 14:22:03,448 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 14:22:05,066 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 14:22:09,412 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-13 14:22:11,035 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 14:22:16,818 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-13 14:22:19,055 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-13 14:22:19,073 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260113_142158_filtered_tables_result.csv
2026-01-13 14:22:19,074 | INFO    | RUN_QUERY | Finished query: except_distinct in 21.03s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260113_142158.csv
2026-01-13 14:22:19,076 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-13 14:22:24,782 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-13 14:22:35,448 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-13 14:22:35,566 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-13 14:22:39,262 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260113_142235_schema_diff.csv
2026-01-13 14:22:39,263 | INFO    | RUN_QUERY | Finished query: schema_compare in 3.81s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260113_142235.csv
2026-01-13 14:22:39,264 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 13:53:56,518 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 13:54:29,104 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 13:54:29,272 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 13:54:38,599 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 13:54:38,600 | INFO    | RUN_QUERY | Finished query: count in 9.46s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260114_135429.csv
2026-01-14 13:54:38,604 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 13:54:51,701 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 13:55:04,904 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 13:55:05,177 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 13:55:08,505 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-14 13:55:08,506 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 13:55:10,106 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 13:55:11,394 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 13:55:17,540 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-14 13:55:19,785 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 13:55:26,176 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-14 13:55:28,203 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 13:55:28,220 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_135504_filtered_tables_result.csv
2026-01-14 13:55:28,221 | INFO    | RUN_QUERY | Finished query: except_distinct in 23.26s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260114_135504.csv
2026-01-14 13:55:28,223 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 13:55:35,804 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 13:55:51,959 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 13:55:52,116 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 13:55:56,277 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_135551_schema_diff.csv
2026-01-14 13:55:56,278 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.28s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260114_135551.csv
2026-01-14 13:55:56,280 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:11:28,381 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:11:42,297 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 14:11:42,442 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 14:11:50,098 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 14:11:50,098 | INFO    | RUN_QUERY | Finished query: count in 7.80s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260114_141142.csv
2026-01-14 14:11:50,101 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:11:59,828 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:12:11,727 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 14:12:11,891 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 14:12:16,560 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-14 14:12:16,561 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 14:12:17,838 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:12:19,157 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:12:24,646 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-14 14:12:26,175 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:12:34,179 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-14 14:12:36,645 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:12:36,662 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141211_filtered_tables_result.csv
2026-01-14 14:12:36,664 | INFO    | RUN_QUERY | Finished query: except_distinct in 24.93s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141211.csv
2026-01-14 14:12:36,670 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:12:42,034 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:12:51,711 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 14:12:51,817 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 14:12:55,490 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_141251_schema_diff.csv
2026-01-14 14:12:55,490 | INFO    | RUN_QUERY | Finished query: schema_compare in 3.78s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260114_141251.csv
2026-01-14 14:12:55,492 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:15:58,197 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:16:11,508 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 14:16:11,654 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 14:16:18,634 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 14:16:18,635 | INFO    | RUN_QUERY | Finished query: count in 7.12s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260114_141611.csv
2026-01-14 14:16:18,637 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:16:26,736 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:16:37,226 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 14:16:37,346 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 14:16:40,052 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-14 14:16:40,053 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 14:16:41,479 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:16:42,897 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:16:49,799 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-14 14:16:51,521 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:16:58,600 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-14 14:17:00,326 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:17:00,343 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141637_filtered_tables_result.csv
2026-01-14 14:17:00,344 | INFO    | RUN_QUERY | Finished query: except_distinct in 23.12s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141637.csv
2026-01-14 14:17:00,345 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:17:04,312 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:17:13,142 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 14:17:13,257 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 14:17:17,381 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_141713_schema_diff.csv
2026-01-14 14:17:17,382 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.24s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260114_141713.csv
2026-01-14 14:17:17,383 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:36:43,310 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:37:01,717 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 14:37:01,873 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 14:38:19,138 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 14:38:19,139 | INFO    | RUN_QUERY | Finished query: count in 77.40s ‚Üí output/testcase_results\sdm_think_nq_count_20260114_143701.csv
2026-01-14 14:38:19,140 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:38:28,525 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:38:41,530 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 14:38:41,804 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 14:38:45,501 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2026-01-14 14:38:45,502 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 14:38:47,424 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:38:49,243 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:38:50,965 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:38:52,679 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:38:52,693 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_think_nq_except_distinct_20260114_143841_filtered_tables_result.csv
2026-01-14 14:38:52,694 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.05s ‚Üí output/testcase_results\sdm_think_nq_except_distinct_20260114_143841.csv
2026-01-14 14:38:52,696 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:38:57,389 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:39:09,571 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 14:39:09,698 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 14:39:15,091 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_think_nq_schema_compare_20260114_143909_schema_diff.csv
2026-01-14 14:39:15,100 | INFO    | RUN_QUERY | Finished query: schema_compare in 5.50s ‚Üí output/testcase_results\sdm_think_nq_schema_compare_20260114_143909.csv
2026-01-14 14:39:15,102 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:54:30,242 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:54:43,250 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 14:54:43,385 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 14:54:51,466 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 14:54:51,467 | INFO    | RUN_QUERY | Finished query: count in 8.21s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260114_145443.csv
2026-01-14 14:54:51,469 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:54:59,611 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:55:11,312 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 14:55:11,477 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 14:55:15,482 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with ''
2026-01-14 14:55:15,482 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 14:55:46,452 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 96315 differing row(s) found
2026-01-14 14:55:48,390 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:55:54,468 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9772 differing row(s) found
2026-01-14 14:55:56,285 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:55:57,601 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:55:58,920 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:56:04,561 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-14 14:56:06,891 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:56:14,297 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-14 14:56:16,575 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:56:24,059 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-14 14:56:25,985 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 14:56:26,002 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_145511_filtered_tables_result.csv
2026-01-14 14:56:26,006 | INFO    | RUN_QUERY | Finished query: except_distinct in 74.69s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260114_145511.csv
2026-01-14 14:56:26,008 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 14:56:32,331 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 14:56:46,434 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 14:56:46,572 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 14:56:50,637 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_145646_schema_diff.csv
2026-01-14 14:56:50,637 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.20s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260114_145646.csv
2026-01-14 14:56:50,638 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:39:58,249 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:40:24,786 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 15:40:24,993 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 15:40:31,157 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 15:40:31,158 | INFO    | RUN_QUERY | Finished query: count in 6.37s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260114_154024.csv
2026-01-14 15:40:31,160 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:40:40,210 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:40:55,153 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 15:40:55,296 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 15:40:59,257 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with ''
2026-01-14 15:40:59,258 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 15:41:29,437 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 96315 differing row(s) found
2026-01-14 15:41:32,777 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:41:38,838 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9772 differing row(s) found
2026-01-14 15:41:40,462 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:41:41,982 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:41:43,402 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:41:47,270 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-14 15:41:48,719 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:41:53,824 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-14 15:41:55,553 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:42:03,236 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 15010 differing row(s) found
2026-01-14 15:42:05,562 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:42:05,579 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154055_filtered_tables_result.csv
2026-01-14 15:42:05,581 | INFO    | RUN_QUERY | Finished query: except_distinct in 70.42s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154055.csv
2026-01-14 15:42:05,582 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:42:11,331 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:42:31,468 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 15:42:31,615 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 15:42:35,822 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_154231_schema_diff.csv
2026-01-14 15:42:35,823 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.35s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260114_154231.csv
2026-01-14 15:42:35,824 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:46:46,202 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:47:00,765 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 15:47:00,893 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 15:47:08,743 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 15:47:08,744 | INFO    | RUN_QUERY | Finished query: count in 7.98s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260114_154700.csv
2026-01-14 15:47:08,747 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:47:18,942 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:47:31,371 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 15:47:31,467 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 15:47:35,496 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-14 15:47:35,497 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 15:47:36,929 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:47:38,449 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:47:42,741 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-14 15:47:45,780 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:47:51,364 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-14 15:47:54,966 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:47:54,989 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154731_filtered_tables_result.csv
2026-01-14 15:47:54,990 | INFO    | RUN_QUERY | Finished query: except_distinct in 23.62s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154731.csv
2026-01-14 15:47:54,991 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:48:00,841 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:48:15,139 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 15:48:15,294 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 15:48:20,341 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_154815_schema_diff.csv
2026-01-14 15:48:20,341 | INFO    | RUN_QUERY | Finished query: schema_compare in 5.20s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260114_154815.csv
2026-01-14 15:48:20,343 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:54:59,726 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:55:19,960 | INFO    | RUN_QUERY | 
Running query: count
2026-01-14 15:55:20,130 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-14 15:56:41,426 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-01-14 15:56:41,427 | INFO    | RUN_QUERY | Finished query: count in 81.46s ‚Üí output/testcase_results\sdm_think_nq_count_20260114_155519.csv
2026-01-14 15:56:41,429 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:56:51,463 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:57:06,769 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-14 15:57:06,940 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order',
                            'customer',
                            'customer_address')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-14 15:57:11,294 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'addr'
2026-01-14 15:57:11,295 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-14 15:57:12,963 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:57:14,579 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:57:16,568 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:57:18,158 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-14 15:57:18,176 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_think_nq_except_distinct_20260114_155706_filtered_tables_result.csv
2026-01-14 15:57:18,176 | INFO    | RUN_QUERY | Finished query: except_distinct in 11.40s ‚Üí output/testcase_results\sdm_think_nq_except_distinct_20260114_155706.csv
2026-01-14 15:57:18,179 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-14 15:57:29,658 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-14 15:57:42,639 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-01-14 15:57:42,763 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-01-14 15:57:47,909 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_think_nq_schema_compare_20260114_155742_schema_diff.csv
2026-01-14 15:57:47,910 | INFO    | RUN_QUERY | Finished query: schema_compare in 5.27s ‚Üí output/testcase_results\sdm_think_nq_schema_compare_20260114_155742.csv
2026-01-14 15:57:47,912 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-23 09:59:08,596 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-23 09:59:25,057 | INFO    | RUN_QUERY | 
Running query: count
2026-01-23 09:59:25,251 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_gbaba_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_gbaba_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_gbaba_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY 1,
         3;
2026-01-23 09:59:27,548 | ERROR   | RUN_QUERY | Error running query count: 404 Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location US; reason: notFound, message: Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location US

Location: US
Job ID: 156c4759-3d0a-4f1c-8b73-124c6c9ad2d4

2026-01-23 09:59:27,549 | ERROR   | RUN_QUERY | Fatal error: 404 Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location US; reason: notFound, message: Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location US

Location: US
Job ID: 156c4759-3d0a-4f1c-8b73-124c6c9ad2d4

2026-01-29 19:13:51,852 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 19:14:15,474 | INFO    | RUN_QUERY | 
Running query: except_distinct_fullload
2026-01-29 19:14:15,671 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
     AND TABLE_NAME NOT IN ('customer',
                            'customer_address',
                            'customer_address_ext',
                            'customer_ext',
                            'demographic',
                            'news_customer_contract',
                            'news_demographic_ex',
                            'news_ext_customer_redemption',
                            'news_financial_transaction',
                            'news_interactions',
                            'news_payment_account_ext',
                            'order_item',
                            'order_item_ext',
                            'order_item_note',
                            'paybreak',
                            'payment',
                            'payment_account',
                            'payment_reversed_payment',
                            'service',
                            'service_ext',
                            'gbaba_act_xref',
                            'ad_custom_fields_export',
                            'customers_export',
                            'display_ads_export',
                            'insert_ads_export',
                            'online_ad_export2',
                            'order_custom_fields_export',
                            'order_export2',
                            'order_item_audience_segment',
                            'order_item_metadata',
                            'order_item_price_item',
                            'order_items')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 19:14:19,487 | INFO    | RUN_QUERY | Finished query: except_distinct_fullload in 4.01s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_191415.csv
2026-01-29 19:14:19,488 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-29 19:58:59,616 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 19:59:16,587 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-29 19:59:16,723 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 19:59:20,473 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-29 19:59:20,473 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-29 19:59:22,231 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 19:59:24,150 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 19:59:29,616 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-29 19:59:33,126 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 19:59:40,271 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-29 19:59:42,245 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 19:59:42,265 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_195916_filtered_tables_result.csv
2026-01-29 19:59:42,267 | INFO    | RUN_QUERY | Finished query: except_distinct in 25.67s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260129_195916.csv
2026-01-29 19:59:42,269 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-29 20:01:33,717 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 20:01:46,178 | INFO    | RUN_QUERY | 
Running query: except_distinct_fullload
2026-01-29 20:01:46,319 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
     AND TABLE_NAME NOT IN ('customer',
                            'customer_address',
                            'customer_address_ext',
                            'customer_ext',
                            'demographic',
                            'news_customer_contract',
                            'news_demographic_ex',
                            'news_ext_customer_redemption',
                            'news_financial_transaction',
                            'news_interactions',
                            'news_payment_account_ext',
                            'order_item',
                            'order_item_ext',
                            'order_item_note',
                            'paybreak',
                            'payment',
                            'payment_account',
                            'payment_reversed_payment',
                            'service',
                            'service_ext',
                            'gbaba_act_xref',
                            'ad_custom_fields_export',
                            'customers_export',
                            'display_ads_export',
                            'insert_ads_export',
                            'online_ad_export2',
                            'order_custom_fields_export',
                            'order_export2',
                            'order_item_audience_segment',
                            'order_item_metadata',
                            'order_item_price_item',
                            'order_items')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 20:01:50,093 | INFO    | RUN_QUERY | Finished query: except_distinct_fullload in 3.91s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_200146.csv
2026-01-29 20:01:50,094 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-29 20:02:28,480 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 20:02:38,237 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-29 20:02:38,405 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 20:02:41,535 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-29 20:02:41,535 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-29 20:02:43,090 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:02:44,676 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:02:49,027 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-29 20:02:51,204 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:02:57,083 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-29 20:02:58,797 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:02:58,813 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200238_filtered_tables_result.csv
2026-01-29 20:02:58,815 | INFO    | RUN_QUERY | Finished query: except_distinct in 20.53s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200238.csv
2026-01-29 20:02:58,816 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-29 20:05:31,899 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 20:05:42,653 | INFO    | RUN_QUERY | 
Running query: except_distinct_fullload
2026-01-29 20:05:42,814 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
     AND TABLE_NAME NOT IN ('customer',
                            'customer_address',
                            'customer_address_ext',
                            'customer_ext',
                            'demographic',
                            'news_customer_contract',
                            'news_demographic_ex',
                            'news_ext_customer_redemption',
                            'news_financial_transaction',
                            'news_interactions',
                            'news_payment_account_ext',
                            'order_item',
                            'order_item_ext',
                            'order_item_note',
                            'paybreak',
                            'payment',
                            'payment_account',
                            'payment_reversed_payment',
                            'service',
                            'service_ext',
                            'gbaba_act_xref',
                            'ad_custom_fields_export',
                            'customers_export',
                            'display_ads_export',
                            'insert_ads_export',
                            'online_ad_export2',
                            'order_custom_fields_export',
                            'order_export2',
                            'order_item_audience_segment',
                            'order_item_metadata',
                            'order_item_price_item',
                            'order_items')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 20:05:46,466 | INFO    | RUN_QUERY | Finished query: except_distinct_fullload in 3.81s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_200542.csv
2026-01-29 20:05:46,467 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-29 20:08:47,048 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 20:08:59,030 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-29 20:08:59,148 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 20:09:02,564 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-29 20:09:02,565 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-29 20:09:04,891 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:09:06,511 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:09:11,755 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-29 20:09:13,851 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:09:18,503 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-29 20:09:20,489 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:09:20,520 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200859_filtered_tables_result.csv
2026-01-29 20:09:20,523 | INFO    | RUN_QUERY | Finished query: except_distinct in 21.49s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200859.csv
2026-01-29 20:09:20,525 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-29 20:19:24,288 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 20:20:00,964 | INFO    | RUN_QUERY | 
Running query: except_distinct_fullload
2026-01-29 20:20:01,143 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
     AND TABLE_NAME NOT IN ('customer',
                            'customer_address',
                            'customer_address_ext',
                            'customer_ext',
                            'demographic',
                            'news_customer_contract',
                            'news_demographic_ex',
                            'news_ext_customer_redemption',
                            'news_financial_transaction',
                            'news_interactions',
                            'news_payment_account_ext',
                            'order_item',
                            'order_item_ext',
                            'order_item_note',
                            'paybreak',
                            'payment',
                            'payment_account',
                            'payment_reversed_payment',
                            'service',
                            'service_ext',
                            'gbaba_act_xref',
                            'ad_custom_fields_export',
                            'customers_export',
                            'display_ads_export',
                            'insert_ads_export',
                            'online_ad_export2',
                            'order_custom_fields_export',
                            'order_export2',
                            'order_item_audience_segment',
                            'order_item_metadata',
                            'order_item_price_item',
                            'order_items')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 20:20:05,490 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-29 20:20:05,491 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-29 20:20:07,081 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:20:08,897 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:20:10,619 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:20:17,068 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-29 20:20:19,458 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:20:24,759 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-29 20:20:24,880 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_202000_filtered_tables_result.csv
2026-01-29 20:20:24,882 | INFO    | RUN_QUERY | Finished query: except_distinct_fullload in 23.91s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_202000.csv
2026-01-29 20:20:24,886 | INFO    | RUN_QUERY | All queries completed successfully
2026-01-29 20:21:41,710 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 20:21:52,729 | INFO    | RUN_QUERY | 
Running query: except_distinct_deltaload
2026-01-29 20:21:52,886 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
     AND TABLE_NAME IN ('customer',
                        'customer_address',
                        'customer_address_ext',
                        'customer_ext',
                        'demographic',
                        'news_customer_contract',
                        'news_demographic_ex',
                        'news_ext_customer_redemption',
                        'news_financial_transaction',
                        'news_interactions',
                        'news_payment_account_ext',
                        'order_item',
                        'order_item_ext',
                        'order_item_note',
                        'paybreak',
                        'payment',
                        'payment_account',
                        'payment_reversed_payment',
                        'service',
                        'service_ext',
                        'gbaba_act_xref',
                        'ad_custom_fields_export',
                        'customers_export',
                        'display_ads_export',
                        'insert_ads_export',
                        'online_ad_export2',
                        'order_custom_fields_export',
                        'order_export2',
                        'order_item_audience_segment',
                        'order_item_metadata',
                        'order_item_price_item',
                        'order_items')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 20:21:56,460 | ERROR   | RUN_QUERY | Error running query except_distinct_deltaload: ‚ùå No testcases found matching tables starting with 'rcti_c'.
2026-01-29 20:21:56,461 | ERROR   | RUN_QUERY | Fatal error: ‚ùå No testcases found matching tables starting with 'rcti_c'.
2026-01-29 20:25:39,704 | INFO    | RUN_QUERY | Starting query execution framework...

2026-01-29 20:25:53,124 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-01-29 20:25:53,278 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-01-29 20:25:56,511 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-01-29 20:25:56,512 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-01-29 20:25:58,526 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:26:00,028 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:26:04,821 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-01-29 20:26:06,706 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:26:11,893 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-01-29 20:26:13,946 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-01-29 20:26:13,967 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_202553_filtered_tables_result.csv
2026-01-29 20:26:13,969 | INFO    | RUN_QUERY | Finished query: except_distinct in 20.84s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260129_202553.csv
2026-01-29 20:26:13,971 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 11:00:25,123 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 11:00:46,224 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-02-02 11:00:46,383 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-02-02 11:00:50,477 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-02-02 11:00:50,478 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-02-02 11:00:52,147 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 11:00:53,759 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 11:00:59,762 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-02-02 11:01:01,646 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 11:01:09,008 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-02-02 11:01:11,779 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 11:01:11,832 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260202_110046_filtered_tables_result.csv
2026-02-02 11:01:11,835 | INFO    | RUN_QUERY | Finished query: except_distinct in 25.61s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260202_110046.csv
2026-02-02 11:01:11,836 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 18:15:48,612 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 18:16:09,044 | INFO    | RUN_QUERY | 
Running query: count
2026-02-02 18:16:09,225 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order')
ORDER BY 1,
         3;
2026-02-02 18:16:19,823 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-02-02 18:16:19,824 | INFO    | RUN_QUERY | Finished query: count in 10.74s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260202_181609.csv
2026-02-02 18:16:19,826 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 18:17:47,568 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 18:18:01,668 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-02-02 18:18:01,935 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-02-02 18:18:05,976 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260202_181801_schema_diff.csv
2026-02-02 18:18:05,977 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.27s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260202_181801.csv
2026-02-02 18:18:05,979 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 18:57:00,878 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 18:57:14,920 | INFO    | RUN_QUERY | 
Running query: schema_compare
2026-02-02 18:57:15,055 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     sit_schema AS
  (SELECT TABLE_NAME,
          COLUMN_NAME,
          data_type,
          is_nullable
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),
     all_columns AS
  (-- Get all unique table/column combinations from both datasets
 SELECT TABLE_NAME,
        COLUMN_NAME
   FROM prod_schema
   UNION DISTINCT SELECT TABLE_NAME,
                         COLUMN_NAME
   FROM sit_schema)
SELECT c.table_name,
       c.column_name,
       p.data_type AS prod_type,
       n.data_type AS prod_nq_type,
       p.is_nullable AS prod_nullable,
       n.is_nullable AS prod_nq_nullable,
       CASE
           WHEN p.data_type IS DISTINCT
                FROM n.data_type THEN 'TYPE_MISMATCH'
           WHEN p.is_nullable IS DISTINCT
                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'
           ELSE 'MATCH'
       END AS diff_status
FROM all_columns c
LEFT JOIN prod_schema p ON c.table_name = p.table_name
AND c.column_name = p.column_name
LEFT JOIN sit_schema n ON c.table_name = n.table_name
AND c.column_name = n.column_name
WHERE c.table_name NOT IN ('cart',
                           'order',
                           'customer',
                           'customer_address')
ORDER BY c.table_name,
         c.column_name;
2026-02-02 18:57:19,798 | INFO    | RUN_QUERY | üìÅ Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260202_185714_schema_diff.csv
2026-02-02 18:57:19,799 | INFO    | RUN_QUERY | Finished query: schema_compare in 4.87s ‚Üí output/testcase_results\sdm_rcti_nq_schema_compare_20260202_185714.csv
2026-02-02 18:57:19,807 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 18:58:05,315 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 18:58:15,543 | INFO    | RUN_QUERY | 
Running query: count
2026-02-02 18:58:15,732 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH prod AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),
     prod_nq AS
  (SELECT TABLE_NAME,
          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,
          total_rows
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`
   WHERE partition_id NOT LIKE '%NULL%'
     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),
     info_table AS
  (SELECT TABLE_NAME
   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)
SELECT i.table_name,
       a.partition_date AS sit_prtn_date,
       b.partition_date AS prd_prtn_date,
       a.total_rows AS sit_count,
       b.total_rows AS prd_count,
       a.total_rows - b.total_rows AS diff
FROM info_table i
LEFT JOIN prod_nq a ON i.table_name = a.table_name
LEFT JOIN prod b ON i.table_name = b.table_name
WHERE i.table_name NOT IN ('cart',
                           'order')
ORDER BY 1,
         3;
2026-02-02 18:58:26,166 | WARNING | RUN_QUERY | ‚ùå DIFF FOUND in count query
2026-02-02 18:58:26,167 | INFO    | RUN_QUERY | Finished query: count in 10.58s ‚Üí output/testcase_results\sdm_rcti_nq_count_20260202_185815.csv
2026-02-02 18:58:26,170 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 18:59:23,247 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 18:59:33,602 | INFO    | RUN_QUERY | 
Running query: except_distinct
2026-02-02 18:59:33,999 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-02-02 18:59:38,265 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-02-02 18:59:38,266 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-02-02 18:59:40,021 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 18:59:41,336 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 18:59:46,202 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-02-02 18:59:48,654 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 18:59:54,247 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-02-02 18:59:55,950 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 18:59:55,981 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260202_185933_filtered_tables_result.csv
2026-02-02 18:59:56,490 | INFO    | RUN_QUERY | Finished query: except_distinct in 22.63s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_20260202_185933.csv
2026-02-02 18:59:56,512 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 19:01:07,030 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 19:01:18,747 | INFO    | RUN_QUERY | 
Running query: except_distinct_fullload
2026-02-02 19:01:19,148 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
     AND TABLE_NAME NOT IN ('customer',
                            'customer_address',
                            'customer_address_ext',
                            'customer_ext',
                            'demographic',
                            'news_customer_contract',
                            'news_demographic_ex',
                            'news_ext_customer_redemption',
                            'news_financial_transaction',
                            'news_interactions',
                            'news_payment_account_ext',
                            'order_item',
                            'order_item_ext',
                            'order_item_note',
                            'paybreak',
                            'payment',
                            'payment_account',
                            'payment_reversed_payment',
                            'service',
                            'service_ext',
                            'gbaba_act_xref',
                            'ad_custom_fields_export',
                            'customers_export',
                            'display_ads_export',
                            'insert_ads_export',
                            'online_ad_export2',
                            'order_custom_fields_export',
                            'order_export2',
                            'order_item_audience_segment',
                            'order_item_metadata',
                            'order_item_price_item',
                            'order_items')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-02-02 19:01:23,186 | INFO    | RUN_QUERY | ‚úÖ Running testcases for tables starting with 'rcti_c'
2026-02-02 19:01:23,186 | INFO    | RUN_QUERY | Executing EXCEPT DISTINCT testcases...

2026-02-02 19:01:24,956 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 19:01:26,422 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 19:01:30,501 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 9167 differing row(s) found
2026-02-02 19:01:32,327 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 19:01:37,894 | INFO    | RUN_QUERY | ‚ùå Testcase failed ‚Üí 11486 differing row(s) found
2026-02-02 19:01:40,397 | INFO    | RUN_QUERY | ‚úî Testcase passed ‚Üí no differences found
2026-02-02 19:01:40,414 | INFO    | RUN_QUERY | 
üìÅ Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260202_190118_filtered_tables_result.csv
2026-02-02 19:01:40,415 | INFO    | RUN_QUERY | Finished query: except_distinct_fullload in 21.47s ‚Üí output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260202_190118.csv
2026-02-02 19:01:40,416 | INFO    | RUN_QUERY | All queries completed successfully
2026-02-02 19:02:40,396 | INFO    | RUN_QUERY | Starting query execution framework...

2026-02-02 19:02:50,103 | INFO    | RUN_QUERY | 
Running query: except_distinct_deltaload
2026-02-02 19:02:50,388 | INFO    | RUN_QUERY | ‚ñ∂ Generated SQL:
WITH table_info AS
  (SELECT table_catalog,
          table_schema,
          TABLE_NAME,
          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','
                     ORDER BY ordinal_position) AS columns
   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`
   WHERE COLUMN_NAME NOT IN ('nq_batch_id',
                             'dgw_batch_id',
                             'dw_batch_id',
                             'dw_ingest_time',
                             'dw_partition_date',
                             'dw_publish_time',
                             'dw_source_object_name',
                             'soft_error_fields',
                             'extra_data_payload')
     AND TABLE_NAME NOT IN ('appc_send_log',
                            'appc_send_log_0715',
                            'contactsf',
                            'emailobject',
                            'pushmessagedetail',
                            'smsdetailsummary',
                            'cart',
                            'order')
     AND TABLE_NAME IN ('customer',
                        'customer_address',
                        'customer_address_ext',
                        'customer_ext',
                        'demographic',
                        'news_customer_contract',
                        'news_demographic_ex',
                        'news_ext_customer_redemption',
                        'news_financial_transaction',
                        'news_interactions',
                        'news_payment_account_ext',
                        'order_item',
                        'order_item_ext',
                        'order_item_note',
                        'paybreak',
                        'payment',
                        'payment_account',
                        'payment_reversed_payment',
                        'service',
                        'service_ext',
                        'gbaba_act_xref',
                        'ad_custom_fields_export',
                        'customers_export',
                        'display_ads_export',
                        'insert_ads_export',
                        'online_ad_export2',
                        'order_custom_fields_export',
                        'order_export2',
                        'order_item_audience_segment',
                        'order_item_metadata',
                        'order_item_price_item',
                        'order_items')
   GROUP BY table_catalog,
            table_schema,
            TABLE_NAME)
SELECT 'SIT-prod' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcase
FROM table_info
UNION ALL
SELECT 'prod-SIT' AS scenario,
       TABLE_NAME,
       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcase
FROM table_info
ORDER BY TABLE_NAME;
2026-02-02 19:02:54,108 | ERROR   | RUN_QUERY | Error running query except_distinct_deltaload: ‚ùå No testcases found matching tables starting with 'rcti_c'.
2026-02-02 19:02:54,109 | ERROR   | RUN_QUERY | Fatal error: ‚ùå No testcases found matching tables starting with 'rcti_c'.
