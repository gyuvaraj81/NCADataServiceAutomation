20:40:33.529 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:40:37.634 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename agency 
20:41:07.249 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctError running query except_distinct: 'charmap' codec can't encode character '\u25b6' in position 2: character maps to <undefined> 
20:41:10.708 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) run-query.feature
20:44:45.947 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:44:46.769 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766157286760
20:44:49.963 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename agency 
20:45:20.868 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.6s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)                                             âœ… Running testcases for table 'agency'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ agency â–¶â–¶â–¶â–¶ Generated SQL:SELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)Executing testcase... - (1.8s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ agency â–¶â–¶â–¶â–¶ Generated SQL:SELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)                                                âœ” Testcase passed â†’ no differences foundðŸ“? Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251219_204513.csvFinished query: except_distinct in 7.19 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251219_204513.csv 
20:45:23.591 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) run-query.feature
19:55:58.188 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:56:24.874 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:58:47.797 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:58:49.842 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766413729828
19:58:55.799 [main] ERROR com.intuit.karate - run-query.feature:5
* print 'pythonCmd ===> ', pythonCmd
>> run-query.feature:3
>> karate-config.js failed
>> ReferenceError: "tablename" is not defined
js failed:
>>>>
01: function fn() {
02: 
03:   // ---------------- Environment ----------------
04:   var env = karate.env || 'local';
05: 
06:   // ---------------- Base Paths ----------------
07:   var python = 'python';
08:   var script = 'src/main/python/run_query.py';
09: 
10:   // ---------------- Read CLI Properties ----------------
11:   var query = karate.properties['query'];
12: 
13:   if (!query) {
14:     karate.log('No query provided ? defaulting to count');
15:     query = 'count';
16:   }
17: 
18:   // ---------------- Build Python Command ----------------
19:   var pythonCmd = python + ' ' + script + ' --query ' + query;
20: 
21:   if (tablename) {
22:     pythonCmd = pythonCmd + ' --tablename ' + tablename;
23:   }
24: 
25:   karate.log('Python Command ===> ', pythonCmd);
26: 
27:   // ---------------- Expose to Features ----------------
28:   return {
29:     env: env,
30:     query: query,
31:     tablename: tablename,
32:     pythonCmd: pythonCmd
33:   };
34: }
<<<<
org.graalvm.polyglot.PolyglotException: ReferenceError: "tablename" is not defined
- <js>.fn(Unnamed:21)

run-query.feature:5
19:58:55.806 [main] ERROR com.intuit.karate - run-query.feature:6
* def result = karate.exec(pythonCmd)
>> run-query.feature:3
>> karate-config.js failed
>> ReferenceError: "tablename" is not defined
js failed:
>>>>
01: function fn() {
02: 
03:   // ---------------- Environment ----------------
04:   var env = karate.env || 'local';
05: 
06:   // ---------------- Base Paths ----------------
07:   var python = 'python';
08:   var script = 'src/main/python/run_query.py';
09: 
10:   // ---------------- Read CLI Properties ----------------
11:   var query = karate.properties['query'];
12: 
13:   if (!query) {
14:     karate.log('No query provided ? defaulting to count');
15:     query = 'count';
16:   }
17: 
18:   // ---------------- Build Python Command ----------------
19:   var pythonCmd = python + ' ' + script + ' --query ' + query;
20: 
21:   if (tablename) {
22:     pythonCmd = pythonCmd + ' --tablename ' + tablename;
23:   }
24: 
25:   karate.log('Python Command ===> ', pythonCmd);
26: 
27:   // ---------------- Expose to Features ----------------
28:   return {
29:     env: env,
30:     query: query,
31:     tablename: tablename,
32:     pythonCmd: pythonCmd
33:   };
34: }
<<<<
org.graalvm.polyglot.PolyglotException: ReferenceError: "tablename" is not defined
- <js>.fn(Unnamed:21)

run-query.feature:5
run-query.feature:6
19:58:55.810 [main] ERROR com.intuit.karate - run-query.feature:7
* print 'result ===> ', result
>> run-query.feature:3
>> karate-config.js failed
>> ReferenceError: "tablename" is not defined
js failed:
>>>>
01: function fn() {
02: 
03:   // ---------------- Environment ----------------
04:   var env = karate.env || 'local';
05: 
06:   // ---------------- Base Paths ----------------
07:   var python = 'python';
08:   var script = 'src/main/python/run_query.py';
09: 
10:   // ---------------- Read CLI Properties ----------------
11:   var query = karate.properties['query'];
12: 
13:   if (!query) {
14:     karate.log('No query provided ? defaulting to count');
15:     query = 'count';
16:   }
17: 
18:   // ---------------- Build Python Command ----------------
19:   var pythonCmd = python + ' ' + script + ' --query ' + query;
20: 
21:   if (tablename) {
22:     pythonCmd = pythonCmd + ' --tablename ' + tablename;
23:   }
24: 
25:   karate.log('Python Command ===> ', pythonCmd);
26: 
27:   // ---------------- Expose to Features ----------------
28:   return {
29:     env: env,
30:     query: query,
31:     tablename: tablename,
32:     pythonCmd: pythonCmd
33:   };
34: }
<<<<
org.graalvm.polyglot.PolyglotException: ReferenceError: "tablename" is not defined
- <js>.fn(Unnamed:21)

run-query.feature:5
run-query.feature:6
run-query.feature:7
19:58:59.431 [main] INFO  com.intuit.karate.Suite - <<fail>> feature 1 of 1 (0 remaining) run-query.feature
19:59:45.675 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:59:46.762 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766413786752
19:59:53.812 [main] ERROR com.intuit.karate - run-query.feature:5
* print 'pythonCmd ===> ', pythonCmd
>> run-query.feature:3
>> karate-config.js failed
>> ReferenceError: "tablename" is not defined
js failed:
>>>>
01: function fn() {
02: 
03:   // ---------------- Environment ----------------
04:   var env = karate.env || 'local';
05: 
06:   // ---------------- Base Paths ----------------
07:   var python = 'python';
08:   var script = 'src/main/python/run_query.py';
09: 
10:   // ---------------- Read CLI Properties ----------------
11:   var query = karate.properties['query'];
12: 
13:   if (!query) {
14:     karate.log('No query provided ? defaulting to count');
15:     query = 'count';
16:   }
17: 
18:   // ---------------- Build Python Command ----------------
19:   var pythonCmd = python + ' ' + script + ' --query ' + query;
20: 
21:   if (tablename) {
22:     pythonCmd = pythonCmd + ' --tablename ' + tablename;
23:   }
24: 
25:   karate.log('Python Command ===> ', pythonCmd);
26: 
27:   // ---------------- Expose to Features ----------------
28:   return {
29:     env: env,
30:     query: query,
31:     tablename: tablename,
32:     pythonCmd: pythonCmd
33:   };
34: }
<<<<
org.graalvm.polyglot.PolyglotException: ReferenceError: "tablename" is not defined
- <js>.fn(Unnamed:21)

run-query.feature:5
19:59:53.820 [main] ERROR com.intuit.karate - run-query.feature:6
* def result = karate.exec(pythonCmd)
>> run-query.feature:3
>> karate-config.js failed
>> ReferenceError: "tablename" is not defined
js failed:
>>>>
01: function fn() {
02: 
03:   // ---------------- Environment ----------------
04:   var env = karate.env || 'local';
05: 
06:   // ---------------- Base Paths ----------------
07:   var python = 'python';
08:   var script = 'src/main/python/run_query.py';
09: 
10:   // ---------------- Read CLI Properties ----------------
11:   var query = karate.properties['query'];
12: 
13:   if (!query) {
14:     karate.log('No query provided ? defaulting to count');
15:     query = 'count';
16:   }
17: 
18:   // ---------------- Build Python Command ----------------
19:   var pythonCmd = python + ' ' + script + ' --query ' + query;
20: 
21:   if (tablename) {
22:     pythonCmd = pythonCmd + ' --tablename ' + tablename;
23:   }
24: 
25:   karate.log('Python Command ===> ', pythonCmd);
26: 
27:   // ---------------- Expose to Features ----------------
28:   return {
29:     env: env,
30:     query: query,
31:     tablename: tablename,
32:     pythonCmd: pythonCmd
33:   };
34: }
<<<<
org.graalvm.polyglot.PolyglotException: ReferenceError: "tablename" is not defined
- <js>.fn(Unnamed:21)

run-query.feature:5
run-query.feature:6
19:59:53.823 [main] ERROR com.intuit.karate - run-query.feature:7
* print 'result ===> ', result
>> run-query.feature:3
>> karate-config.js failed
>> ReferenceError: "tablename" is not defined
js failed:
>>>>
01: function fn() {
02: 
03:   // ---------------- Environment ----------------
04:   var env = karate.env || 'local';
05: 
06:   // ---------------- Base Paths ----------------
07:   var python = 'python';
08:   var script = 'src/main/python/run_query.py';
09: 
10:   // ---------------- Read CLI Properties ----------------
11:   var query = karate.properties['query'];
12: 
13:   if (!query) {
14:     karate.log('No query provided ? defaulting to count');
15:     query = 'count';
16:   }
17: 
18:   // ---------------- Build Python Command ----------------
19:   var pythonCmd = python + ' ' + script + ' --query ' + query;
20: 
21:   if (tablename) {
22:     pythonCmd = pythonCmd + ' --tablename ' + tablename;
23:   }
24: 
25:   karate.log('Python Command ===> ', pythonCmd);
26: 
27:   // ---------------- Expose to Features ----------------
28:   return {
29:     env: env,
30:     query: query,
31:     tablename: tablename,
32:     pythonCmd: pythonCmd
33:   };
34: }
<<<<
org.graalvm.polyglot.PolyglotException: ReferenceError: "tablename" is not defined
- <js>.fn(Unnamed:21)

run-query.feature:5
run-query.feature:6
run-query.feature:7
19:59:59.386 [main] INFO  com.intuit.karate.Suite - <<fail>> feature 1 of 1 (0 remaining) run-query.feature
20:03:26.972 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:03:28.335 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766414008324
20:03:33.222 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query count 
20:03:33.323 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query count 
20:05:25.700 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)Executing query... - (6.7s)Executing query... \ (6.8s)Executing query... | (6.9s)Executing query... / (7.0s)Executing query... - (7.1s)Executing query... \ (7.2s)Executing query... | (7.3s)Executing query... / (7.4s)Executing query... - (7.5s)Executing query... \ (7.6s)Executing query... | (7.7s)Executing query... / (7.8s)Executing query... - (7.9s)Executing query... \ (8.0s)Executing query... | (8.1s)Executing query... / (8.2s)Executing query... - (8.3s)Executing query... \ (8.4s)Executing query... | (8.5s)Executing query... / (8.6s)Executing query... - (8.7s)Executing query... \ (8.8s)Executing query... | (8.9s)Executing query... / (9.0s)Executing query... - (9.1s)Executing query... \ (9.2s)Executing query... | (9.3s)Executing query... / (9.4s)Executing query... - (9.5s)Executing query... \ (9.6s)Executing query... | (9.7s)Executing query... / (9.8s)Executing query... - (9.9s)Executing query... \ (10.0s)Executing query... | (10.1s)Executing query... / (10.2s)Executing query... - (10.3s)Executing query... \ (10.4s)Executing query... | (10.5s)Executing query... / (10.6s)Executing query... - (10.7s)Executing query... \ (10.8s)Executing query... | (10.9s)Executing query... / (11.0s)Executing query... - (11.1s)Executing query... \ (11.2s)Executing query... | (11.3s)Executing query... / (11.4s)Executing query... - (11.5s)Executing query... \ (11.6s)Executing query... | (11.7s)Executing query... / (11.8s)Executing query... - (11.9s)Executing query... \ (12.0s)Executing query... | (12.1s)Executing query... / (12.2s)Executing query... - (12.4s)Executing query... \ (12.5s)Executing query... | (12.6s)Executing query... / (12.7s)Executing query... - (12.8s)Executing query... \ (12.9s)Executing query... | (13.0s)Executing query... / (13.1s)Executing query... - (13.2s)Executing query... \ (13.3s)Executing query... | (13.4s)Executing query... / (13.5s)Executing query... - (13.6s)Executing query... \ (13.7s)Executing query... | (13.8s)Executing query... / (13.9s)Executing query... - (14.0s)Executing query... \ (14.1s)Executing query... | (14.2s)Executing query... / (14.3s)Executing query... - (14.4s)Executing query... \ (14.5s)Executing query... | (14.6s)Executing query... / (14.7s)Executing query... - (14.8s)Executing query... \ (14.9s)Executing query... | (15.0s)Executing query... / (15.1s)Executing query... - (15.2s)Executing query... \ (15.3s)Executing query... | (15.4s)Executing query... / (15.5s)Executing query... - (15.6s)Executing query... \ (15.7s)Executing query... | (15.8s)Executing query... / (15.9s)Executing query... - (16.0s)Executing query... \ (16.1s)Executing query... | (16.2s)Executing query... / (16.3s)Executing query... - (16.4s)Executing query... \ (16.6s)Executing query... | (16.7s)Executing query... / (16.8s)Executing query... - (16.9s)Executing query... \ (17.0s)Executing query... | (17.1s)Executing query... / (17.2s)Executing query... - (17.3s)Executing query... \ (17.4s)Executing query... | (17.5s)Executing query... / (17.6s)Executing query... - (17.7s)Executing query... \ (17.8s)Executing query... | (17.9s)Executing query... / (18.0s)Executing query... - (18.1s)Executing query... \ (18.2s)Executing query... | (18.3s)Executing query... / (18.4s)Executing query... - (18.5s)Executing query... \ (18.6s)Executing query... | (18.7s)Executing query... / (18.8s)Executing query... - (18.9s)Executing query... \ (19.0s)Executing query... | (19.1s)Executing query... / (19.2s)Executing query... - (19.3s)Executing query... \ (19.4s)Executing query... | (19.5s)Executing query... / (19.6s)Executing query... - (19.7s)Executing query... \ (19.8s)Executing query... | (19.9s)Executing query... / (20.0s)Executing query... - (20.1s)Executing query... \ (20.2s)Executing query... | (20.3s)Executing query... / (20.4s)Executing query... - (20.5s)Executing query... \ (20.6s)Executing query... | (20.7s)Executing query... / (20.8s)Executing query... - (20.9s)Executing query... \ (21.0s)Executing query... | (21.1s)Executing query... / (21.2s)Executing query... - (21.3s)Executing query... \ (21.4s)Executing query... | (21.5s)Executing query... / (21.6s)Executing query... - (21.7s)Executing query... \ (21.8s)Executing query... | (21.9s)Executing query... / (22.0s)Executing query... - (22.1s)Executing query... \ (22.3s)Executing query... | (22.4s)Executing query... / (22.7s)Executing query... - (22.9s)Executing query... \ (23.1s)Executing query... | (23.2s)Executing query... / (23.3s)Executing query... - (23.5s)Executing query... \ (23.6s)Executing query... | (23.7s)Executing query... / (23.8s)Executing query... - (23.9s)Executing query... \ (24.0s)Executing query... | (24.1s)Executing query... / (24.2s)Executing query... - (24.3s)Executing query... \ (24.4s)Executing query... | (24.6s)Executing query... / (24.7s)Executing query... - (24.9s)Executing query... \ (25.0s)Executing query... | (25.2s)Executing query... / (25.3s)Executing query... - (25.5s)Executing query... \ (25.6s)Executing query... | (25.7s)Executing query... / (25.8s)Executing query... - (25.9s)Executing query... \ (26.0s)Executing query... | (26.2s)Executing query... / (26.3s)Executing query... - (26.4s)Executing query... \ (26.5s)Executing query... | (26.6s)Executing query... / (26.7s)Executing query... - (26.8s)Executing query... \ (26.9s)Executing query... | (27.0s)Executing query... / (27.1s)Executing query... - (27.2s)Executing query... \ (27.3s)Executing query... | (27.4s)Executing query... / (27.5s)Executing query... - (27.6s)Executing query... \ (27.7s)Executing query... | (27.8s)Executing query... / (27.9s)Executing query... - (28.0s)Executing query... \ (28.1s)Executing query... | (28.2s)Executing query... / (28.3s)Executing query... - (28.4s)Executing query... \ (28.5s)Executing query... | (28.6s)Executing query... / (28.7s)Executing query... - (28.8s)Executing query... \ (28.9s)Executing query... | (29.0s)Executing query... / (29.1s)Executing query... - (29.2s)Executing query... \ (29.3s)Executing query... | (29.4s)Executing query... / (29.5s)Executing query... - (29.6s)Executing query... \ (29.7s)Executing query... | (29.8s)Executing query... / (29.9s)Executing query... - (30.0s)Executing query... \ (30.1s)Executing query... | (30.2s)Executing query... / (30.3s)Executing query... - (30.4s)Executing query... \ (30.5s)Executing query... | (30.6s)Executing query... / (30.7s)Executing query... - (30.8s)Executing query... \ (31.0s)Executing query... | (31.1s)Executing query... / (31.2s)Executing query... - (31.3s)Executing query... \ (31.4s)Executing query... | (31.5s)Executing query... / (31.6s)Executing query... - (31.9s)Executing query... \ (32.0s)Executing query... | (32.1s)Executing query... / (32.2s)Executing query... - (32.3s)Executing query... \ (32.4s)Executing query... | (32.5s)Executing query... / (32.6s)Executing query... - (32.7s)Executing query... \ (32.8s)Executing query... | (32.9s)Executing query... / (33.0s)Executing query... - (33.1s)Executing query... \ (33.2s)Executing query... | (33.3s)Executing query... / (33.4s)Executing query... - (33.5s)Executing query... \ (33.6s)Executing query... | (33.7s)Executing query... / (33.9s)Executing query... - (34.0s)Executing query... \ (34.1s)Executing query... | (34.2s)Executing query... / (34.3s)Executing query... - (34.4s)Executing query... \ (34.5s)Executing query... | (34.7s)Executing query... / (34.8s)Executing query... - (34.9s)Executing query... \ (35.0s)Executing query... | (35.1s)Executing query... / (35.2s)Executing query... - (35.3s)Executing query... \ (35.4s)Executing query... | (35.5s)Executing query... / (35.6s)Executing query... - (35.7s)Executing query... \ (35.8s)Executing query... | (35.9s)Executing query... / (36.0s)Executing query... - (36.1s)Executing query... \ (36.2s)Executing query... | (36.3s)Executing query... / (36.4s)Executing query... - (36.5s)Executing query... \ (36.6s)Executing query... | (36.7s)Executing query... / (36.8s)Executing query... - (36.9s)Executing query... \ (37.0s)Executing query... | (37.1s)Executing query... / (37.2s)Executing query... - (37.3s)Executing query... \ (37.4s)Executing query... | (37.5s)Executing query... / (37.6s)Executing query... - (37.7s)Executing query... \ (37.8s)Executing query... | (37.9s)Executing query... / (38.0s)Executing query... - (38.1s)Executing query... \ (38.2s)Executing query... | (38.3s)Executing query... / (38.4s)Executing query... - (38.5s)Executing query... \ (38.6s)Executing query... | (38.7s)Executing query... / (38.8s)Executing query... - (39.0s)Executing query... \ (39.3s)Executing query... | (39.4s)Executing query... / (39.5s)Executing query... - (39.6s)Executing query... \ (39.7s)Executing query... | (39.9s)Executing query... / (40.0s)Executing query... - (40.1s)Executing query... \ (40.2s)Executing query... | (40.3s)Executing query... / (40.4s)Executing query... - (40.5s)Executing query... \ (40.6s)Executing query... | (40.7s)Executing query... / (40.8s)Executing query... - (40.9s)Executing query... \ (41.0s)Executing query... | (41.1s)Executing query... / (41.2s)Executing query... - (41.3s)Executing query... \ (41.4s)Executing query... | (41.5s)Executing query... / (41.6s)Executing query... - (41.7s)Executing query... \ (41.8s)Executing query... | (41.9s)Executing query... / (42.0s)Executing query... - (42.1s)Executing query... \ (42.2s)Executing query... | (42.3s)Executing query... / (42.4s)Executing query... - (42.5s)Executing query... \ (42.6s)Executing query... | (42.7s)Executing query... / (42.8s)Executing query... - (42.9s)Executing query... \ (43.0s)Executing query... | (43.2s)Executing query... / (43.4s)Executing query... - (43.6s)Executing query... \ (43.7s)Executing query... | (44.0s)Executing query... / (44.1s)Executing query... - (44.2s)Executing query... \ (44.4s)Executing query... | (44.5s)Executing query... / (44.6s)Executing query... - (44.8s)Executing query... \ (44.9s)Executing query... | (45.0s)Executing query... / (45.1s)Executing query... - (45.3s)Executing query... \ (45.4s)Executing query... | (45.5s)Executing query... / (45.6s)Executing query... - (45.7s)Executing query... \ (45.8s)Executing query... | (45.9s)Executing query... / (46.0s)Executing query... - (46.1s)Executing query... \ (46.2s)Executing query... | (46.3s)Executing query... / (46.4s)Executing query... - (46.5s)Executing query... \ (46.6s)Executing query... | (46.7s)Executing query... / (46.8s)Executing query... - (46.9s)Executing query... \ (47.0s)Executing query... | (47.1s)Executing query... / (47.2s)Executing query... - (47.3s)Executing query... \ (47.4s)Executing query... | (47.5s)Executing query... / (47.7s)Executing query... - (47.8s)Executing query... \ (48.0s)Executing query... | (48.3s)Executing query... / (48.5s)Executing query... - (48.7s)Executing query... \ (48.8s)Executing query... | (48.9s)Executing query... / (49.0s)Executing query... - (49.1s)Executing query... \ (49.2s)Executing query... | (49.3s)Executing query... / (49.4s)Executing query... - (49.5s)Executing query... \ (49.6s)Executing query... | (49.7s)Executing query... / (49.8s)Executing query... - (49.9s)Executing query... \ (50.0s)Executing query... | (50.2s)Executing query... / (50.3s)Executing query... - (50.4s)Executing query... \ (50.5s)Executing query... | (50.6s)Executing query... / (50.7s)Executing query... - (50.8s)Executing query... \ (50.9s)Executing query... | (51.0s)Executing query... / (51.1s)Executing query... - (51.2s)Executing query... \ (51.3s)Executing query... | (51.4s)Executing query... / (51.5s)Executing query... - (51.6s)Executing query... \ (51.7s)Executing query... | (51.8s)Executing query... / (52.0s)Executing query... - (52.1s)Executing query... \ (52.2s)Executing query... | (52.3s)Executing query... / (52.4s)Executing query... - (52.5s)Executing query... \ (52.6s)Executing query... | (52.7s)Executing query... / (52.8s)Executing query... - (52.9s)Executing query... \ (53.0s)Executing query... | (53.1s)Executing query... / (53.2s)Executing query... - (53.3s)Executing query... \ (53.5s)Executing query... | (53.6s)Executing query... / (53.9s)Executing query... - (54.4s)Executing query... \ (54.6s)Executing query... | (54.7s)Executing query... / (54.9s)Executing query... - (55.0s)Executing query... \ (55.1s)Executing query... | (55.2s)Executing query... / (55.3s)Executing query... - (55.4s)Executing query... \ (55.5s)Executing query... | (55.6s)Executing query... / (55.7s)Executing query... - (55.8s)Executing query... \ (55.9s)Executing query... | (56.0s)Executing query... / (56.1s)Executing query... - (56.2s)Executing query... \ (56.3s)Executing query... | (56.4s)Executing query... / (56.5s)Executing query... - (56.6s)Executing query... \ (56.7s)Executing query... | (56.8s)Executing query... / (56.9s)Executing query... - (57.0s)Executing query... \ (57.1s)Executing query... | (57.2s)Executing query... / (57.3s)Executing query... - (57.4s)Executing query... \ (57.5s)Executing query... | (57.6s)Executing query... / (57.7s)Executing query... - (57.8s)Executing query... \ (57.9s)Executing query... | (58.0s)Executing query... / (58.1s)Executing query... - (58.2s)Executing query... \ (58.3s)Executing query... | (58.4s)Executing query... / (58.5s)Executing query... - (58.6s)Executing query... \ (58.7s)Executing query... | (58.8s)Executing query... / (58.9s)Executing query... - (59.1s)Executing query... \ (59.2s)Executing query... | (59.3s)Executing query... / (59.4s)Executing query... - (59.5s)Executing query... \ (59.6s)Executing query... | (59.7s)Executing query... / (59.8s)Executing query... - (59.9s)Executing query... \ (60.0s)Executing query... | (60.1s)Executing query... / (60.2s)Executing query... - (60.3s)Executing query... \ (60.4s)Executing query... | (60.5s)Executing query... / (60.6s)Executing query... - (60.7s)Executing query... \ (60.8s)Executing query... | (60.9s)Executing query... / (61.0s)Executing query... - (61.1s)Executing query... \ (61.2s)Executing query... | (61.3s)Executing query... / (61.4s)Executing query... - (61.5s)Executing query... \ (61.6s)Executing query... | (61.7s)Executing query... / (61.8s)Executing query... - (61.9s)Executing query... \ (62.0s)Executing query... | (62.1s)Executing query... / (62.2s)Executing query... - (62.3s)Executing query... \ (62.5s)Executing query... | (62.6s)Executing query... / (62.7s)Executing query... - (62.8s)Executing query... \ (62.9s)Executing query... | (63.0s)Executing query... / (63.1s)Executing query... - (63.2s)Executing query... \ (63.3s)Executing query... | (63.4s)Executing query... / (63.5s)Executing query... - (63.6s)Executing query... \ (63.7s)Executing query... | (63.8s)Executing query... / (63.9s)Executing query... - (64.0s)Executing query... \ (64.1s)Executing query... | (64.2s)Executing query... / (64.3s)Executing query... - (64.4s)Executing query... \ (64.5s)Executing query... | (64.6s)Executing query... / (64.7s)Executing query... - (64.8s)Executing query... \ (64.9s)Executing query... | (65.0s)Executing query... / (65.1s)Executing query... - (65.2s)Executing query... \ (65.3s)Executing query... | (65.4s)Executing query... / (65.5s)Executing query... - (65.6s)Executing query... \ (65.7s)Executing query... | (65.8s)Executing query... / (65.9s)Executing query... - (66.0s)Executing query... \ (66.1s)Executing query... | (66.2s)Executing query... / (66.3s)Executing query... - (66.4s)Executing query... \ (66.5s)Executing query... | (66.6s)Executing query... / (66.7s)Executing query... - (66.8s)Executing query... \ (66.9s)Executing query... | (67.0s)Executing query... / (67.1s)Executing query... - (67.2s)Executing query... \ (67.3s)Executing query... | (67.4s)Executing query... / (67.5s)Executing query... - (67.6s)Executing query... \ (67.7s)Executing query... | (67.8s)Executing query... / (68.0s)Executing query... - (68.1s)Executing query... \ (68.2s)Executing query... | (68.3s)Executing query... / (68.4s)Executing query... - (68.5s)Executing query... \ (68.6s)Executing query... | (68.7s)Executing query... / (68.8s)Executing query... - (68.9s)Executing query... \ (69.0s)Executing query... | (69.1s)Executing query... / (69.2s)Executing query... - (69.3s)Executing query... \ (69.4s)Executing query... | (69.5s)Executing query... / (69.6s)Executing query... - (69.7s)Executing query... \ (69.8s)Executing query... | (69.9s)Executing query... / (70.0s)Executing query... - (70.1s)Executing query... \ (70.2s)Executing query... | (70.3s)Executing query... / (70.4s)Executing query... - (70.5s)Executing query... \ (70.6s)Executing query... | (70.7s)Executing query... / (70.8s)Executing query... - (70.9s)Executing query... \ (71.0s)Executing query... | (71.1s)Executing query... / (71.2s)Executing query... - (71.3s)Executing query... \ (71.4s)Executing query... | (71.5s)Executing query... / (71.6s)Executing query... - (71.7s)Executing query... \ (71.8s)Executing query... | (71.9s)Executing query... / (72.0s)Executing query... - (72.1s)Executing query... \ (72.2s)Executing query... | (72.3s)Executing query... / (72.4s)Executing query... - (72.5s)Executing query... \ (72.6s)Executing query... | (72.7s)Executing query... / (72.8s)Executing query... - (72.9s)Executing query... \ (73.0s)Executing query... | (73.1s)Executing query... / (73.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (73.3s)Executing query... \ (73.4s)Executing query... | (73.5s)Executing query... / (73.6s)Executing query... - (73.7s)                                             â?Œ DIFF FOUND â†’ SQL saved to: output/failed_testcases\sdm_think_nq_count_20251222_200410.sqlâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1--------------------------------------------------------------------------------CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251222_200410.csvFinished query: count in 74.59 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251222_200410.csv 
20:05:30.408 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) run-query.feature
20:10:31.931 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:10:32.724 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766414432716
20:10:35.957 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query except_distinct --tablename agency* 
20:10:36.052 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename agency* 
20:10:58.633 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)                                             âœ… Running testcases for tables starting with 'agency'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ agency â–¶â–¶â–¶â–¶ Generated SQL:SELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)Executing testcase... - (1.8s)Executing testcase... \ (1.9s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ agency â–¶â–¶â–¶â–¶ Generated SQL:SELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "agency" AS TABLE_NAME,       `customer_id`,       `payment_threshold`,       `agency_code`,       `remit`,       `discounts`,       `accept_ord`,       `agency_pays_tax`,       `tax_based_on_gross`,       `agency_bill_to`,       `agency_renew_to`,       `ren_commission`,       `new_commission`,       `company`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.agency`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)                                                âœ” Testcase passed â†’ no differences foundðŸ“? Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251222_201049.csvFinished query: except_distinct in 8.71 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251222_201049.csv 
20:11:00.476 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) run-query.feature
20:12:01.486 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:12:02.326 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766414522318
20:12:07.692 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
20:12:07.770 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
20:12:31.699 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)                                             âœ… Running testcases for tables starting with 'address_'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)Executing testcase... - (1.8s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)Executing testcase... - (1.8s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)                                                âœ” Testcase passed â†’ no differences foundðŸ“? Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251222_201220.csvFinished query: except_distinct in 10.78 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251222_201220.csv 
20:12:35.397 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) run-query.feature
20:31:32.760 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:31:33.560 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766415693553
20:31:36.659 [main] INFO  com.intuit.karate - No query provided ? defaulting to count 
20:31:36.678 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query undefined 
20:31:36.796 [main] ERROR com.intuit.karate - features/count.feature:7
* call read('common/run-query.feature')
js failed:
>>>>
01: read('common/run-query.feature')
<<<<
org.graalvm.polyglot.PolyglotException: java.io.FileNotFoundException: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\features\common\run-query.feature (The system cannot find the path specified)
- com.intuit.karate.resource.FileResource.getStream(FileResource.java:98)
- com.intuit.karate.core.FeatureParser.parse(FeatureParser.java:70)
- com.intuit.karate.core.Feature.read(Feature.java:63)
- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:65)
- com.intuit.karate.core.ScenarioEngine.lambda$new$0(ScenarioEngine.java:109)
- <js>.:program(Unnamed:1)

features/count.feature:7
20:31:39.216 [main] INFO  com.intuit.karate.Suite - <<fail>> feature 1 of 1 (0 remaining) features/count.feature
08:37:11.655 [main] INFO  com.intuit.karate - Karate version: 1.5.1
08:37:12.891 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766459232885
08:37:16.747 [main] INFO  com.intuit.karate - No query provided ? defaulting to count 
08:37:16.769 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query undefined 
08:37:16.933 [main] ERROR com.intuit.karate - features/count.feature:7
* call read('features/run-query.feature')
js failed:
>>>>
01: read('features/run-query.feature')
<<<<
org.graalvm.polyglot.PolyglotException: java.io.FileNotFoundException: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\features\features\run-query.feature (The system cannot find the path specified)
- com.intuit.karate.resource.FileResource.getStream(FileResource.java:98)
- com.intuit.karate.core.FeatureParser.parse(FeatureParser.java:70)
- com.intuit.karate.core.Feature.read(Feature.java:63)
- com.intuit.karate.core.ScenarioFileReader.readFile(ScenarioFileReader.java:65)
- com.intuit.karate.core.ScenarioEngine.lambda$new$0(ScenarioEngine.java:109)
- <js>.:program(Unnamed:1)

features/count.feature:7
08:37:19.034 [main] INFO  com.intuit.karate.Suite - <<fail>> feature 1 of 1 (0 remaining) features/count.feature
08:39:10.577 [main] INFO  com.intuit.karate - Karate version: 1.5.1
08:39:11.159 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766459351148
08:39:14.158 [main] INFO  com.intuit.karate - No query provided ? defaulting to count 
08:39:14.191 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query undefined 
08:39:14.578 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query undefined 
08:39:55.912 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: undefinedError running query undefined: SQL file 'sqls\undefined.sql' not found 
08:39:59.503 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/count.feature
08:41:33.149 [main] INFO  com.intuit.karate - Karate version: 1.5.1
08:41:34.223 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766459494197
08:41:37.840 [main] INFO  com.intuit.karate - *** No query provided *** 
08:41:37.859 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query undefined 
08:41:37.969 [main] INFO  com.intuit.karate - [print] query ===>  count 
08:41:38.058 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query undefined 
08:41:57.925 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: undefinedError running query undefined: SQL file 'sqls\undefined.sql' not found 
08:42:02.164 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/count.feature
08:42:10.072 [main] INFO  com.intuit.karate - Karate version: 1.5.1
08:42:11.033 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766459531024
08:42:14.704 [main] INFO  com.intuit.karate - *** No query provided *** 
08:42:14.718 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query undefined 
08:42:14.830 [main] INFO  com.intuit.karate - [print] Inside count.feature: query ===>  count 
08:42:14.918 [main] INFO  com.intuit.karate - [print] pythonCmd ===>  python src/main/python/run_query.py --query undefined 
08:42:30.709 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: undefinedError running query undefined: SQL file 'sqls\undefined.sql' not found 
08:42:34.592 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/count.feature
08:43:45.502 [main] INFO  com.intuit.karate - Karate version: 1.5.1
08:43:46.125 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766459626117
08:43:49.322 [main] INFO  com.intuit.karate - *** No query provided *** 
08:43:49.338 [main] INFO  com.intuit.karate - Python Command ===>  python src/main/python/run_query.py --query undefined 
08:43:49.421 [main] INFO  com.intuit.karate - [print] Inside count.feature: query ===>  count 
08:43:49.487 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query undefined 
08:44:02.036 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: undefinedError running query undefined: SQL file 'sqls\undefined.sql' not found 
08:44:07.594 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/count.feature
08:59:21.570 [main] INFO  com.intuit.karate - Karate version: 1.5.1
08:59:22.745 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766460562737
08:59:27.768 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
08:59:27.857 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:03:15.189 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:03:21.326 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
09:03:21.428 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
09:03:58.850 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.4s)Executing query... - (0.6s)Executing query... \ (0.8s)Executing query... | (1.0s)Executing query... / (1.3s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.9s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.6s)Executing query... - (3.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)                                             âœ… Running testcases for tables starting with 'address_'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)                                                âœ” Testcase passed â†’ no differences foundðŸ“? Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_090346.csvFinished query: except_distinct in 11.59 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_090346.csv 
09:04:02.140 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/except_distinct.feature
09:08:24.606 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:08:25.456 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766461105447
09:08:28.783 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:08:28.811 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:09:49.354 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.8s)Executing query... \ (5.9s)Executing query... | (6.0s)Executing query... / (6.1s)Executing query... - (6.2s)Executing query... \ (6.3s)Executing query... | (6.4s)Executing query... / (6.5s)Executing query... - (6.6s)Executing query... \ (6.7s)Executing query... | (6.8s)Executing query... / (6.9s)Executing query... - (7.0s)Executing query... \ (7.1s)Executing query... | (7.2s)Executing query... / (7.3s)Executing query... - (7.4s)Executing query... \ (7.5s)Executing query... | (7.6s)Executing query... / (7.7s)Executing query... - (7.8s)Executing query... \ (7.9s)Executing query... | (8.0s)Executing query... / (8.1s)Executing query... - (8.2s)Executing query... \ (8.3s)Executing query... | (8.4s)Executing query... / (8.5s)Executing query... - (8.6s)Executing query... \ (8.7s)Executing query... | (8.8s)Executing query... / (8.9s)Executing query... - (9.0s)Executing query... \ (9.1s)Executing query... | (9.2s)Executing query... / (9.3s)Executing query... - (9.5s)Executing query... \ (9.6s)Executing query... | (9.7s)Executing query... / (9.8s)Executing query... - (9.9s)Executing query... \ (10.0s)Executing query... | (10.1s)Executing query... / (10.2s)Executing query... - (10.3s)Executing query... \ (10.4s)Executing query... | (10.5s)Executing query... / (10.6s)Executing query... - (10.7s)Executing query... \ (10.8s)Executing query... | (10.9s)Executing query... / (11.0s)Executing query... - (11.1s)Executing query... \ (11.2s)Executing query... | (11.3s)Executing query... / (11.4s)Executing query... - (11.5s)Executing query... \ (11.6s)Executing query... | (11.7s)Executing query... / (11.8s)Executing query... - (11.9s)Executing query... \ (12.0s)Executing query... | (12.1s)Executing query... / (12.2s)Executing query... - (12.3s)Executing query... \ (12.4s)Executing query... | (12.5s)Executing query... / (12.6s)Executing query... - (12.7s)Executing query... \ (12.8s)Executing query... | (12.9s)Executing query... / (13.0s)Executing query... - (13.1s)Executing query... \ (13.2s)Executing query... | (13.3s)Executing query... / (13.4s)Executing query... - (13.5s)Executing query... \ (13.6s)Executing query... | (13.7s)Executing query... / (13.8s)Executing query... - (13.9s)Executing query... \ (14.0s)Executing query... | (14.1s)Executing query... / (14.2s)Executing query... - (14.3s)Executing query... \ (14.4s)Executing query... | (14.5s)Executing query... / (14.6s)Executing query... - (14.7s)Executing query... \ (14.8s)Executing query... | (14.9s)Executing query... / (15.0s)Executing query... - (15.1s)Executing query... \ (15.2s)Executing query... | (15.3s)Executing query... / (15.4s)Executing query... - (15.5s)Executing query... \ (15.6s)Executing query... | (15.7s)Executing query... / (15.8s)Executing query... - (15.9s)Executing query... \ (16.0s)Executing query... | (16.1s)Executing query... / (16.2s)Executing query... - (16.3s)Executing query... \ (16.4s)Executing query... | (16.5s)Executing query... / (16.6s)Executing query... - (16.7s)Executing query... \ (16.8s)Executing query... | (16.9s)Executing query... / (17.0s)Executing query... - (17.1s)Executing query... \ (17.2s)Executing query... | (17.3s)Executing query... / (17.4s)Executing query... - (17.5s)Executing query... \ (17.6s)Executing query... | (17.7s)Executing query... / (17.8s)Executing query... - (17.9s)Executing query... \ (18.0s)Executing query... | (18.1s)Executing query... / (18.2s)Executing query... - (18.4s)Executing query... \ (18.5s)Executing query... | (18.6s)Executing query... / (18.7s)Executing query... - (18.9s)Executing query... \ (19.0s)Executing query... | (19.1s)Executing query... / (19.2s)Executing query... - (19.3s)Executing query... \ (19.4s)Executing query... | (19.5s)Executing query... / (19.7s)Executing query... - (19.8s)Executing query... \ (19.9s)Executing query... | (20.0s)Executing query... / (20.1s)Executing query... - (20.2s)Executing query... \ (20.3s)Executing query... | (20.4s)Executing query... / (20.5s)Executing query... - (20.6s)Executing query... \ (20.7s)Executing query... | (20.8s)Executing query... / (20.9s)Executing query... - (21.0s)Executing query... \ (21.1s)Executing query... | (21.2s)Executing query... / (21.3s)Executing query... - (21.4s)Executing query... \ (21.5s)Executing query... | (21.6s)Executing query... / (21.7s)Executing query... - (21.8s)Executing query... \ (21.9s)Executing query... | (22.0s)Executing query... / (22.1s)Executing query... - (22.2s)Executing query... \ (22.3s)Executing query... | (22.4s)Executing query... / (22.6s)Executing query... - (22.7s)Executing query... \ (22.8s)Executing query... | (22.9s)Executing query... / (23.0s)Executing query... - (23.1s)Executing query... \ (23.2s)Executing query... | (23.3s)Executing query... / (23.4s)Executing query... - (23.5s)Executing query... \ (23.6s)Executing query... | (23.7s)Executing query... / (23.8s)Executing query... - (23.9s)Executing query... \ (24.0s)Executing query... | (24.1s)Executing query... / (24.2s)Executing query... - (24.3s)Executing query... \ (24.4s)Executing query... | (24.5s)Executing query... / (24.6s)Executing query... - (24.7s)Executing query... \ (24.8s)Executing query... | (24.9s)Executing query... / (25.0s)Executing query... - (25.1s)Executing query... \ (25.2s)Executing query... | (25.3s)Executing query... / (25.4s)Executing query... - (25.5s)Executing query... \ (25.6s)Executing query... | (25.7s)Executing query... / (25.8s)Executing query... - (25.9s)Executing query... \ (26.0s)Executing query... | (26.1s)Executing query... / (26.2s)Executing query... - (26.3s)Executing query... \ (26.4s)Executing query... | (26.5s)Executing query... / (26.6s)Executing query... - (26.7s)Executing query... \ (26.8s)Executing query... | (26.9s)Executing query... / (27.0s)Executing query... - (27.1s)Executing query... \ (27.2s)Executing query... | (27.3s)Executing query... / (27.4s)Executing query... - (27.5s)Executing query... \ (27.6s)Executing query... | (27.7s)Executing query... / (27.8s)Executing query... - (27.9s)Executing query... \ (28.0s)Executing query... | (28.1s)Executing query... / (28.2s)Executing query... - (28.3s)Executing query... \ (28.4s)Executing query... | (28.5s)Executing query... / (28.6s)Executing query... - (28.7s)Executing query... \ (28.8s)Executing query... | (28.9s)Executing query... / (29.0s)Executing query... - (29.1s)Executing query... \ (29.2s)Executing query... | (29.3s)Executing query... / (29.4s)Executing query... - (29.5s)Executing query... \ (29.6s)Executing query... | (29.7s)Executing query... / (29.8s)Executing query... - (29.9s)Executing query... \ (30.0s)Executing query... | (30.1s)Executing query... / (30.2s)Executing query... - (30.3s)Executing query... \ (30.4s)Executing query... | (30.5s)Executing query... / (30.6s)Executing query... - (30.7s)Executing query... \ (30.8s)Executing query... | (30.9s)Executing query... / (31.0s)Executing query... - (31.1s)Executing query... \ (31.2s)Executing query... | (31.3s)Executing query... / (31.4s)Executing query... - (31.5s)Executing query... \ (31.6s)Executing query... | (31.7s)Executing query... / (31.9s)Executing query... - (32.0s)Executing query... \ (32.1s)Executing query... | (32.2s)Executing query... / (32.3s)Executing query... - (32.4s)Executing query... \ (32.5s)Executing query... | (32.6s)Executing query... / (32.7s)Executing query... - (32.8s)Executing query... \ (32.9s)Executing query... | (33.0s)Executing query... / (33.1s)Executing query... - (33.2s)Executing query... \ (33.3s)Executing query... | (33.4s)Executing query... / (33.5s)Executing query... - (33.6s)Executing query... \ (33.7s)Executing query... | (33.8s)Executing query... / (33.9s)Executing query... - (34.0s)Executing query... \ (34.1s)Executing query... | (34.2s)Executing query... / (34.3s)Executing query... - (34.4s)Executing query... \ (34.5s)Executing query... | (34.6s)Executing query... / (34.7s)Executing query... - (34.8s)Executing query... \ (34.9s)Executing query... | (35.0s)Executing query... / (35.1s)Executing query... - (35.2s)Executing query... \ (35.3s)Executing query... | (35.4s)Executing query... / (35.5s)Executing query... - (35.6s)Executing query... \ (35.7s)Executing query... | (35.8s)Executing query... / (35.9s)Executing query... - (36.0s)Executing query... \ (36.1s)Executing query... | (36.2s)Executing query... / (36.3s)Executing query... - (36.4s)Executing query... \ (36.5s)Executing query... | (36.6s)Executing query... / (36.7s)Executing query... - (36.8s)Executing query... \ (36.9s)Executing query... | (37.0s)Executing query... / (37.1s)Executing query... - (37.2s)Executing query... \ (37.3s)Executing query... | (37.4s)Executing query... / (37.5s)Executing query... - (37.6s)Executing query... \ (37.7s)Executing query... | (37.8s)Executing query... / (37.9s)Executing query... - (38.0s)Executing query... \ (38.1s)Executing query... | (38.2s)Executing query... / (38.3s)Executing query... - (38.4s)Executing query... \ (38.5s)Executing query... | (38.6s)Executing query... / (38.7s)Executing query... - (38.8s)Executing query... \ (38.9s)Executing query... | (39.0s)Executing query... / (39.1s)Executing query... - (39.2s)Executing query... \ (39.3s)Executing query... | (39.4s)Executing query... / (39.5s)Executing query... - (39.6s)Executing query... \ (39.7s)Executing query... | (39.8s)Executing query... / (39.9s)Executing query... - (40.0s)Executing query... \ (40.1s)Executing query... | (40.2s)Executing query... / (40.3s)Executing query... - (40.4s)Executing query... \ (40.5s)Executing query... | (40.6s)Executing query... / (40.7s)Executing query... - (40.8s)Executing query... \ (40.9s)Executing query... | (41.0s)Executing query... / (41.1s)Executing query... - (41.2s)Executing query... \ (41.3s)Executing query... | (41.4s)Executing query... / (41.5s)Executing query... - (41.6s)Executing query... \ (41.7s)Executing query... | (41.8s)Executing query... / (41.9s)Executing query... - (42.0s)Executing query... \ (42.1s)Executing query... | (42.2s)Executing query... / (42.3s)Executing query... - (42.4s)Executing query... \ (42.5s)Executing query... | (42.6s)Executing query... / (42.7s)Executing query... - (42.8s)Executing query... \ (42.9s)Executing query... | (43.0s)Executing query... / (43.1s)Executing query... - (43.2s)Executing query... \ (43.3s)Executing query... | (43.4s)Executing query... / (43.5s)Executing query... - (43.6s)Executing query... \ (43.7s)Executing query... | (43.8s)Executing query... / (43.9s)Executing query... - (44.0s)Executing query... \ (44.1s)Executing query... | (44.2s)Executing query... / (44.3s)Executing query... - (44.4s)Executing query... \ (44.5s)Executing query... | (44.6s)Executing query... / (44.7s)Executing query... - (44.8s)Executing query... \ (44.9s)Executing query... | (45.0s)Executing query... / (45.1s)Executing query... - (45.2s)Executing query... \ (45.3s)Executing query... | (45.4s)Executing query... / (45.5s)Executing query... - (45.6s)Executing query... \ (45.7s)Executing query... | (45.8s)Executing query... / (45.9s)Executing query... - (46.0s)Executing query... \ (46.1s)Executing query... | (46.2s)Executing query... / (46.3s)Executing query... - (46.4s)Executing query... \ (46.5s)Executing query... | (46.6s)Executing query... / (46.7s)Executing query... - (46.8s)Executing query... \ (46.9s)Executing query... | (47.0s)Executing query... / (47.1s)Executing query... - (47.2s)Executing query... \ (47.3s)Executing query... | (47.4s)Executing query... / (47.5s)Executing query... - (47.6s)Executing query... \ (47.7s)Executing query... | (47.8s)Executing query... / (47.9s)Executing query... - (48.0s)Executing query... \ (48.1s)Executing query... | (48.2s)Executing query... / (48.3s)Executing query... - (48.5s)Executing query... \ (48.6s)Executing query... | (48.7s)Executing query... / (48.8s)Executing query... - (48.9s)Executing query... \ (49.0s)Executing query... | (49.1s)Executing query... / (49.2s)Executing query... - (49.3s)Executing query... \ (49.4s)Executing query... | (49.5s)Executing query... / (49.6s)Executing query... - (49.7s)Executing query... \ (49.8s)Executing query... | (49.9s)Executing query... / (50.0s)Executing query... - (50.1s)Executing query... \ (50.2s)Executing query... | (50.3s)Executing query... / (50.4s)Executing query... - (50.5s)Executing query... \ (50.6s)Executing query... | (50.7s)Executing query... / (50.8s)Executing query... - (50.9s)Executing query... \ (51.0s)Executing query... | (51.1s)Executing query... / (51.2s)Executing query... - (51.3s)Executing query... \ (51.4s)Executing query... | (51.5s)Executing query... / (51.6s)Executing query... - (51.7s)Executing query... \ (51.8s)Executing query... | (51.9s)Executing query... / (52.0s)Executing query... - (52.1s)Executing query... \ (52.2s)Executing query... | (52.3s)Executing query... / (52.4s)Executing query... - (52.5s)Executing query... \ (52.6s)Executing query... | (52.7s)Executing query... / (52.8s)Executing query... - (52.9s)Executing query... \ (53.0s)Executing query... | (53.1s)Executing query... / (53.2s)Executing query... - (53.3s)Executing query... \ (53.4s)Executing query... | (53.5s)Executing query... / (53.6s)Executing query... - (53.7s)Executing query... \ (53.8s)Executing query... | (53.9s)Executing query... / (54.0s)Executing query... - (54.1s)Executing query... \ (54.2s)Executing query... | (54.3s)Executing query... / (54.4s)Executing query... - (54.5s)Executing query... \ (54.6s)Executing query... | (54.7s)Executing query... / (54.8s)Executing query... - (54.9s)Executing query... \ (55.0s)Executing query... | (55.1s)Executing query... / (55.2s)Executing query... - (55.3s)Executing query... \ (55.4s)Executing query... | (55.5s)Executing query... / (55.6s)Executing query... - (55.7s)Executing query... \ (55.8s)Executing query... | (55.9s)Executing query... / (56.0s)Executing query... - (56.1s)Executing query... \ (56.2s)Executing query... | (56.3s)Executing query... / (56.4s)Executing query... - (56.5s)Executing query... \ (56.6s)Executing query... | (56.7s)Executing query... / (56.8s)Executing query... - (56.9s)Executing query... \ (57.0s)Executing query... | (57.1s)Executing query... / (57.2s)Executing query... - (57.3s)Executing query... \ (57.4s)Executing query... | (57.5s)Executing query... / (57.6s)Executing query... - (57.7s)Executing query... \ (57.8s)Executing query... | (57.9s)Executing query... / (58.0s)Executing query... - (58.1s)Executing query... \ (58.2s)Executing query... | (58.3s)Executing query... / (58.4s)Executing query... - (58.5s)Executing query... \ (58.6s)Executing query... | (58.7s)Executing query... / (58.8s)Executing query... - (58.9s)Executing query... \ (59.0s)Executing query... | (59.1s)Executing query... / (59.2s)Executing query... - (59.3s)Executing query... \ (59.4s)Executing query... | (59.5s)Executing query... / (59.6s)Executing query... - (59.7s)Executing query... \ (59.8s)Executing query... | (59.9s)Executing query... / (60.0s)Executing query... - (60.1s)Executing query... \ (60.2s)Executing query... | (60.3s)Executing query... / (60.4s)Executing query... - (60.5s)Executing query... \ (60.6s)Executing query... | (60.7s)Executing query... / (60.8s)Executing query... - (60.9s)Executing query... \ (61.0s)Executing query... | (61.1s)Executing query... / (61.2s)Executing query... - (61.3s)Executing query... \ (61.4s)Executing query... | (61.5s)Executing query... / (61.6s)Executing query... - (61.7s)Executing query... \ (61.8s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (61.9s)Executing query... / (62.0s)Executing query... - (62.1s)Executing query... \ (62.3s)                                             â?Œ DIFF FOUND â†’ SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_090846.sqlâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1--------------------------------------------------------------------------------CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_090846.csvFinished query: count in 62.61 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_090846.csv 
09:09:52.578 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/count.feature
09:10:38.459 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:10:39.293 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766461239283
09:10:42.890 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
09:10:42.953 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
09:11:09.760 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-04', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-05', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.5s)Executing query... | (0.7s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)                                             âœ… Running testcases for tables starting with 'address_'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)Executing testcase... - (1.8s)Executing testcase... \ (1.9s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.2s)Executing testcase... | (1.3s)Executing testcase... / (1.4s)Executing testcase... - (1.5s)Executing testcase... \ (1.6s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-05"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-04";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)                                                âœ” Testcase passed â†’ no differences foundðŸ“? Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_091058.csvFinished query: except_distinct in 11.06 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_091058.csv 
09:11:13.275 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/except_distinct.feature
09:12:46.127 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:12:46.837 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766461366829
09:12:50.433 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:12:50.476 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:14:17.833 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.4s)Executing query... \ (0.6s)Executing query... | (0.7s)Executing query... / (0.9s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)Executing query... | (7.5s)Executing query... / (7.6s)Executing query... - (7.7s)Executing query... \ (7.8s)Executing query... | (7.9s)Executing query... / (8.0s)Executing query... - (8.1s)Executing query... \ (8.2s)Executing query... | (8.3s)Executing query... / (8.4s)Executing query... - (8.5s)Executing query... \ (8.6s)Executing query... | (8.7s)Executing query... / (8.8s)Executing query... - (8.9s)Executing query... \ (9.0s)Executing query... | (9.1s)Executing query... / (9.2s)Executing query... - (9.3s)Executing query... \ (9.4s)Executing query... | (9.5s)Executing query... / (9.6s)Executing query... - (9.7s)Executing query... \ (9.8s)Executing query... | (9.9s)Executing query... / (10.0s)Executing query... - (10.1s)Executing query... \ (10.2s)Executing query... | (10.3s)Executing query... / (10.4s)Executing query... - (10.5s)Executing query... \ (10.6s)Executing query... | (10.7s)Executing query... / (10.8s)Executing query... - (10.9s)Executing query... \ (11.0s)Executing query... | (11.1s)Executing query... / (11.2s)Executing query... - (11.3s)Executing query... \ (11.4s)Executing query... | (11.5s)Executing query... / (11.6s)Executing query... - (11.7s)Executing query... \ (11.8s)Executing query... | (11.9s)Executing query... / (12.0s)Executing query... - (12.1s)Executing query... \ (12.2s)Executing query... | (12.3s)Executing query... / (12.4s)Executing query... - (12.5s)Executing query... \ (12.6s)Executing query... | (12.7s)Executing query... / (12.8s)Executing query... - (12.9s)Executing query... \ (13.0s)Executing query... | (13.1s)Executing query... / (13.2s)Executing query... - (13.3s)Executing query... \ (13.4s)Executing query... | (13.5s)Executing query... / (13.6s)Executing query... - (13.7s)Executing query... \ (13.8s)Executing query... | (13.9s)Executing query... / (14.0s)Executing query... - (14.1s)Executing query... \ (14.2s)Executing query... | (14.3s)Executing query... / (14.4s)Executing query... - (14.5s)Executing query... \ (14.6s)Executing query... | (14.7s)Executing query... / (14.8s)Executing query... - (14.9s)Executing query... \ (15.0s)Executing query... | (15.1s)Executing query... / (15.2s)Executing query... - (15.3s)Executing query... \ (15.5s)Executing query... | (15.6s)Executing query... / (15.7s)Executing query... - (15.8s)Executing query... \ (15.9s)Executing query... | (16.0s)Executing query... / (16.1s)Executing query... - (16.2s)Executing query... \ (16.3s)Executing query... | (16.4s)Executing query... / (16.5s)Executing query... - (16.6s)Executing query... \ (16.7s)Executing query... | (16.8s)Executing query... / (16.9s)Executing query... - (17.0s)Executing query... \ (17.1s)Executing query... | (17.2s)Executing query... / (17.3s)Executing query... - (17.4s)Executing query... \ (17.5s)Executing query... | (17.6s)Executing query... / (17.7s)Executing query... - (17.8s)Executing query... \ (17.9s)Executing query... | (18.0s)Executing query... / (18.1s)Executing query... - (18.2s)Executing query... \ (18.3s)Executing query... | (18.4s)Executing query... / (18.5s)Executing query... - (18.6s)Executing query... \ (18.7s)Executing query... | (18.8s)Executing query... / (18.9s)Executing query... - (19.0s)Executing query... \ (19.1s)Executing query... | (19.2s)Executing query... / (19.3s)Executing query... - (19.4s)Executing query... \ (19.5s)Executing query... | (19.6s)Executing query... / (19.7s)Executing query... - (19.8s)Executing query... \ (19.9s)Executing query... | (20.0s)Executing query... / (20.1s)Executing query... - (20.2s)Executing query... \ (20.3s)Executing query... | (20.4s)Executing query... / (20.5s)Executing query... - (20.6s)Executing query... \ (20.7s)Executing query... | (20.8s)Executing query... / (20.9s)Executing query... - (21.0s)Executing query... \ (21.1s)Executing query... | (21.2s)Executing query... / (21.3s)Executing query... - (21.4s)Executing query... \ (21.5s)Executing query... | (21.6s)Executing query... / (21.7s)Executing query... - (21.8s)Executing query... \ (21.9s)Executing query... | (22.0s)Executing query... / (22.1s)Executing query... - (22.2s)Executing query... \ (22.3s)Executing query... | (22.4s)Executing query... / (22.5s)Executing query... - (22.6s)Executing query... \ (22.7s)Executing query... | (22.8s)Executing query... / (22.9s)Executing query... - (23.0s)Executing query... \ (23.1s)Executing query... | (23.2s)Executing query... / (23.3s)Executing query... - (23.4s)Executing query... \ (23.5s)Executing query... | (23.6s)Executing query... / (23.7s)Executing query... - (23.8s)Executing query... \ (23.9s)Executing query... | (24.0s)Executing query... / (24.1s)Executing query... - (24.2s)Executing query... \ (24.3s)Executing query... | (24.4s)Executing query... / (24.5s)Executing query... - (24.6s)Executing query... \ (24.7s)Executing query... | (24.8s)Executing query... / (24.9s)Executing query... - (25.0s)Executing query... \ (25.1s)Executing query... | (25.2s)Executing query... / (25.3s)Executing query... - (25.4s)Executing query... \ (25.5s)Executing query... | (25.6s)Executing query... / (25.7s)Executing query... - (25.8s)Executing query... \ (25.9s)Executing query... | (26.0s)Executing query... / (26.1s)Executing query... - (26.2s)Executing query... \ (26.3s)Executing query... | (26.4s)Executing query... / (26.5s)Executing query... - (26.6s)Executing query... \ (26.7s)Executing query... | (26.8s)Executing query... / (26.9s)Executing query... - (27.0s)Executing query... \ (27.1s)Executing query... | (27.2s)Executing query... / (27.3s)Executing query... - (27.4s)Executing query... \ (27.5s)Executing query... | (27.6s)Executing query... / (27.7s)Executing query... - (27.8s)Executing query... \ (27.9s)Executing query... | (28.0s)Executing query... / (28.1s)Executing query... - (28.2s)Executing query... \ (28.3s)Executing query... | (28.4s)Executing query... / (28.5s)Executing query... - (28.6s)Executing query... \ (28.7s)Executing query... | (28.8s)Executing query... / (28.9s)Executing query... - (29.0s)Executing query... \ (29.1s)Executing query... | (29.2s)Executing query... / (29.3s)Executing query... - (29.4s)Executing query... \ (29.5s)Executing query... | (29.6s)Executing query... / (29.7s)Executing query... - (29.8s)Executing query... \ (29.9s)Executing query... | (30.0s)Executing query... / (30.1s)Executing query... - (30.2s)Executing query... \ (30.3s)Executing query... | (30.4s)Executing query... / (30.5s)Executing query... - (30.6s)Executing query... \ (30.7s)Executing query... | (30.8s)Executing query... / (30.9s)Executing query... - (31.1s)Executing query... \ (31.2s)Executing query... | (31.3s)Executing query... / (31.4s)Executing query... - (31.5s)Executing query... \ (31.6s)Executing query... | (31.8s)Executing query... / (31.9s)Executing query... - (32.0s)Executing query... \ (32.1s)Executing query... | (32.2s)Executing query... / (32.3s)Executing query... - (32.4s)Executing query... \ (32.5s)Executing query... | (32.6s)Executing query... / (32.7s)Executing query... - (32.8s)Executing query... \ (32.9s)Executing query... | (33.0s)Executing query... / (33.1s)Executing query... - (33.2s)Executing query... \ (33.3s)Executing query... | (33.4s)Executing query... / (33.5s)Executing query... - (33.6s)Executing query... \ (33.7s)Executing query... | (33.8s)Executing query... / (33.9s)Executing query... - (34.0s)Executing query... \ (34.1s)Executing query... | (34.2s)Executing query... / (34.3s)Executing query... - (34.4s)Executing query... \ (34.5s)Executing query... | (34.6s)Executing query... / (34.7s)Executing query... - (34.8s)Executing query... \ (34.9s)Executing query... | (35.0s)Executing query... / (35.1s)Executing query... - (35.2s)Executing query... \ (35.3s)Executing query... | (35.4s)Executing query... / (35.5s)Executing query... - (35.6s)Executing query... \ (35.7s)Executing query... | (35.8s)Executing query... / (35.9s)Executing query... - (36.0s)Executing query... \ (36.1s)Executing query... | (36.2s)Executing query... / (36.3s)Executing query... - (36.4s)Executing query... \ (36.5s)Executing query... | (36.6s)Executing query... / (36.7s)Executing query... - (36.8s)Executing query... \ (36.9s)Executing query... | (37.0s)Executing query... / (37.1s)Executing query... - (37.2s)Executing query... \ (37.3s)Executing query... | (37.4s)Executing query... / (37.5s)Executing query... - (37.6s)Executing query... \ (37.7s)Executing query... | (37.8s)Executing query... / (37.9s)Executing query... - (38.0s)Executing query... \ (38.1s)Executing query... | (38.2s)Executing query... / (38.3s)Executing query... - (38.4s)Executing query... \ (38.5s)Executing query... | (38.6s)Executing query... / (38.7s)Executing query... - (38.8s)Executing query... \ (38.9s)Executing query... | (39.0s)Executing query... / (39.1s)Executing query... - (39.2s)Executing query... \ (39.3s)Executing query... | (39.4s)Executing query... / (39.5s)Executing query... - (39.6s)Executing query... \ (39.7s)Executing query... | (39.8s)Executing query... / (39.9s)Executing query... - (40.0s)Executing query... \ (40.1s)Executing query... | (40.2s)Executing query... / (40.3s)Executing query... - (40.4s)Executing query... \ (40.5s)Executing query... | (40.6s)Executing query... / (40.7s)Executing query... - (40.8s)Executing query... \ (40.9s)Executing query... | (41.0s)Executing query... / (41.1s)Executing query... - (41.2s)Executing query... \ (41.3s)Executing query... | (41.4s)Executing query... / (41.5s)Executing query... - (41.6s)Executing query... \ (41.7s)Executing query... | (41.8s)Executing query... / (41.9s)Executing query... - (42.0s)Executing query... \ (42.1s)Executing query... | (42.2s)Executing query... / (42.3s)Executing query... - (42.4s)Executing query... \ (42.5s)Executing query... | (42.6s)Executing query... / (42.7s)Executing query... - (42.8s)Executing query... \ (42.9s)Executing query... | (43.0s)Executing query... / (43.1s)Executing query... - (43.2s)Executing query... \ (43.3s)Executing query... | (43.4s)Executing query... / (43.5s)Executing query... - (43.6s)Executing query... \ (43.7s)Executing query... | (43.8s)Executing query... / (43.9s)Executing query... - (44.0s)Executing query... \ (44.1s)Executing query... | (44.2s)Executing query... / (44.3s)Executing query... - (44.4s)Executing query... \ (44.5s)Executing query... | (44.6s)Executing query... / (44.7s)Executing query... - (44.8s)Executing query... \ (44.9s)Executing query... | (45.0s)Executing query... / (45.1s)Executing query... - (45.2s)Executing query... \ (45.3s)Executing query... | (45.4s)Executing query... / (45.5s)Executing query... - (45.6s)Executing query... \ (45.7s)Executing query... | (45.8s)Executing query... / (45.9s)Executing query... - (46.0s)Executing query... \ (46.1s)Executing query... | (46.2s)Executing query... / (46.3s)Executing query... - (46.4s)Executing query... \ (46.5s)Executing query... | (46.6s)Executing query... / (46.7s)Executing query... - (46.8s)Executing query... \ (46.9s)Executing query... | (47.0s)Executing query... / (47.1s)Executing query... - (47.2s)Executing query... \ (47.3s)Executing query... | (47.4s)Executing query... / (47.5s)Executing query... - (47.6s)Executing query... \ (47.7s)Executing query... | (47.8s)Executing query... / (47.9s)Executing query... - (48.0s)Executing query... \ (48.1s)Executing query... | (48.2s)Executing query... / (48.3s)Executing query... - (48.4s)Executing query... \ (48.5s)Executing query... | (48.6s)Executing query... / (48.7s)Executing query... - (48.8s)Executing query... \ (48.9s)Executing query... | (49.0s)Executing query... / (49.1s)Executing query... - (49.2s)Executing query... \ (49.3s)Executing query... | (49.4s)Executing query... / (49.6s)Executing query... - (49.7s)Executing query... \ (49.8s)Executing query... | (49.9s)Executing query... / (50.0s)Executing query... - (50.1s)Executing query... \ (50.2s)Executing query... | (50.3s)Executing query... / (50.4s)Executing query... - (50.5s)Executing query... \ (50.6s)Executing query... | (50.7s)Executing query... / (50.8s)Executing query... - (50.9s)Executing query... \ (51.0s)Executing query... | (51.1s)Executing query... / (51.2s)Executing query... - (51.3s)Executing query... \ (51.4s)Executing query... | (51.5s)Executing query... / (51.6s)Executing query... - (51.7s)Executing query... \ (51.8s)Executing query... | (51.9s)Executing query... / (52.0s)Executing query... - (52.1s)Executing query... \ (52.2s)Executing query... | (52.3s)Executing query... / (52.4s)Executing query... - (52.5s)Executing query... \ (52.6s)Executing query... | (52.7s)Executing query... / (52.8s)Executing query... - (52.9s)Executing query... \ (53.0s)Executing query... | (53.1s)Executing query... / (53.2s)Executing query... - (53.3s)Executing query... \ (53.4s)Executing query... | (53.5s)Executing query... / (53.6s)Executing query... - (53.7s)Executing query... \ (53.8s)Executing query... | (53.9s)Executing query... / (54.0s)Executing query... - (54.1s)Executing query... \ (54.2s)Executing query... | (54.3s)Executing query... / (54.4s)Executing query... - (54.5s)Executing query... \ (54.6s)Executing query... | (54.7s)Executing query... / (54.8s)Executing query... - (54.9s)Executing query... \ (55.0s)Executing query... | (55.1s)Executing query... / (55.2s)Executing query... - (55.3s)Executing query... \ (55.4s)Executing query... | (55.5s)Executing query... / (55.6s)Executing query... - (55.7s)Executing query... \ (55.8s)Executing query... | (55.9s)Executing query... / (56.0s)Executing query... - (56.1s)Executing query... \ (56.2s)Executing query... | (56.3s)Executing query... / (56.4s)Executing query... - (56.5s)Executing query... \ (56.6s)Executing query... | (56.7s)Executing query... / (56.8s)Executing query... - (56.9s)Executing query... \ (57.0s)Executing query... | (57.1s)Executing query... / (57.2s)Executing query... - (57.3s)Executing query... \ (57.4s)Executing query... | (57.5s)Executing query... / (57.6s)Executing query... - (57.7s)Executing query... \ (57.8s)Executing query... | (57.9s)Executing query... / (58.0s)Executing query... - (58.1s)Executing query... \ (58.2s)Executing query... | (58.3s)Executing query... / (58.4s)Executing query... - (58.5s)Executing query... \ (58.6s)Executing query... | (58.7s)Executing query... / (58.8s)Executing query... - (58.9s)Executing query... \ (59.0s)Executing query... | (59.1s)Executing query... / (59.2s)Executing query... - (59.3s)Executing query... \ (59.4s)Executing query... | (59.5s)Executing query... / (59.6s)Executing query... - (59.7s)Executing query... \ (59.8s)Executing query... | (59.9s)Executing query... / (60.0s)Executing query... - (60.1s)Executing query... \ (60.2s)Executing query... | (60.3s)Executing query... / (60.4s)Executing query... - (60.5s)Executing query... \ (60.6s)Executing query... | (60.8s)Executing query... / (60.9s)Executing query... - (61.0s)Executing query... \ (61.1s)Executing query... | (61.2s)Executing query... / (61.3s)Executing query... - (61.4s)Executing query... \ (61.5s)Executing query... | (61.6s)Executing query... / (61.7s)Executing query... - (61.8s)Executing query... \ (61.9s)Executing query... | (62.0s)Executing query... / (62.1s)Executing query... - (62.2s)Executing query... \ (62.3s)Executing query... | (62.4s)Executing query... / (62.5s)Executing query... - (62.6s)Executing query... \ (62.7s)Executing query... | (62.8s)Executing query... / (62.9s)Executing query... - (63.0s)Executing query... \ (63.1s)Executing query... | (63.2s)Executing query... / (63.3s)Executing query... - (63.4s)Executing query... \ (63.5s)Executing query... | (63.6s)Executing query... / (63.7s)Executing query... - (63.8s)Executing query... \ (63.9s)Executing query... | (64.0s)Executing query... / (64.1s)Executing query... - (64.2s)Executing query... \ (64.3s)Executing query... | (64.4s)Executing query... / (64.5s)Executing query... - (64.6s)Executing query... \ (64.7s)Executing query... | (64.8s)Executing query... / (65.0s)Executing query... - (65.1s)Executing query... \ (65.2s)Executing query... | (65.3s)Executing query... / (65.4s)Executing query... - (65.5s)Executing query... \ (65.6s)Executing query... | (65.7s)Executing query... / (65.8s)Executing query... - (65.9s)Executing query... \ (66.0s)Executing query... | (66.1s)Executing query... / (66.2s)Executing query... - (66.3s)Executing query... \ (66.4s)Executing query... | (66.5s)Executing query... / (66.6s)Executing query... - (66.7s)Executing query... \ (66.8s)Executing query... | (66.9s)Executing query... / (67.0s)Executing query... - (67.1s)Executing query... \ (67.2s)Executing query... | (67.3s)Executing query... / (67.4s)Executing query... - (67.5s)Executing query... \ (67.6s)Executing query... | (67.7s)Executing query... / (67.8s)Executing query... - (67.9s)Executing query... \ (68.0s)Executing query... | (68.1s)Executing query... / (68.2s)Executing query... - (68.3s)Executing query... \ (68.4s)Executing query... | (68.5s)Executing query... / (68.6s)Executing query... - (68.7s)Executing query... \ (68.8s)Executing query... | (68.9s)Executing query... / (69.0s)Executing query... - (69.1s)Executing query... \ (69.2s)Executing query... | (69.3s)Executing query... / (69.4s)Executing query... - (69.5s)Executing query... \ (69.6s)Executing query... | (69.7s)Executing query... / (69.8s)Executing query... - (69.9s)Executing query... \ (70.0s)Executing query... | (70.1s)Executing query... / (70.2s)Executing query... - (70.3s)Executing query... \ (70.4s)Executing query... | (70.5s)Executing query... / (70.6s)Executing query... - (70.7s)Executing query... \ (70.8s)Executing query... | (70.9s)Executing query... / (71.0s)Executing query... - (71.1s)Executing query... \ (71.2s)Executing query... | (71.3s)Executing query... / (71.4s)Executing query... - (71.5s)Executing query... \ (71.6s)Executing query... | (71.7s)Executing query... / (71.8s)Executing query... - (71.9s)Executing query... \ (72.0s)Executing query... | (72.1s)Executing query... / (72.2s)Executing query... - (72.3s)Executing query... \ (72.4s)Executing query... | (72.5s)Executing query... / (72.6s)Executing query... - (72.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (72.8s)Executing query... | (72.9s)Executing query... / (73.0s)Executing query... - (73.1s)                                             â?Œ DIFF FOUND â†’ SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_091303.sqlâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1--------------------------------------------------------------------------------CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_091303.csvFinished query: count in 73.84 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_091303.csv 
09:14:21.093 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/schema_compare.feature
09:21:44.243 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:21:44.909 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766461904885
09:21:48.742 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:21:48.776 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:23:22.026 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (1.0s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.8s)Executing query... \ (4.9s)Executing query... | (5.1s)Executing query... / (5.5s)Executing query... - (5.7s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)Executing query... - (6.7s)Executing query... \ (6.8s)Executing query... | (6.9s)Executing query... / (7.0s)Executing query... - (7.1s)Executing query... \ (7.2s)Executing query... | (7.3s)Executing query... / (7.4s)Executing query... - (7.5s)Executing query... \ (7.6s)Executing query... | (7.7s)Executing query... / (7.8s)Executing query... - (7.9s)Executing query... \ (8.0s)Executing query... | (8.1s)Executing query... / (8.2s)Executing query... - (8.3s)Executing query... \ (8.4s)Executing query... | (8.5s)Executing query... / (8.6s)Executing query... - (8.7s)Executing query... \ (8.8s)Executing query... | (8.9s)Executing query... / (9.0s)Executing query... - (9.1s)Executing query... \ (9.2s)Executing query... | (9.3s)Executing query... / (9.4s)Executing query... - (9.5s)Executing query... \ (9.6s)Executing query... | (9.7s)Executing query... / (9.9s)Executing query... - (10.0s)Executing query... \ (10.1s)Executing query... | (10.2s)Executing query... / (10.3s)Executing query... - (10.4s)Executing query... \ (10.5s)Executing query... | (10.6s)Executing query... / (10.7s)Executing query... - (10.8s)Executing query... \ (10.9s)Executing query... | (11.0s)Executing query... / (11.1s)Executing query... - (11.2s)Executing query... \ (11.3s)Executing query... | (11.4s)Executing query... / (11.5s)Executing query... - (11.6s)Executing query... \ (11.7s)Executing query... | (11.8s)Executing query... / (11.9s)Executing query... - (12.0s)Executing query... \ (12.1s)Executing query... | (12.2s)Executing query... / (12.3s)Executing query... - (12.4s)Executing query... \ (12.5s)Executing query... | (12.6s)Executing query... / (12.7s)Executing query... - (12.8s)Executing query... \ (12.9s)Executing query... | (13.0s)Executing query... / (13.1s)Executing query... - (13.2s)Executing query... \ (13.3s)Executing query... | (13.4s)Executing query... / (13.5s)Executing query... - (13.6s)Executing query... \ (13.7s)Executing query... | (13.8s)Executing query... / (13.9s)Executing query... - (14.0s)Executing query... \ (14.1s)Executing query... | (14.2s)Executing query... / (14.3s)Executing query... - (14.4s)Executing query... \ (14.5s)Executing query... | (14.6s)Executing query... / (14.7s)Executing query... - (14.8s)Executing query... \ (14.9s)Executing query... | (15.0s)Executing query... / (15.1s)Executing query... - (15.2s)Executing query... \ (15.3s)Executing query... | (15.4s)Executing query... / (15.5s)Executing query... - (15.6s)Executing query... \ (15.7s)Executing query... | (15.8s)Executing query... / (15.9s)Executing query... - (16.0s)Executing query... \ (16.1s)Executing query... | (16.2s)Executing query... / (16.3s)Executing query... - (16.4s)Executing query... \ (16.5s)Executing query... | (16.6s)Executing query... / (16.7s)Executing query... - (16.8s)Executing query... \ (16.9s)Executing query... | (17.0s)Executing query... / (17.1s)Executing query... - (17.2s)Executing query... \ (17.3s)Executing query... | (17.4s)Executing query... / (17.5s)Executing query... - (17.6s)Executing query... \ (17.7s)Executing query... | (17.8s)Executing query... / (17.9s)Executing query... - (18.0s)Executing query... \ (18.1s)Executing query... | (18.3s)Executing query... / (18.4s)Executing query... - (18.5s)Executing query... \ (18.6s)Executing query... | (18.7s)Executing query... / (18.8s)Executing query... - (18.9s)Executing query... \ (19.0s)Executing query... | (19.1s)Executing query... / (19.2s)Executing query... - (19.3s)Executing query... \ (19.4s)Executing query... | (19.5s)Executing query... / (19.6s)Executing query... - (19.7s)Executing query... \ (19.8s)Executing query... | (19.9s)Executing query... / (20.0s)Executing query... - (20.1s)Executing query... \ (20.2s)Executing query... | (20.3s)Executing query... / (20.4s)Executing query... - (20.5s)Executing query... \ (20.6s)Executing query... | (20.7s)Executing query... / (20.8s)Executing query... - (20.9s)Executing query... \ (21.0s)Executing query... | (21.1s)Executing query... / (21.2s)Executing query... - (21.3s)Executing query... \ (21.4s)Executing query... | (21.5s)Executing query... / (21.6s)Executing query... - (21.7s)Executing query... \ (21.8s)Executing query... | (21.9s)Executing query... / (22.0s)Executing query... - (22.1s)Executing query... \ (22.2s)Executing query... | (22.3s)Executing query... / (22.4s)Executing query... - (22.5s)Executing query... \ (22.6s)Executing query... | (22.7s)Executing query... / (22.8s)Executing query... - (22.9s)Executing query... \ (23.0s)Executing query... | (23.1s)Executing query... / (23.2s)Executing query... - (23.3s)Executing query... \ (23.4s)Executing query... | (23.5s)Executing query... / (23.6s)Executing query... - (23.7s)Executing query... \ (23.8s)Executing query... | (23.9s)Executing query... / (24.0s)Executing query... - (24.1s)Executing query... \ (24.2s)Executing query... | (24.3s)Executing query... / (24.4s)Executing query... - (24.5s)Executing query... \ (24.7s)Executing query... | (24.8s)Executing query... / (24.9s)Executing query... - (25.0s)Executing query... \ (25.1s)Executing query... | (25.2s)Executing query... / (25.3s)Executing query... - (25.4s)Executing query... \ (25.5s)Executing query... | (25.6s)Executing query... / (25.7s)Executing query... - (25.8s)Executing query... \ (25.9s)Executing query... | (26.0s)Executing query... / (26.1s)Executing query... - (26.2s)Executing query... \ (26.3s)Executing query... | (26.4s)Executing query... / (26.5s)Executing query... - (26.6s)Executing query... \ (26.8s)Executing query... | (26.9s)Executing query... / (27.0s)Executing query... - (27.1s)Executing query... \ (27.2s)Executing query... | (27.3s)Executing query... / (27.4s)Executing query... - (27.5s)Executing query... \ (27.6s)Executing query... | (27.7s)Executing query... / (27.8s)Executing query... - (27.9s)Executing query... \ (28.0s)Executing query... | (28.1s)Executing query... / (28.2s)Executing query... - (28.3s)Executing query... \ (28.4s)Executing query... | (28.5s)Executing query... / (28.7s)Executing query... - (28.8s)Executing query... \ (28.9s)Executing query... | (29.0s)Executing query... / (29.1s)Executing query... - (29.2s)Executing query... \ (29.3s)Executing query... | (29.4s)Executing query... / (29.5s)Executing query... - (29.6s)Executing query... \ (29.7s)Executing query... | (29.8s)Executing query... / (29.9s)Executing query... - (30.0s)Executing query... \ (30.1s)Executing query... | (30.2s)Executing query... / (30.3s)Executing query... - (30.4s)Executing query... \ (30.5s)Executing query... | (30.8s)Executing query... / (30.9s)Executing query... - (31.2s)Executing query... \ (31.3s)Executing query... | (31.4s)Executing query... / (31.6s)Executing query... - (31.7s)Executing query... \ (31.8s)Executing query... | (31.9s)Executing query... / (32.0s)Executing query... - (32.1s)Executing query... \ (32.3s)Executing query... | (32.4s)Executing query... / (32.5s)Executing query... - (32.6s)Executing query... \ (32.7s)Executing query... | (32.8s)Executing query... / (32.9s)Executing query... - (33.0s)Executing query... \ (33.1s)Executing query... | (33.2s)Executing query... / (33.3s)Executing query... - (33.4s)Executing query... \ (33.5s)Executing query... | (33.7s)Executing query... / (33.8s)Executing query... - (33.9s)Executing query... \ (34.0s)Executing query... | (34.1s)Executing query... / (34.2s)Executing query... - (34.3s)Executing query... \ (34.4s)Executing query... | (34.5s)Executing query... / (34.6s)Executing query... - (34.7s)Executing query... \ (34.8s)Executing query... | (34.9s)Executing query... / (35.0s)Executing query... - (35.1s)Executing query... \ (35.2s)Executing query... | (35.3s)Executing query... / (35.4s)Executing query... - (35.5s)Executing query... \ (35.6s)Executing query... | (35.7s)Executing query... / (35.9s)Executing query... - (36.0s)Executing query... \ (36.1s)Executing query... | (36.3s)Executing query... / (36.4s)Executing query... - (36.5s)Executing query... \ (36.6s)Executing query... | (36.7s)Executing query... / (36.8s)Executing query... - (36.9s)Executing query... \ (37.1s)Executing query... | (37.2s)Executing query... / (37.3s)Executing query... - (37.4s)Executing query... \ (37.6s)Executing query... | (37.7s)Executing query... / (37.8s)Executing query... - (38.0s)Executing query... \ (38.1s)Executing query... | (38.2s)Executing query... / (38.3s)Executing query... - (38.4s)Executing query... \ (38.5s)Executing query... | (38.6s)Executing query... / (38.7s)Executing query... - (38.8s)Executing query... \ (38.9s)Executing query... | (39.0s)Executing query... / (39.1s)Executing query... - (39.2s)Executing query... \ (39.3s)Executing query... | (39.4s)Executing query... / (39.5s)Executing query... - (39.6s)Executing query... \ (39.7s)Executing query... | (39.8s)Executing query... / (39.9s)Executing query... - (40.3s)Executing query... \ (40.4s)Executing query... | (40.5s)Executing query... / (40.7s)Executing query... - (40.9s)Executing query... \ (41.0s)Executing query... | (41.1s)Executing query... / (41.2s)Executing query... - (41.4s)Executing query... \ (41.5s)Executing query... | (41.7s)Executing query... / (41.9s)Executing query... - (42.1s)Executing query... \ (42.2s)Executing query... | (42.4s)Executing query... / (42.5s)Executing query... - (42.6s)Executing query... \ (42.7s)Executing query... | (42.8s)Executing query... / (42.9s)Executing query... - (43.0s)Executing query... \ (43.1s)Executing query... | (43.2s)Executing query... / (43.3s)Executing query... - (43.4s)Executing query... \ (43.5s)Executing query... | (43.6s)Executing query... / (43.7s)Executing query... - (43.8s)Executing query... \ (43.9s)Executing query... | (44.0s)Executing query... / (44.1s)Executing query... - (44.2s)Executing query... \ (44.3s)Executing query... | (44.4s)Executing query... / (44.5s)Executing query... - (44.6s)Executing query... \ (44.7s)Executing query... | (44.8s)Executing query... / (44.9s)Executing query... - (45.0s)Executing query... \ (45.1s)Executing query... | (45.2s)Executing query... / (45.3s)Executing query... - (45.4s)Executing query... \ (45.5s)Executing query... | (45.6s)Executing query... / (45.7s)Executing query... - (45.8s)Executing query... \ (45.9s)Executing query... | (46.0s)Executing query... / (46.1s)Executing query... - (46.2s)Executing query... \ (46.3s)Executing query... | (46.4s)Executing query... / (46.5s)Executing query... - (46.6s)Executing query... \ (46.7s)Executing query... | (46.8s)Executing query... / (46.9s)Executing query... - (47.0s)Executing query... \ (47.1s)Executing query... | (47.2s)Executing query... / (47.3s)Executing query... - (47.4s)Executing query... \ (47.5s)Executing query... | (47.6s)Executing query... / (47.7s)Executing query... - (47.8s)Executing query... \ (47.9s)Executing query... | (48.0s)Executing query... / (48.1s)Executing query... - (48.2s)Executing query... \ (48.3s)Executing query... | (48.4s)Executing query... / (48.5s)Executing query... - (48.6s)Executing query... \ (48.7s)Executing query... | (48.8s)Executing query... / (48.9s)Executing query... - (49.0s)Executing query... \ (49.1s)Executing query... | (49.2s)Executing query... / (49.3s)Executing query... - (49.4s)Executing query... \ (49.5s)Executing query... | (49.6s)Executing query... / (49.7s)Executing query... - (49.8s)Executing query... \ (49.9s)Executing query... | (50.0s)Executing query... / (50.1s)Executing query... - (50.2s)Executing query... \ (50.3s)Executing query... | (50.4s)Executing query... / (50.5s)Executing query... - (50.6s)Executing query... \ (50.7s)Executing query... | (50.8s)Executing query... / (50.9s)Executing query... - (51.0s)Executing query... \ (51.2s)Executing query... | (51.3s)Executing query... / (51.4s)Executing query... - (51.5s)Executing query... \ (51.6s)Executing query... | (51.7s)Executing query... / (51.8s)Executing query... - (51.9s)Executing query... \ (52.0s)Executing query... | (52.1s)Executing query... / (52.2s)Executing query... - (52.3s)Executing query... \ (52.4s)Executing query... | (52.5s)Executing query... / (52.6s)Executing query... - (52.7s)Executing query... \ (52.8s)Executing query... | (52.9s)Executing query... / (53.0s)Executing query... - (53.1s)Executing query... \ (53.2s)Executing query... | (53.3s)Executing query... / (53.4s)Executing query... - (53.5s)Executing query... \ (53.6s)Executing query... | (53.7s)Executing query... / (53.8s)Executing query... - (53.9s)Executing query... \ (54.0s)Executing query... | (54.1s)Executing query... / (54.2s)Executing query... - (54.3s)Executing query... \ (54.4s)Executing query... | (54.5s)Executing query... / (54.6s)Executing query... - (54.7s)Executing query... \ (54.8s)Executing query... | (54.9s)Executing query... / (55.0s)Executing query... - (55.1s)Executing query... \ (55.2s)Executing query... | (55.3s)Executing query... / (55.4s)Executing query... - (55.5s)Executing query... \ (55.6s)Executing query... | (55.7s)Executing query... / (55.8s)Executing query... - (55.9s)Executing query... \ (56.0s)Executing query... | (56.1s)Executing query... / (56.2s)Executing query... - (56.3s)Executing query... \ (56.4s)Executing query... | (56.5s)Executing query... / (56.6s)Executing query... - (56.7s)Executing query... \ (56.8s)Executing query... | (56.9s)Executing query... / (57.0s)Executing query... - (57.1s)Executing query... \ (57.2s)Executing query... | (57.3s)Executing query... / (57.4s)Executing query... - (57.5s)Executing query... \ (57.6s)Executing query... | (57.7s)Executing query... / (57.8s)Executing query... - (57.9s)Executing query... \ (58.0s)Executing query... | (58.1s)Executing query... / (58.2s)Executing query... - (58.3s)Executing query... \ (58.4s)Executing query... | (58.5s)Executing query... / (58.6s)Executing query... - (58.7s)Executing query... \ (58.8s)Executing query... | (58.9s)Executing query... / (59.0s)Executing query... - (59.1s)Executing query... \ (59.2s)Executing query... | (59.4s)Executing query... / (59.5s)Executing query... - (59.6s)Executing query... \ (59.7s)Executing query... | (59.8s)Executing query... / (59.9s)Executing query... - (60.0s)Executing query... \ (60.1s)Executing query... | (60.2s)Executing query... / (60.3s)Executing query... - (60.4s)Executing query... \ (60.5s)Executing query... | (60.6s)Executing query... / (60.7s)Executing query... - (60.8s)Executing query... \ (60.9s)Executing query... | (61.0s)Executing query... / (61.1s)Executing query... - (61.2s)Executing query... \ (61.3s)Executing query... | (61.4s)Executing query... / (61.5s)Executing query... - (61.6s)Executing query... \ (61.7s)Executing query... | (61.8s)Executing query... / (61.9s)Executing query... - (62.0s)Executing query... \ (62.1s)Executing query... | (62.2s)Executing query... / (62.3s)Executing query... - (62.4s)Executing query... \ (62.5s)Executing query... | (62.6s)Executing query... / (62.7s)Executing query... - (62.8s)Executing query... \ (62.9s)Executing query... | (63.0s)Executing query... / (63.1s)Executing query... - (63.2s)Executing query... \ (63.3s)Executing query... | (63.4s)Executing query... / (63.5s)Executing query... - (63.6s)Executing query... \ (63.7s)Executing query... | (63.8s)Executing query... / (63.9s)Executing query... - (64.0s)Executing query... \ (64.1s)Executing query... | (64.2s)Executing query... / (64.3s)Executing query... - (64.4s)Executing query... \ (64.5s)Executing query... | (64.6s)Executing query... / (64.7s)Executing query... - (64.8s)Executing query... \ (64.9s)Executing query... | (65.0s)Executing query... / (65.1s)Executing query... - (65.2s)Executing query... \ (65.3s)Executing query... | (65.4s)Executing query... / (65.5s)Executing query... - (65.6s)Executing query... \ (65.7s)Executing query... | (65.8s)Executing query... / (65.9s)Executing query... - (66.0s)Executing query... \ (66.1s)Executing query... | (66.2s)Executing query... / (66.3s)Executing query... - (66.4s)Executing query... \ (66.5s)Executing query... | (66.6s)Executing query... / (66.7s)Executing query... - (66.8s)Executing query... \ (66.9s)Executing query... | (67.0s)Executing query... / (67.1s)Executing query... - (67.2s)Executing query... \ (67.3s)Executing query... | (67.4s)Executing query... / (67.5s)Executing query... - (67.6s)Executing query... \ (67.7s)Executing query... | (67.8s)Executing query... / (67.9s)Executing query... - (68.0s)Executing query... \ (68.1s)Executing query... | (68.2s)Executing query... / (68.3s)Executing query... - (68.4s)Executing query... \ (68.5s)Executing query... | (68.7s)Executing query... / (69.1s)Executing query... - (69.3s)Executing query... \ (69.4s)Executing query... | (69.6s)Executing query... / (69.7s)Executing query... - (69.8s)Executing query... \ (69.9s)Executing query... | (70.0s)Executing query... / (70.1s)Executing query... - (70.2s)Executing query... \ (70.3s)Executing query... | (70.4s)Executing query... / (70.5s)Executing query... - (70.6s)Executing query... \ (70.7s)Executing query... | (70.8s)Executing query... / (70.9s)Executing query... - (71.0s)Executing query... \ (71.1s)Executing query... | (71.2s)Executing query... / (71.3s)Executing query... - (71.4s)Executing query... \ (71.5s)Executing query... | (71.8s)Executing query... / (72.0s)Executing query... - (72.5s)Executing query... \ (72.6s)Executing query... | (72.7s)Executing query... / (72.8s)Executing query... - (73.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (73.1s)Executing query... | (73.3s)Executing query... / (73.4s)Executing query... - (73.5s)Executing query... \ (73.6s)                                             â?Œ DIFF FOUND â†’ SQL saved to: output/failed_testcases\sdm_think_nq_count_20251223_092207.sqlâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-04')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-05')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1--------------------------------------------------------------------------------CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_think_nq_count_20251223_092207.csvFinished query: count in 74.17 seconds, CSV saved at output\testcase_results\sdm_think_nq_count_20251223_092207.csv 
09:23:27.910 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/schema_compare.feature
09:24:51.605 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:24:52.344 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766462092333
09:24:55.577 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:24:55.612 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:25:20.563 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (0.6s)Executing query... | (0.9s)Executing query... / (1.6s)Executing query... - (1.8s)Executing query... \ (2.1s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)Executing query... - (4.0s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.5s)Executing query... | (4.6s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (4.7s)Executing query... - (4.8s)Executing query... \ (4.9s)Executing query... | (5.0s)Executing query... / (5.1s)Executing query... - (5.2s)Executing query... \ (5.3s)Executing query... | (5.4s)Executing query... / (5.5s)Executing query... - (5.6s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_think_nq_schema_compare_20251223_092514_schema_diff.csvFinished query: schema_compare in 6.00 seconds, CSV saved at output\testcase_results\sdm_think_nq_schema_compare_20251223_092514.csv 
09:25:24.513 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/schema_compare.feature
12:52:55.282 [main] INFO  com.intuit.karate - Karate version: 1.5.1
12:52:56.369 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1766474576363
12:53:00.981 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
12:53:01.059 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
12:53:39.684 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.5s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)Executing query... - (4.0s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.5s)Executing query... | (4.6s)Executing query... / (4.7s)Executing query... - (4.8s)Executing query... \ (4.9s)Executing query... | (5.0s)Executing query... / (5.1s)Executing query... - (5.2s)Executing query... \ (5.3s)Executing query... | (5.4s)Executing query... / (5.5s)Executing query... - (5.6s)Executing query... \ (5.7s)Executing query... | (5.8s)Executing query... / (5.9s)Executing query... - (6.0s)Executing query... \ (6.1s)Executing query... | (6.2s)Executing query... / (6.3s)Executing query... - (6.4s)Executing query... \ (6.5s)Executing query... | (6.6s)Executing query... / (6.7s)Executing query... - (6.8s)Executing query... \ (6.9s)Executing query... | (7.0s)Executing query... / (7.1s)Executing query... - (7.2s)Executing query... \ (7.3s)Executing query... | (7.4s)Executing query... / (7.5s)Executing query... - (7.6s)Executing query... \ (7.7s)Executing query... | (7.8s)Executing query... / (7.9s)Executing query... - (8.0s)Executing query... \ (8.1s)Executing query... | (8.3s)Executing query... / (8.4s)Executing query... - (8.5s)Executing query... \ (8.6s)Executing query... | (8.7s)Executing query... / (8.8s)Executing query... - (8.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (9.0s)Executing query... | (9.1s)Executing query... / (9.2s)Executing query... - (9.3s)                                             âœ… Running testcases for tables starting with 'address_'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)Executing testcase... - (1.8s)Executing testcase... \ (1.9s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)                                                âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)                                                âœ” Testcase passed â†’ no differences foundðŸ“? Testcase results saved: output\testcase_results\sdm_think_nq_except_distinct_20251223_125322.csvFinished query: except_distinct in 17.18 seconds, CSV saved at output\testcase_results\sdm_think_nq_except_distinct_20251223_125322.csv 
12:53:41.782 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/except_distinct.feature
09:08:22.525 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:08:23.295 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1767843503286
09:08:26.425 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:08:26.448 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:08:52.752 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260108_090848_schema_diff.csvFinished query: schema_compare in 4.27 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_schema_compare_20260108_090848.csv 
09:08:55.359 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/schema_compare.feature
09:15:55.795 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:16:41.816 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:16:42.598 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1767844002591
09:16:45.546 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:16:45.584 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:17:06.999 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.1s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260108_091701_schema_diff.csvFinished query: schema_compare in 5.20 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_schema_compare_20260108_091701.csv 
09:17:09.526 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_schema_compare.feature
10:58:37.692 [main] INFO  com.intuit.karate - Karate version: 1.5.1
10:58:39.408 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1767850119395
10:58:44.302 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
10:58:44.354 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
10:59:17.787 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.2s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.7s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260108_105912_schema_diff.csvFinished query: schema_compare in 5.13 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_schema_compare_20260108_105912.csv 
10:59:21.515 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_schema_compare.feature
11:23:42.719 [main] INFO  com.intuit.karate - Karate version: 1.5.1
11:23:43.518 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1767851623506
11:23:49.172 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
11:23:49.220 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
11:24:21.381 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.6s)Executing query... \ (1.9s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)Executing query... - (6.7s)Executing query... \ (6.8s)Executing query... | (6.9s)Executing query... / (7.0s)Executing query... - (7.1s)Executing query... \ (7.2s)Executing query... | (7.3s)Executing query... / (7.4s)Executing query... - (7.5s)Executing query... \ (7.6s)Executing query... | (7.7s)Executing query... / (7.8s)Executing query... - (7.9s)Executing query... \ (8.0s)Executing query... | (8.1s)Executing query... / (8.2s)Executing query... - (8.3s)Executing query... \ (8.4s)Executing query... | (8.5s)Executing query... / (8.6s)Executing query... - (8.7s)Executing query... \ (8.8s)Executing query... | (8.9s)Executing query... / (9.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (9.1s)Executing query... \ (9.2s)Executing query... | (9.3s)Executing query... / (9.5s)                                             â?Œ DIFF FOUND â†’ SQL saved to: output/failed_testcases\sdm_rcti_nq_count_20260108_112411.sqlâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------CSV saved: D:\Users\ganesany\Desktop\YG\GIT\DGWDataServiceAutomationPython\output\testcase_results\sdm_rcti_nq_count_20260108_112411.csvFinished query: count in 9.97 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_count_20260108_112411.csv 
11:24:24.606 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_count.feature
11:28:33.799 [main] INFO  com.intuit.karate - Karate version: 1.5.1
11:28:34.553 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1767851914545
11:28:37.408 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
11:28:37.459 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename address_* 
11:28:54.333 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)                                             Error running query except_distinct: â?Œ No testcases found matching tables starting with 'address_'. 
11:28:57.533 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
11:30:23.487 [main] INFO  com.intuit.karate - Karate version: 1.5.1
11:30:24.162 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1767852024155
11:30:27.355 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_wool* 
11:30:27.431 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_wool* 
11:31:16.511 [main] INFO  com.intuit.karate - [print] result ===>  Started fetching and parsing all the configuration files ... Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)                                             âœ… Running testcases for tables starting with 'rcti_wool'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)Executing testcase... - (1.8s)Executing testcase... \ (1.9s)Executing testcase... | (2.0s)Executing testcase... / (2.1s)Executing testcase... - (2.2s)Executing testcase... \ (2.4s)Executing testcase... | (2.5s)Executing testcase... / (3.2s)Executing testcase... - (3.3s)Executing testcase... \ (3.4s)Executing testcase... | (3.6s)Executing testcase... / (4.1s)Executing testcase... - (4.2s)Executing testcase... \ (4.3s)Executing testcase... | (4.4s)Executing testcase... / (4.5s)Executing testcase... - (4.6s)Executing testcase... \ (4.7s)Executing testcase... | (4.8s)Executing testcase... / (4.9s)Executing testcase... - (5.0s)Executing testcase... \ (5.1s)Executing testcase... | (5.2s)Executing testcase... / (5.3s)Executing testcase... - (5.4s)Executing testcase... \ (5.5s)Executing testcase... | (5.6s)Executing testcase... / (5.7s)Executing testcase... - (5.8s)Executing testcase... \ (5.9s)Executing testcase... | (6.0s)Executing testcase... / (6.2s)Executing testcase... - (6.3s)Executing testcase... \ (6.4s)Executing testcase... | (6.5s)Executing testcase... / (6.6s)Executing testcase... - (6.7s)Executing testcase... \ (6.8s)Executing testcase... | (6.9s)Executing testcase... / (7.0s)Executing testcase... - (7.1s)Executing testcase... \ (7.2s)Executing testcase... | (7.3s)Executing testcase... / (7.4s)Executing testcase... - (7.6s)Executing testcase... \ (7.7s)Executing testcase... | (7.8s)Executing testcase... / (7.9s)Executing testcase... - (8.0s)Executing testcase... \ (8.3s)Executing testcase... | (9.3s)Executing testcase... / (10.1s)                                                âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_woolies_bluebook_ext_FAILED.sqlâ?Œ Testcase failed â†’ 15010 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing testcase... | (0.0s)Executing testcase... / (0.1s)Executing testcase... - (0.2s)Executing testcase... \ (0.3s)Executing testcase... | (0.4s)Executing testcase... / (0.5s)Executing testcase... - (0.6s)Executing testcase... \ (0.7s)Executing testcase... | (0.8s)Executing testcase... / (0.9s)Executing testcase... - (1.0s)Executing testcase... \ (1.1s)Executing testcase... | (1.2s)Executing testcase... / (1.3s)Executing testcase... - (1.4s)Executing testcase... \ (1.5s)Executing testcase... | (1.6s)Executing testcase... / (1.7s)                                                âœ” Testcase passed â†’ no differences foundðŸ“? Testcase results saved: output\testcase_results\sdm_rcti_nq_except_distinct_20260108_113059.csvFinished query: except_distinct in 16.59 seconds, CSV saved at output\testcase_results\sdm_rcti_nq_except_distinct_20260108_113059.csv 
11:31:19.456 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
14:00:56.525 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:00:57.850 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768206657834
14:01:03.161 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:01:03.230 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:01:41.437 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)Executing query... | (7.5s)Executing query... / (7.6s)Executing query... - (7.7s)Executing query... \ (7.8s)Executing query... | (7.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (8.0s)Executing query... - (8.1s)Executing query... \ (8.2s)Executing query... | (8.3s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 9.36s â†’ output/testcase_results\sdm_rcti_nq_count_20260112_140131.csvâœ… All queries completed successfully 
14:01:44.893 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_count.feature
14:02:56.102 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:02:57.127 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768206777117
14:03:02.978 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:03:03.066 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:03:28.373 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.3s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260112_140324_schema_diff.csvFinished query: schema_compare in 3.56s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260112_140324.csvâœ… All queries completed successfully 
14:03:31.444 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_schema_compare.feature
14:07:18.062 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:07:18.975 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768207038969
14:07:22.218 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_wool* 
14:07:22.254 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_wool* 
14:07:49.549 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (1.0s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)                                             âœ… Running testcases for tables starting with 'rcti_wool'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)Executing query... - (6.8s)Executing query... \ (6.9s)Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_woolies_bluebook_ext.sqlâ?Œ Testcase failed â†’ 15010 differing row(s) foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_140735_filtered_tables.csvFinished query: except_distinct in 13.58s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260112_140735.csvâœ… All queries completed successfully 
14:07:52.679 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
14:26:46.038 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:26:46.832 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768208206824
14:26:49.876 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
14:26:49.918 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
14:27:26.790 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.2s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (4.0s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.1s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.5s)Executing query... | (4.7s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_142707_filtered_tables.csvFinished query: except_distinct in 19.40s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260112_142707.csvâœ… All queries completed successfully 
14:27:29.862 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
14:29:25.149 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:29:25.902 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768208365892
14:29:29.267 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct 
14:29:29.340 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct 
14:29:49.486 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.5s)Executing query... / (0.7s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)                                             Finished query: except_distinct in 3.15s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260112_142946.csvâœ… All queries completed successfully 
14:29:51.520 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
14:32:25.622 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:32:26.369 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768208546359
14:32:34.010 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
14:32:34.314 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
14:34:05.396 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (3.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)                                             âœ… Running testcases for tables starting with ''Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.4s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (6.4s)Executing query... | (7.4s)Executing query... / (7.7s)Executing query... - (8.4s)Executing query... \ (8.5s)Executing query... | (8.6s)Executing query... / (8.7s)Executing query... - (8.8s)Executing query... \ (8.9s)Executing query... | (9.0s)Executing query... / (9.1s)Executing query... - (9.2s)Executing query... \ (9.3s)Executing query... | (9.4s)Executing query... / (9.5s)Executing query... - (9.6s)Executing query... \ (9.7s)Executing query... | (9.8s)Executing query... / (9.9s)Executing query... - (10.0s)Executing query... \ (10.1s)Executing query... | (10.2s)Executing query... / (10.3s)Executing query... - (10.4s)Executing query... \ (10.5s)Executing query... | (10.6s)Executing query... / (10.7s)Executing query... - (10.8s)Executing query... \ (10.9s)Executing query... | (11.0s)Executing query... / (11.1s)Executing query... - (11.2s)Executing query... \ (11.4s)Executing query... | (11.5s)Executing query... / (11.6s)Executing query... - (11.7s)Executing query... \ (11.8s)Executing query... | (11.9s)Executing query... / (12.0s)Executing query... - (12.1s)Executing query... \ (12.2s)Executing query... | (12.4s)Executing query... / (12.5s)Executing query... - (12.6s)Executing query... \ (12.7s)Executing query... | (12.9s)Executing query... / (13.0s)Executing query... - (13.1s)Executing query... \ (13.2s)Executing query... | (13.3s)Executing query... / (13.4s)Executing query... - (13.5s)Executing query... \ (13.6s)Executing query... | (13.7s)Executing query... / (13.8s)Executing query... - (13.9s)Executing query... \ (14.0s)Executing query... | (14.1s)Executing query... / (14.2s)Executing query... - (14.3s)Executing query... \ (14.4s)Executing query... | (14.5s)Executing query... / (14.6s)Executing query... - (14.7s)Executing query... \ (14.8s)Executing query... | (14.9s)Executing query... / (15.0s)Executing query... - (15.1s)Executing query... \ (15.2s)Executing query... | (15.3s)Executing query... / (15.4s)Executing query... - (15.5s)Executing query... \ (15.6s)Executing query... | (15.7s)Executing query... / (15.8s)Executing query... - (15.9s)Executing query... \ (16.0s)Executing query... | (16.1s)Executing query... / (16.3s)Executing query... - (16.4s)Executing query... \ (16.5s)Executing query... | (16.6s)Executing query... / (16.7s)Executing query... - (16.8s)Executing query... \ (16.9s)Executing query... | (17.0s)Executing query... / (17.1s)Executing query... - (17.2s)Executing query... \ (17.3s)Executing query... | (17.4s)Executing query... / (17.5s)Executing query... - (17.6s)Executing query... \ (17.7s)Executing query... | (17.8s)Executing query... / (17.9s)Executing query... - (18.0s)Executing query... \ (18.1s)Executing query... | (18.2s)Executing query... / (18.3s)Executing query... - (18.4s)Executing query... \ (18.5s)Executing query... | (19.5s)Executing query... / (19.7s)Executing query... - (19.8s)Executing query... \ (20.0s)Executing query... | (20.1s)Executing query... / (20.4s)Executing query... - (20.5s)Executing query... \ (20.6s)Executing query... | (20.7s)Executing query... / (20.8s)Executing query... - (20.9s)Executing query... \ (21.0s)Executing query... | (21.1s)Executing query... / (21.2s)Executing query... - (21.3s)Executing query... \ (21.4s)Executing query... | (21.5s)Executing query... / (21.6s)Executing query... - (21.7s)Executing query... \ (21.8s)Executing query... | (21.9s)Executing query... / (22.0s)Executing query... - (22.1s)Executing query... \ (22.2s)Executing query... | (22.3s)Executing query... / (22.4s)Executing query... - (22.5s)Executing query... \ (22.6s)Executing query... | (22.7s)Executing query... / (22.8s)Executing query... - (22.9s)Executing query... \ (23.0s)Executing query... | (23.1s)Executing query... / (23.2s)Executing query... - (23.3s)Executing query... \ (23.6s)Executing query... | (23.8s)Executing query... / (23.9s)Executing query... - (24.1s)Executing query... \ (24.5s)Executing query... | (24.6s)Executing query... / (24.7s)Executing query... - (24.8s)Executing query... \ (24.9s)Executing query... | (25.0s)Executing query... / (25.1s)Executing query... - (25.2s)Executing query... \ (25.3s)Executing query... | (25.4s)Executing query... / (25.5s)Executing query... - (25.6s)Executing query... \ (25.7s)Executing query... | (25.8s)Executing query... / (25.9s)Executing query... - (26.0s)Executing query... \ (26.1s)Executing query... | (26.2s)Executing query... / (26.3s)Executing query... - (26.4s)Executing query... \ (26.5s)Executing query... | (26.6s)Executing query... / (26.8s)Executing query... - (26.9s)Executing query... \ (27.0s)Executing query... | (27.1s)Executing query... / (27.2s)Executing query... - (27.3s)Executing query... \ (27.4s)Executing query... | (27.5s)Executing query... / (27.6s)Executing query... - (27.8s)Executing query... \ (28.0s)Executing query... | (28.1s)Executing query... / (28.2s)Executing query... - (28.3s)Executing query... \ (28.7s)Executing query... | (28.8s)Executing query... / (28.9s)Executing query... - (29.0s)Executing query... \ (29.1s)Executing query... | (29.2s)Executing query... / (29.3s)Executing query... - (29.4s)Executing query... \ (29.5s)Executing query... | (29.6s)Executing query... / (29.7s)Executing query... - (29.8s)Executing query... \ (29.9s)Executing query... | (30.0s)Executing query... / (30.1s)Executing query... - (30.2s)Executing query... \ (30.3s)Executing query... | (30.4s)Executing query... / (30.5s)Executing query... - (30.6s)Executing query... \ (30.7s)Executing query... | (30.8s)Executing query... / (30.9s)Executing query... - (31.0s)Executing query... \ (31.1s)Executing query... | (31.2s)Executing query... / (31.3s)Executing query... - (31.4s)Executing query... \ (31.6s)Executing query... | (31.8s)Executing query... / (32.2s)Executing query... - (32.3s)Executing query... \ (32.4s)Executing query... | (32.6s)Executing query... / (32.9s)Executing query... - (33.0s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_payonscan_bluebook_ext.sqlâ?Œ Testcase failed â†’ 96315 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)Executing query... | (7.6s)Executing query... / (7.7s)Executing query... - (7.8s)Executing query... \ (7.9s)Executing query... | (8.0s)Executing query... / (8.1s)Executing query... - (8.2s)Executing query... \ (8.3s)Executing query... | (8.4s)Executing query... / (8.5s)Executing query... - (8.6s)Executing query... \ (8.7s)Executing query... | (8.8s)Executing query... / (8.9s)Executing query... - (9.0s)Executing query... \ (9.1s)Executing query... | (9.3s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_7eleven_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9772 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.3s)Executing query... / (5.7s)Executing query... - (5.8s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_woolies_bluebook_ext.sqlâ?Œ Testcase failed â†’ 15010 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143250_filtered_tables.csvFinished query: except_distinct in 74.39s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143250.csvâœ… All queries completed successfully 
14:34:08.027 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
14:38:07.852 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:38:08.632 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768208888625
14:38:11.809 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
14:38:11.850 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
14:38:52.973 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.4s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.6s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143832_filtered_tables_result.csvFinished query: except_distinct in 20.15s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260112_143832.csvâœ… All queries completed successfully 
14:38:55.425 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
09:46:21.909 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:46:23.808 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768277783795
09:46:27.277 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:46:27.315 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:47:09.398 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.5s)Executing query... \ (0.7s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 7.07s â†’ output/testcase_results\sdm_rcti_nq_count_20260113_094702.csvâœ… All queries completed successfully 
09:47:11.662 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
09:47:11.696 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
09:47:11.712 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
09:49:22.076 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.4s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.6s)Executing query... \ (4.3s)Executing query... | (4.4s)                                             âœ… Running testcases for tables starting with ''Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (1.1s)Executing query... | (1.5s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.5s)Executing query... \ (4.9s)Executing query... | (5.4s)Executing query... / (5.5s)Executing query... - (7.1s)Executing query... \ (7.3s)Executing query... | (7.4s)Executing query... / (7.6s)Executing query... - (7.7s)Executing query... \ (7.8s)Executing query... | (7.9s)Executing query... / (8.3s)Executing query... - (10.2s)Executing query... \ (10.3s)Executing query... | (10.4s)Executing query... / (10.6s)Executing query... - (10.7s)Executing query... \ (10.8s)Executing query... | (13.5s)Executing query... / (14.6s)Executing query... - (15.6s)Executing query... \ (16.0s)Executing query... | (16.6s)Executing query... / (16.7s)Executing query... - (16.8s)Executing query... \ (16.9s)Executing query... | (17.1s)Executing query... / (17.2s)Executing query... - (17.6s)Executing query... \ (17.7s)Executing query... | (17.8s)Executing query... / (17.9s)Executing query... - (18.0s)Executing query... \ (18.9s)Executing query... | (19.0s)Executing query... / (19.1s)Executing query... - (19.3s)Executing query... \ (19.4s)Executing query... | (19.5s)Executing query... / (19.8s)Executing query... - (19.9s)Executing query... \ (20.1s)Executing query... | (20.2s)Executing query... / (20.3s)Executing query... - (20.4s)Executing query... \ (20.5s)Executing query... | (20.7s)Executing query... / (21.2s)Executing query... - (21.3s)Executing query... \ (21.4s)Executing query... | (21.7s)Executing query... / (21.8s)Executing query... - (22.1s)Executing query... \ (22.2s)Executing query... | (22.5s)Executing query... / (22.6s)Executing query... - (22.8s)Executing query... \ (22.9s)Executing query... | (25.3s)Executing query... / (25.6s)Executing query... - (26.8s)Executing query... \ (27.2s)Executing query... | (27.6s)Executing query... / (27.9s)Executing query... - (28.0s)Executing query... \ (28.1s)Executing query... | (28.2s)Executing query... / (28.3s)Executing query... - (28.4s)Executing query... \ (28.5s)Executing query... | (28.7s)Executing query... / (29.1s)Executing query... - (29.2s)Executing query... \ (29.3s)Executing query... | (34.5s)Executing query... / (34.7s)Executing query... - (35.1s)Executing query... \ (35.5s)Executing query... | (35.7s)Executing query... / (35.8s)Executing query... - (35.9s)Executing query... \ (36.3s)Executing query... | (41.1s)Executing query... / (41.3s)Executing query... - (42.0s)Executing query... \ (43.3s)Executing query... | (43.4s)Executing query... / (43.7s)Executing query... - (45.4s)Executing query... \ (46.2s)Executing query... | (46.4s)Executing query... / (46.5s)Executing query... - (46.6s)Executing query... \ (47.9s)Executing query... | (48.0s)Executing query... / (48.1s)Executing query... - (48.2s)Executing query... \ (48.4s)Executing query... | (48.5s)Executing query... / (48.6s)Executing query... - (48.8s)Executing query... \ (48.9s)Executing query... | (49.2s)Executing query... / (50.9s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_payonscan_bluebook_ext.sqlâ?Œ Testcase failed â†’ 96315 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.6s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.3s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.9s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.5s)Executing query... | (4.6s)Executing query... / (4.7s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.7s)Executing query... | (6.9s)Executing query... / (7.0s)Executing query... - (7.1s)Executing query... \ (7.2s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_7eleven_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9772 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (1.2s)Executing query... - (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.6s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.9s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.8s)Executing query... \ (4.9s)Executing query... | (5.0s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)Executing query... - (6.7s)Executing query... \ (6.9s)Executing query... | (7.0s)Executing query... / (7.1s)Executing query... - (7.2s)Executing query... \ (7.3s)Executing query... | (7.4s)Executing query... / (7.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)Executing query... | (5.6s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)Executing query... - (7.2s)Executing query... \ (7.3s)Executing query... | (7.4s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (7.1s)Executing query... / (7.4s)Executing query... - (7.5s)Executing query... \ (7.7s)Executing query... | (7.8s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_woolies_bluebook_ext.sqlâ?Œ Testcase failed â†’ 15010 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260113_094734_filtered_tables_result.csvFinished query: except_distinct in 107.07s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260113_094734.csvâœ… All queries completed successfully 
09:49:23.153 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
09:49:23.352 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:49:23.554 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
09:49:46.987 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260113_094942_schema_diff.csvFinished query: schema_compare in 4.40s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260113_094942.csvâœ… All queries completed successfully 
09:49:47.564 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
14:20:56.009 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:20:57.625 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768294257610
14:21:01.893 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:21:01.932 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:21:38.317 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.6s)Executing query... - (0.8s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 6.08s â†’ output/testcase_results\sdm_rcti_nq_count_20260113_142131.csvâœ… All queries completed successfully 
14:21:40.903 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
14:21:40.998 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
14:21:41.100 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
14:22:19.361 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.8s)Executing query... - (4.0s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.9s)Executing query... | (5.0s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260113_142158_filtered_tables_result.csvFinished query: except_distinct in 21.03s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260113_142158.csvâœ… All queries completed successfully 
14:22:19.793 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
14:22:19.821 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:22:19.844 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:22:39.484 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260113_142235_schema_diff.csvFinished query: schema_compare in 3.81s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260113_142235.csvâœ… All queries completed successfully 
14:22:39.607 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
13:52:10.960 [main] INFO  com.intuit.karate - Karate version: 1.5.1
13:52:13.228 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768359133194
13:52:45.551 [main] INFO  com.intuit.karate - Karate version: 1.5.1
13:52:46.952 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768359166937
13:53:32.079 [main] INFO  com.intuit.karate - Karate version: 1.5.1
13:53:32.945 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768359212930
13:53:37.218 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
13:53:37.264 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
13:54:39.365 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (1.0s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.1s)Executing query... - (6.6s)Executing query... \ (6.7s)Executing query... | (6.8s)Executing query... / (6.9s)Executing query... - (7.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (8.6s)Executing query... | (8.8s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 9.46s â†’ output/testcase_results\sdm_rcti_nq_count_20260114_135429.csvâœ… All queries completed successfully 
13:54:42.372 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
13:54:42.414 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
13:54:42.436 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
13:55:28.829 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (0.8s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.4s)Executing query... / (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.5s)Executing query... - (5.9s)Executing query... \ (6.0s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.5s)Executing query... \ (5.7s)Executing query... | (5.8s)Executing query... / (5.9s)Executing query... - (6.2s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_135504_filtered_tables_result.csvFinished query: except_distinct in 23.26s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260114_135504.csvâœ… All queries completed successfully 
13:55:29.916 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
13:55:29.945 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
13:55:29.963 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
13:55:57.613 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.5s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.4s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.7s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_135551_schema_diff.csvFinished query: schema_compare in 4.28s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260114_135551.csvâœ… All queries completed successfully 
13:55:57.807 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
14:11:16.016 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:11:17.115 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768360277102
14:11:20.721 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:11:20.745 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:11:50.469 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.4s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 7.80s â†’ output/testcase_results\sdm_rcti_nq_count_20260114_141142.csvâœ… All queries completed successfully 
14:11:53.374 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
14:11:53.408 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
14:11:53.423 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
14:12:37.200 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.7s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (3.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.5s)Executing query... / (3.9s)Executing query... - (4.1s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.4s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.6s)Executing query... - (6.7s)Executing query... \ (6.8s)Executing query... | (6.9s)Executing query... / (7.0s)Executing query... - (7.1s)Executing query... \ (7.2s)Executing query... | (7.3s)Executing query... / (7.4s)Executing query... - (7.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (1.3s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141211_filtered_tables_result.csvFinished query: except_distinct in 24.93s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141211.csvâœ… All queries completed successfully 
14:12:37.880 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
14:12:37.938 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:12:37.958 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:12:55.887 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_141251_schema_diff.csvFinished query: schema_compare in 3.78s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260114_141251.csvâœ… All queries completed successfully 
14:12:56.343 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
14:15:46.100 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:15:46.981 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768360546972
14:15:51.864 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:15:51.913 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:16:19.074 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)Executing query... - (4.0s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.5s)Executing query... | (4.6s)Executing query... / (4.7s)Executing query... - (4.8s)Executing query... \ (4.9s)Executing query... | (5.0s)Executing query... / (5.1s)Executing query... - (5.2s)Executing query... \ (5.3s)Executing query... | (5.4s)Executing query... / (5.5s)Executing query... - (5.6s)Executing query... \ (5.7s)Executing query... | (5.8s)Executing query... / (5.9s)Executing query... - (6.0s)Executing query... \ (6.1s)Executing query... | (6.2s)Executing query... / (6.3s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (6.4s)Executing query... \ (6.5s)Executing query... | (6.6s)Executing query... / (6.7s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 7.12s â†’ output/testcase_results\sdm_rcti_nq_count_20260114_141611.csvâœ… All queries completed successfully 
14:16:22.167 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
14:16:22.204 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
14:16:22.227 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
14:17:00.648 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.4s)Executing query... - (0.6s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)Executing query... \ (6.0s)Executing query... | (6.1s)Executing query... / (6.2s)Executing query... - (6.3s)Executing query... \ (6.4s)Executing query... | (6.5s)Executing query... / (6.7s)Executing query... - (6.8s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.8s)Executing query... \ (5.9s)Executing query... | (6.0s)Executing query... / (6.1s)Executing query... - (6.2s)Executing query... \ (6.4s)Executing query... | (6.6s)Executing query... / (6.7s)Executing query... - (6.8s)Executing query... \ (6.9s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141637_filtered_tables_result.csvFinished query: except_distinct in 23.12s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260114_141637.csvâœ… All queries completed successfully 
14:17:00.931 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
14:17:00.948 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:17:00.965 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:17:17.669 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.4s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (0.7s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_141713_schema_diff.csvFinished query: schema_compare in 4.24s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260114_141713.csvâœ… All queries completed successfully 
14:17:18.158 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
14:36:11.861 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:36:12.887 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768361772879
14:36:22.603 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:36:22.675 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:38:19.419 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.8s)Executing query... \ (5.9s)Executing query... | (6.0s)Executing query... / (6.1s)Executing query... - (6.2s)Executing query... \ (6.3s)Executing query... | (6.4s)Executing query... / (6.5s)Executing query... - (6.6s)Executing query... \ (6.7s)Executing query... | (6.8s)Executing query... / (6.9s)Executing query... - (7.1s)Executing query... \ (7.2s)Executing query... | (7.3s)Executing query... / (7.4s)Executing query... - (7.5s)Executing query... \ (7.6s)Executing query... | (7.7s)Executing query... / (7.8s)Executing query... - (7.9s)Executing query... \ (8.0s)Executing query... | (8.1s)Executing query... / (8.2s)Executing query... - (8.3s)Executing query... \ (8.4s)Executing query... | (8.5s)Executing query... / (8.6s)Executing query... - (8.7s)Executing query... \ (8.8s)Executing query... | (8.9s)Executing query... / (9.0s)Executing query... - (9.1s)Executing query... \ (9.2s)Executing query... | (9.3s)Executing query... / (9.4s)Executing query... - (9.5s)Executing query... \ (9.6s)Executing query... | (9.7s)Executing query... / (9.8s)Executing query... - (9.9s)Executing query... \ (10.0s)Executing query... | (10.1s)Executing query... / (10.2s)Executing query... - (10.3s)Executing query... \ (10.4s)Executing query... | (10.5s)Executing query... / (10.6s)Executing query... - (10.7s)Executing query... \ (10.8s)Executing query... | (10.9s)Executing query... / (11.0s)Executing query... - (11.1s)Executing query... \ (11.2s)Executing query... | (11.3s)Executing query... / (11.4s)Executing query... - (11.5s)Executing query... \ (11.6s)Executing query... | (11.7s)Executing query... / (11.8s)Executing query... - (11.9s)Executing query... \ (12.0s)Executing query... | (12.1s)Executing query... / (12.2s)Executing query... - (12.3s)Executing query... \ (12.4s)Executing query... | (12.5s)Executing query... / (12.6s)Executing query... - (12.7s)Executing query... \ (12.8s)Executing query... | (12.9s)Executing query... / (13.0s)Executing query... - (13.1s)Executing query... \ (13.2s)Executing query... | (13.3s)Executing query... / (13.5s)Executing query... - (13.6s)Executing query... \ (13.7s)Executing query... | (13.8s)Executing query... / (13.9s)Executing query... - (14.0s)Executing query... \ (14.1s)Executing query... | (14.2s)Executing query... / (14.3s)Executing query... - (14.4s)Executing query... \ (14.5s)Executing query... | (14.6s)Executing query... / (14.7s)Executing query... - (14.8s)Executing query... \ (15.0s)Executing query... | (15.1s)Executing query... / (15.2s)Executing query... - (15.3s)Executing query... \ (15.4s)Executing query... | (15.5s)Executing query... / (15.6s)Executing query... - (15.7s)Executing query... \ (15.8s)Executing query... | (15.9s)Executing query... / (16.0s)Executing query... - (16.1s)Executing query... \ (16.2s)Executing query... | (16.3s)Executing query... / (16.4s)Executing query... - (16.5s)Executing query... \ (16.6s)Executing query... | (16.7s)Executing query... / (16.8s)Executing query... - (16.9s)Executing query... \ (17.0s)Executing query... | (17.1s)Executing query... / (17.2s)Executing query... - (17.3s)Executing query... \ (17.4s)Executing query... | (17.5s)Executing query... / (17.6s)Executing query... - (17.7s)Executing query... \ (17.8s)Executing query... | (17.9s)Executing query... / (18.0s)Executing query... - (18.1s)Executing query... \ (18.2s)Executing query... | (18.3s)Executing query... / (18.4s)Executing query... - (18.5s)Executing query... \ (18.6s)Executing query... | (18.7s)Executing query... / (18.8s)Executing query... - (19.2s)Executing query... \ (19.5s)Executing query... | (19.6s)Executing query... / (19.7s)Executing query... - (19.8s)Executing query... \ (19.9s)Executing query... | (20.0s)Executing query... / (20.1s)Executing query... - (20.2s)Executing query... \ (20.3s)Executing query... | (20.4s)Executing query... / (20.5s)Executing query... - (20.6s)Executing query... \ (20.7s)Executing query... | (20.8s)Executing query... / (20.9s)Executing query... - (21.0s)Executing query... \ (21.1s)Executing query... | (21.2s)Executing query... / (21.3s)Executing query... - (21.4s)Executing query... \ (21.5s)Executing query... | (21.6s)Executing query... / (21.7s)Executing query... - (21.8s)Executing query... \ (21.9s)Executing query... | (22.0s)Executing query... / (22.1s)Executing query... - (22.2s)Executing query... \ (22.3s)Executing query... | (22.4s)Executing query... / (22.5s)Executing query... - (22.6s)Executing query... \ (22.7s)Executing query... | (22.8s)Executing query... / (22.9s)Executing query... - (23.0s)Executing query... \ (23.1s)Executing query... | (23.2s)Executing query... / (23.3s)Executing query... - (23.4s)Executing query... \ (23.5s)Executing query... | (23.6s)Executing query... / (23.7s)Executing query... - (23.8s)Executing query... \ (23.9s)Executing query... | (24.0s)Executing query... / (24.1s)Executing query... - (24.2s)Executing query... \ (24.3s)Executing query... | (24.4s)Executing query... / (24.5s)Executing query... - (24.6s)Executing query... \ (24.7s)Executing query... | (24.8s)Executing query... / (24.9s)Executing query... - (25.0s)Executing query... \ (25.1s)Executing query... | (25.2s)Executing query... / (25.3s)Executing query... - (25.4s)Executing query... \ (25.5s)Executing query... | (25.6s)Executing query... / (25.7s)Executing query... - (25.8s)Executing query... \ (25.9s)Executing query... | (26.0s)Executing query... / (26.1s)Executing query... - (26.2s)Executing query... \ (26.3s)Executing query... | (26.4s)Executing query... / (26.5s)Executing query... - (26.6s)Executing query... \ (26.7s)Executing query... | (26.8s)Executing query... / (26.9s)Executing query... - (27.0s)Executing query... \ (27.1s)Executing query... | (27.2s)Executing query... / (27.3s)Executing query... - (27.4s)Executing query... \ (27.5s)Executing query... | (27.6s)Executing query... / (27.7s)Executing query... - (27.8s)Executing query... \ (27.9s)Executing query... | (28.0s)Executing query... / (28.1s)Executing query... - (28.2s)Executing query... \ (28.3s)Executing query... | (28.4s)Executing query... / (28.5s)Executing query... - (28.6s)Executing query... \ (28.7s)Executing query... | (28.8s)Executing query... / (28.9s)Executing query... - (29.0s)Executing query... \ (29.1s)Executing query... | (29.2s)Executing query... / (29.3s)Executing query... - (29.4s)Executing query... \ (29.5s)Executing query... | (29.6s)Executing query... / (29.7s)Executing query... - (29.8s)Executing query... \ (29.9s)Executing query... | (30.0s)Executing query... / (30.1s)Executing query... - (30.2s)Executing query... \ (30.3s)Executing query... | (30.4s)Executing query... / (30.5s)Executing query... - (30.6s)Executing query... \ (30.7s)Executing query... | (30.8s)Executing query... / (30.9s)Executing query... - (31.0s)Executing query... \ (31.1s)Executing query... | (31.2s)Executing query... / (31.3s)Executing query... - (31.4s)Executing query... \ (31.5s)Executing query... | (31.6s)Executing query... / (31.7s)Executing query... - (31.9s)Executing query... \ (32.0s)Executing query... | (32.1s)Executing query... / (32.2s)Executing query... - (32.3s)Executing query... \ (32.4s)Executing query... | (32.5s)Executing query... / (32.6s)Executing query... - (32.7s)Executing query... \ (32.8s)Executing query... | (32.9s)Executing query... / (33.0s)Executing query... - (33.1s)Executing query... \ (33.2s)Executing query... | (33.3s)Executing query... / (33.4s)Executing query... - (33.5s)Executing query... \ (33.6s)Executing query... | (33.7s)Executing query... / (33.8s)Executing query... - (33.9s)Executing query... \ (34.0s)Executing query... | (34.1s)Executing query... / (34.2s)Executing query... - (34.3s)Executing query... \ (34.4s)Executing query... | (34.5s)Executing query... / (34.6s)Executing query... - (34.7s)Executing query... \ (34.8s)Executing query... | (34.9s)Executing query... / (35.0s)Executing query... - (35.1s)Executing query... \ (35.2s)Executing query... | (35.3s)Executing query... / (35.4s)Executing query... - (35.5s)Executing query... \ (35.6s)Executing query... | (35.7s)Executing query... / (35.8s)Executing query... - (35.9s)Executing query... \ (36.0s)Executing query... | (36.1s)Executing query... / (36.2s)Executing query... - (36.3s)Executing query... \ (36.4s)Executing query... | (36.5s)Executing query... / (36.6s)Executing query... - (36.7s)Executing query... \ (36.8s)Executing query... | (36.9s)Executing query... / (37.0s)Executing query... - (37.1s)Executing query... \ (37.2s)Executing query... | (37.3s)Executing query... / (37.4s)Executing query... - (37.5s)Executing query... \ (37.6s)Executing query... | (37.7s)Executing query... / (37.8s)Executing query... - (37.9s)Executing query... \ (38.0s)Executing query... | (38.1s)Executing query... / (38.2s)Executing query... - (38.3s)Executing query... \ (38.4s)Executing query... | (38.5s)Executing query... / (38.6s)Executing query... - (38.7s)Executing query... \ (38.8s)Executing query... | (38.9s)Executing query... / (39.0s)Executing query... - (39.1s)Executing query... \ (39.2s)Executing query... | (39.3s)Executing query... / (39.4s)Executing query... - (39.5s)Executing query... \ (39.6s)Executing query... | (39.7s)Executing query... / (39.8s)Executing query... - (39.9s)Executing query... \ (40.0s)Executing query... | (40.1s)Executing query... / (40.2s)Executing query... - (40.3s)Executing query... \ (40.4s)Executing query... | (40.5s)Executing query... / (40.6s)Executing query... - (40.7s)Executing query... \ (40.9s)Executing query... | (41.0s)Executing query... / (41.1s)Executing query... - (41.2s)Executing query... \ (41.3s)Executing query... | (41.4s)Executing query... / (41.5s)Executing query... - (41.6s)Executing query... \ (41.7s)Executing query... | (41.8s)Executing query... / (41.9s)Executing query... - (42.0s)Executing query... \ (42.1s)Executing query... | (42.2s)Executing query... / (42.3s)Executing query... - (42.4s)Executing query... \ (42.5s)Executing query... | (42.6s)Executing query... / (42.7s)Executing query... - (42.8s)Executing query... \ (42.9s)Executing query... | (43.0s)Executing query... / (43.1s)Executing query... - (43.2s)Executing query... \ (43.3s)Executing query... | (43.4s)Executing query... / (43.5s)Executing query... - (43.6s)Executing query... \ (43.7s)Executing query... | (43.8s)Executing query... / (43.9s)Executing query... - (44.0s)Executing query... \ (44.1s)Executing query... | (44.2s)Executing query... / (44.3s)Executing query... - (44.4s)Executing query... \ (44.5s)Executing query... | (44.6s)Executing query... / (44.7s)Executing query... - (44.8s)Executing query... \ (44.9s)Executing query... | (45.0s)Executing query... / (45.1s)Executing query... - (45.2s)Executing query... \ (45.3s)Executing query... | (45.4s)Executing query... / (45.5s)Executing query... - (45.6s)Executing query... \ (45.7s)Executing query... | (45.8s)Executing query... / (45.9s)Executing query... - (46.0s)Executing query... \ (46.1s)Executing query... | (46.2s)Executing query... / (46.3s)Executing query... - (46.4s)Executing query... \ (46.5s)Executing query... | (46.6s)Executing query... / (46.7s)Executing query... - (46.8s)Executing query... \ (46.9s)Executing query... | (47.0s)Executing query... / (47.1s)Executing query... - (47.2s)Executing query... \ (47.3s)Executing query... | (47.4s)Executing query... / (47.5s)Executing query... - (47.6s)Executing query... \ (47.7s)Executing query... | (47.8s)Executing query... / (47.9s)Executing query... - (48.0s)Executing query... \ (48.1s)Executing query... | (48.2s)Executing query... / (48.3s)Executing query... - (48.4s)Executing query... \ (48.5s)Executing query... | (48.6s)Executing query... / (48.7s)Executing query... - (48.8s)Executing query... \ (48.9s)Executing query... | (49.0s)Executing query... / (49.1s)Executing query... - (49.2s)Executing query... \ (49.3s)Executing query... | (49.4s)Executing query... / (49.5s)Executing query... - (49.6s)Executing query... \ (49.7s)Executing query... | (49.8s)Executing query... / (49.9s)Executing query... - (50.0s)Executing query... \ (50.1s)Executing query... | (50.2s)Executing query... / (50.3s)Executing query... - (50.4s)Executing query... \ (50.5s)Executing query... | (50.6s)Executing query... / (50.7s)Executing query... - (50.8s)Executing query... \ (51.0s)Executing query... | (51.1s)Executing query... / (51.2s)Executing query... - (53.5s)Executing query... \ (54.4s)Executing query... | (54.5s)Executing query... / (54.6s)Executing query... - (54.7s)Executing query... \ (54.9s)Executing query... | (55.0s)Executing query... / (55.1s)Executing query... - (55.2s)Executing query... \ (55.3s)Executing query... | (55.4s)Executing query... / (55.5s)Executing query... - (55.6s)Executing query... \ (55.7s)Executing query... | (55.8s)Executing query... / (55.9s)Executing query... - (56.0s)Executing query... \ (56.1s)Executing query... | (56.2s)Executing query... / (56.3s)Executing query... - (56.4s)Executing query... \ (56.5s)Executing query... | (56.6s)Executing query... / (56.7s)Executing query... - (56.8s)Executing query... \ (56.9s)Executing query... | (57.0s)Executing query... / (57.1s)Executing query... - (57.2s)Executing query... \ (57.3s)Executing query... | (57.4s)Executing query... / (57.5s)Executing query... - (57.6s)Executing query... \ (57.7s)Executing query... | (57.8s)Executing query... / (57.9s)Executing query... - (58.0s)Executing query... \ (58.1s)Executing query... | (58.2s)Executing query... / (58.3s)Executing query... - (58.4s)Executing query... \ (58.5s)Executing query... | (58.6s)Executing query... / (58.7s)Executing query... - (58.8s)Executing query... \ (58.9s)Executing query... | (59.0s)Executing query... / (59.1s)Executing query... - (59.2s)Executing query... \ (59.3s)Executing query... | (59.4s)Executing query... / (59.5s)Executing query... - (59.6s)Executing query... \ (59.7s)Executing query... | (59.8s)Executing query... / (59.9s)Executing query... - (60.0s)Executing query... \ (60.1s)Executing query... | (60.2s)Executing query... / (60.3s)Executing query... - (60.4s)Executing query... \ (60.5s)Executing query... | (60.6s)Executing query... / (60.7s)Executing query... - (60.8s)Executing query... \ (60.9s)Executing query... | (61.0s)Executing query... / (61.1s)Executing query... - (61.2s)Executing query... \ (61.3s)Executing query... | (61.4s)Executing query... / (61.5s)Executing query... - (61.6s)Executing query... \ (61.7s)Executing query... | (61.8s)Executing query... / (61.9s)Executing query... - (62.0s)Executing query... \ (62.1s)Executing query... | (62.2s)Executing query... / (62.3s)Executing query... - (62.4s)Executing query... \ (62.5s)Executing query... | (63.0s)Executing query... / (63.1s)Executing query... - (63.2s)Executing query... \ (63.3s)Executing query... | (63.4s)Executing query... / (63.5s)Executing query... - (63.6s)Executing query... \ (63.7s)Executing query... | (63.8s)Executing query... / (63.9s)Executing query... - (64.0s)Executing query... \ (64.1s)Executing query... | (64.2s)Executing query... / (64.3s)Executing query... - (64.4s)Executing query... \ (64.5s)Executing query... | (64.9s)Executing query... / (65.0s)Executing query... - (65.1s)Executing query... \ (65.2s)Executing query... | (65.3s)Executing query... / (65.4s)Executing query... - (65.5s)Executing query... \ (65.6s)Executing query... | (66.0s)Executing query... / (66.1s)Executing query... - (66.2s)Executing query... \ (66.3s)Executing query... | (66.4s)Executing query... / (66.5s)Executing query... - (66.6s)Executing query... \ (66.7s)Executing query... | (66.8s)Executing query... / (66.9s)Executing query... - (67.0s)Executing query... \ (67.1s)Executing query... | (67.2s)Executing query... / (67.3s)Executing query... - (67.4s)Executing query... \ (67.5s)Executing query... | (67.6s)Executing query... / (67.7s)Executing query... - (67.8s)Executing query... \ (67.9s)Executing query... | (68.0s)Executing query... / (68.1s)Executing query... - (68.2s)Executing query... \ (68.3s)Executing query... | (68.4s)Executing query... / (68.5s)Executing query... - (68.6s)Executing query... \ (68.7s)Executing query... | (68.8s)Executing query... / (68.9s)Executing query... - (69.0s)Executing query... \ (69.1s)Executing query... | (69.2s)Executing query... / (69.3s)Executing query... - (69.4s)Executing query... \ (69.5s)Executing query... | (69.6s)Executing query... / (69.7s)Executing query... - (69.8s)Executing query... \ (69.9s)Executing query... | (70.0s)Executing query... / (70.1s)Executing query... - (70.2s)Executing query... \ (70.3s)Executing query... | (70.4s)Executing query... / (70.5s)Executing query... - (70.6s)Executing query... \ (70.7s)Executing query... | (70.8s)Executing query... / (70.9s)Executing query... - (71.0s)Executing query... \ (71.1s)Executing query... | (71.2s)Executing query... / (71.3s)Executing query... - (71.4s)Executing query... \ (71.5s)Executing query... | (71.6s)Executing query... / (71.7s)Executing query... - (71.8s)Executing query... \ (71.9s)Executing query... | (72.0s)Executing query... / (72.1s)Executing query... - (72.2s)Executing query... \ (72.3s)Executing query... | (72.4s)Executing query... / (72.5s)Executing query... - (72.6s)Executing query... \ (72.7s)Executing query... | (72.9s)Executing query... / (73.0s)Executing query... - (73.1s)Executing query... \ (73.2s)Executing query... | (73.3s)Executing query... / (73.4s)Executing query... - (73.5s)Executing query... \ (73.6s)Executing query... | (73.7s)Executing query... / (73.8s)Executing query... - (73.9s)Executing query... \ (74.0s)Executing query... | (74.1s)Executing query... / (74.2s)Executing query... - (74.3s)Executing query... \ (74.4s)Executing query... | (74.5s)Executing query... / (74.6s)Executing query... - (74.7s)Executing query... \ (74.8s)Executing query... | (74.9s)Executing query... / (75.0s)Executing query... - (75.1s)Executing query... \ (75.2s)Executing query... | (75.3s)Executing query... / (75.4s)Executing query... - (75.5s)Executing query... \ (75.6s)Executing query... | (75.7s)Executing query... / (75.8s)Executing query... - (75.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (76.0s)Executing query... | (76.1s)Executing query... / (76.2s)Executing query... - (76.3s)Executing query... \ (76.4s)Executing query... | (76.5s)Executing query... / (76.6s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_think_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 77.40s â†’ output/testcase_results\sdm_think_nq_count_20260114_143701.csvâœ… All queries completed successfully 
14:38:21.887 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
14:38:21.933 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename addr* 
14:38:22.334 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename addr* 
14:38:53.216 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.6s)Executing query... | (0.9s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)                                             âœ… Running testcases for tables starting with 'addr'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_think_nq_except_distinct_20260114_143841_filtered_tables_result.csvFinished query: except_distinct in 11.05s â†’ output/testcase_results\sdm_think_nq_except_distinct_20260114_143841.csvâœ… All queries completed successfully 
14:38:53.513 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
14:38:53.535 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:38:53.551 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:39:16.314 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.4s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_think_nq_schema_compare_20260114_143909_schema_diff.csvFinished query: schema_compare in 5.50s â†’ output/testcase_results\sdm_think_nq_schema_compare_20260114_143909.csvâœ… All queries completed successfully 
14:39:16.585 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
14:54:13.630 [main] INFO  com.intuit.karate - Karate version: 1.5.1
14:54:15.667 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768362855653
14:54:23.054 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:54:23.071 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
14:54:51.998 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)Executing query... | (7.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)Executing query... | (7.5s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 8.21s â†’ output/testcase_results\sdm_rcti_nq_count_20260114_145443.csvâœ… All queries completed successfully 
14:54:53.832 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
14:54:53.868 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
14:54:53.893 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
14:56:26.317 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.9s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.4s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.2s)Executing query... - (2.4s)Executing query... \ (2.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (2.6s)Executing query... / (2.8s)Executing query... - (3.0s)                                             âœ… Running testcases for tables starting with ''Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)Executing query... | (7.5s)Executing query... / (7.6s)Executing query... - (7.7s)Executing query... \ (7.8s)Executing query... | (7.9s)Executing query... / (8.0s)Executing query... - (8.1s)Executing query... \ (8.2s)Executing query... | (8.3s)Executing query... / (8.4s)Executing query... - (8.5s)Executing query... \ (8.6s)Executing query... | (8.7s)Executing query... / (8.8s)Executing query... - (8.9s)Executing query... \ (9.0s)Executing query... | (9.1s)Executing query... / (9.2s)Executing query... - (9.3s)Executing query... \ (9.4s)Executing query... | (9.5s)Executing query... / (9.6s)Executing query... - (9.7s)Executing query... \ (9.8s)Executing query... | (10.0s)Executing query... / (10.1s)Executing query... - (10.2s)Executing query... \ (10.4s)Executing query... | (10.6s)Executing query... / (10.7s)Executing query... - (10.8s)Executing query... \ (10.9s)Executing query... | (11.0s)Executing query... / (11.6s)Executing query... - (11.7s)Executing query... \ (11.8s)Executing query... | (11.9s)Executing query... / (12.0s)Executing query... - (12.1s)Executing query... \ (12.2s)Executing query... | (12.3s)Executing query... / (12.4s)Executing query... - (12.5s)Executing query... \ (12.6s)Executing query... | (12.7s)Executing query... / (12.8s)Executing query... - (13.1s)Executing query... \ (13.2s)Executing query... | (13.3s)Executing query... / (13.4s)Executing query... - (13.5s)Executing query... \ (13.6s)Executing query... | (13.7s)Executing query... / (13.8s)Executing query... - (13.9s)Executing query... \ (14.0s)Executing query... | (14.1s)Executing query... / (14.2s)Executing query... - (14.3s)Executing query... \ (14.4s)Executing query... | (14.5s)Executing query... / (14.6s)Executing query... - (14.8s)Executing query... \ (14.9s)Executing query... | (15.0s)Executing query... / (15.1s)Executing query... - (15.2s)Executing query... \ (15.3s)Executing query... | (15.4s)Executing query... / (15.6s)Executing query... - (15.7s)Executing query... \ (15.8s)Executing query... | (15.9s)Executing query... / (16.0s)Executing query... - (16.1s)Executing query... \ (16.2s)Executing query... | (16.3s)Executing query... / (16.4s)Executing query... - (16.5s)Executing query... \ (16.6s)Executing query... | (16.9s)Executing query... / (17.0s)Executing query... - (17.4s)Executing query... \ (17.8s)Executing query... | (18.0s)Executing query... / (18.3s)Executing query... - (18.4s)Executing query... \ (18.5s)Executing query... | (18.6s)Executing query... / (18.7s)Executing query... - (18.8s)Executing query... \ (18.9s)Executing query... | (19.0s)Executing query... / (19.1s)Executing query... - (19.2s)Executing query... \ (19.3s)Executing query... | (19.4s)Executing query... / (19.5s)Executing query... - (19.6s)Executing query... \ (19.7s)Executing query... | (19.8s)Executing query... / (19.9s)Executing query... - (20.0s)Executing query... \ (20.1s)Executing query... | (20.2s)Executing query... / (20.3s)Executing query... - (20.4s)Executing query... \ (20.5s)Executing query... | (20.6s)Executing query... / (20.7s)Executing query... - (20.8s)Executing query... \ (20.9s)Executing query... | (21.0s)Executing query... / (21.1s)Executing query... - (21.2s)Executing query... \ (21.3s)Executing query... | (21.4s)Executing query... / (21.5s)Executing query... - (21.6s)Executing query... \ (21.7s)Executing query... | (22.0s)Executing query... / (22.2s)Executing query... - (22.3s)Executing query... \ (22.5s)Executing query... | (22.6s)Executing query... / (22.7s)Executing query... - (22.8s)Executing query... \ (22.9s)Executing query... | (23.0s)Executing query... / (23.1s)Executing query... - (23.2s)Executing query... \ (23.3s)Executing query... | (23.4s)Executing query... / (23.5s)Executing query... - (23.6s)Executing query... \ (23.7s)Executing query... | (23.8s)Executing query... / (23.9s)Executing query... - (24.0s)Executing query... \ (24.1s)Executing query... | (24.3s)Executing query... / (24.4s)Executing query... - (24.5s)Executing query... \ (24.6s)Executing query... | (24.7s)Executing query... / (24.8s)Executing query... - (24.9s)Executing query... \ (25.0s)Executing query... | (25.1s)Executing query... / (25.2s)Executing query... - (25.5s)Executing query... \ (25.7s)Executing query... | (25.8s)Executing query... / (25.9s)Executing query... - (26.0s)Executing query... \ (26.1s)Executing query... | (26.3s)Executing query... / (26.4s)Executing query... - (26.5s)Executing query... \ (26.6s)Executing query... | (26.7s)Executing query... / (26.8s)Executing query... - (26.9s)Executing query... \ (27.0s)Executing query... | (27.1s)Executing query... / (27.2s)Executing query... - (27.3s)Executing query... \ (27.4s)Executing query... | (27.5s)Executing query... / (27.6s)Executing query... - (27.7s)Executing query... \ (27.8s)Executing query... | (27.9s)Executing query... / (28.0s)Executing query... - (28.1s)Executing query... \ (28.2s)Executing query... | (28.3s)Executing query... / (28.4s)Executing query... - (28.5s)Executing query... \ (28.6s)Executing query... | (28.7s)Executing query... / (28.8s)Executing query... - (28.9s)Executing query... \ (29.0s)Executing query... | (29.1s)Executing query... / (29.2s)Executing query... - (29.3s)Executing query... \ (29.4s)Executing query... | (29.5s)Executing query... / (29.8s)Executing query... - (29.9s)Executing query... \ (30.0s)Executing query... | (30.1s)Executing query... / (30.2s)Executing query... - (30.4s)Executing query... \ (30.5s)Executing query... | (30.6s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_payonscan_bluebook_ext.sqlâ?Œ Testcase failed â†’ 96315 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)Executing query... / (4.6s)Executing query... - (4.7s)Executing query... \ (4.8s)Executing query... | (4.9s)Executing query... / (5.0s)Executing query... - (5.1s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (6.0s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_7eleven_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9772 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.6s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.4s)Executing query... | (4.6s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.4s)Executing query... \ (5.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.2s)Executing query... - (5.2s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.8s)Executing query... - (6.0s)Executing query... \ (6.7s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.7s)Executing query... / (1.0s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.8s)Executing query... \ (5.9s)Executing query... | (6.0s)Executing query... / (6.1s)Executing query... - (6.2s)Executing query... \ (6.3s)Executing query... | (6.4s)Executing query... / (6.5s)Executing query... - (6.6s)Executing query... \ (6.7s)Executing query... | (6.9s)Executing query... / (7.0s)Executing query... - (7.1s)Executing query... \ (7.2s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_woolies_bluebook_ext.sqlâ?Œ Testcase failed â†’ 15010 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_145511_filtered_tables_result.csvFinished query: except_distinct in 74.69s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260114_145511.csvâœ… All queries completed successfully 
14:56:26.946 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
14:56:27.189 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:56:27.248 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
14:56:50.931 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.4s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (0.9s)Executing query... / (1.1s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_145646_schema_diff.csvFinished query: schema_compare in 4.20s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260114_145646.csvâœ… All queries completed successfully 
14:56:51.807 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
15:39:42.635 [main] INFO  com.intuit.karate - Karate version: 1.5.1
15:39:44.486 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768365584475
15:39:50.335 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
15:39:50.459 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
15:40:31.485 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.4s)Executing query... \ (0.8s)Executing query... | (1.2s)Executing query... / (1.6s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.8s)Executing query... \ (5.9s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 6.37s â†’ output/testcase_results\sdm_rcti_nq_count_20260114_154024.csvâœ… All queries completed successfully 
15:40:34.084 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
15:40:34.111 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
15:40:34.247 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename * 
15:42:05.888 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.7s)Executing query... / (1.0s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.5s)Executing query... / (1.8s)Executing query... - (2.0s)Executing query... \ (2.2s)Executing query... | (2.4s)Executing query... / (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)                                             âœ… Running testcases for tables starting with ''Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)Executing query... | (7.5s)Executing query... / (7.6s)Executing query... - (7.7s)Executing query... \ (7.8s)Executing query... | (7.9s)Executing query... / (8.0s)Executing query... - (8.1s)Executing query... \ (8.2s)Executing query... | (8.3s)Executing query... / (8.4s)Executing query... - (8.5s)Executing query... \ (8.6s)Executing query... | (8.7s)Executing query... / (8.8s)Executing query... - (8.9s)Executing query... \ (9.0s)Executing query... | (9.1s)Executing query... / (9.2s)Executing query... - (9.3s)Executing query... \ (9.4s)Executing query... | (9.5s)Executing query... / (9.6s)Executing query... - (9.7s)Executing query... \ (9.8s)Executing query... | (9.9s)Executing query... / (10.0s)Executing query... - (10.1s)Executing query... \ (10.3s)Executing query... | (10.4s)Executing query... / (10.6s)Executing query... - (11.9s)Executing query... \ (12.0s)Executing query... | (12.1s)Executing query... / (12.4s)Executing query... - (12.5s)Executing query... \ (12.6s)Executing query... | (12.8s)Executing query... / (12.9s)Executing query... - (13.0s)Executing query... \ (13.1s)Executing query... | (13.2s)Executing query... / (13.3s)Executing query... - (13.4s)Executing query... \ (13.5s)Executing query... | (13.6s)Executing query... / (13.7s)Executing query... - (13.8s)Executing query... \ (13.9s)Executing query... | (14.0s)Executing query... / (14.1s)Executing query... - (14.2s)Executing query... \ (14.3s)Executing query... | (14.4s)Executing query... / (14.5s)Executing query... - (14.6s)Executing query... \ (14.7s)Executing query... | (14.8s)Executing query... / (14.9s)Executing query... - (15.0s)Executing query... \ (15.1s)Executing query... | (15.2s)Executing query... / (15.3s)Executing query... - (15.4s)Executing query... \ (15.5s)Executing query... | (15.7s)Executing query... / (15.8s)Executing query... - (15.9s)Executing query... \ (16.1s)Executing query... | (16.2s)Executing query... / (16.3s)Executing query... - (16.4s)Executing query... \ (16.5s)Executing query... | (16.6s)Executing query... / (16.7s)Executing query... - (16.8s)Executing query... \ (16.9s)Executing query... | (17.0s)Executing query... / (17.6s)Executing query... - (18.6s)Executing query... \ (18.7s)Executing query... | (18.8s)Executing query... / (18.9s)Executing query... - (19.0s)Executing query... \ (19.1s)Executing query... | (19.2s)Executing query... / (19.3s)Executing query... - (19.4s)Executing query... \ (19.5s)Executing query... | (19.6s)Executing query... / (19.7s)Executing query... - (19.8s)Executing query... \ (19.9s)Executing query... | (20.0s)Executing query... / (20.1s)Executing query... - (20.2s)Executing query... \ (20.3s)Executing query... | (20.4s)Executing query... / (20.5s)Executing query... - (20.6s)Executing query... \ (20.7s)Executing query... | (20.8s)Executing query... / (20.9s)Executing query... - (21.0s)Executing query... \ (21.1s)Executing query... | (21.5s)Executing query... / (21.6s)Executing query... - (21.8s)Executing query... \ (21.9s)Executing query... | (22.0s)Executing query... / (22.2s)Executing query... - (22.5s)Executing query... \ (22.6s)Executing query... | (22.7s)Executing query... / (22.8s)Executing query... - (22.9s)Executing query... \ (23.0s)Executing query... | (23.1s)Executing query... / (23.2s)Executing query... - (23.3s)Executing query... \ (23.4s)Executing query... | (23.5s)Executing query... / (23.6s)Executing query... - (23.7s)Executing query... \ (23.8s)Executing query... | (23.9s)Executing query... / (24.0s)Executing query... - (24.1s)Executing query... \ (24.2s)Executing query... | (24.3s)Executing query... / (24.4s)Executing query... - (24.5s)Executing query... \ (24.6s)Executing query... | (24.9s)Executing query... / (25.1s)Executing query... - (25.2s)Executing query... \ (25.4s)Executing query... | (25.5s)Executing query... / (25.6s)Executing query... - (25.7s)Executing query... \ (25.8s)Executing query... | (25.9s)Executing query... / (26.0s)Executing query... - (26.1s)Executing query... \ (26.2s)Executing query... | (26.3s)Executing query... / (26.4s)Executing query... - (26.5s)Executing query... \ (26.6s)Executing query... | (26.7s)Executing query... / (26.8s)Executing query... - (26.9s)Executing query... \ (27.0s)Executing query... | (27.1s)Executing query... / (27.2s)Executing query... - (27.3s)Executing query... \ (27.4s)Executing query... | (27.5s)Executing query... / (27.6s)Executing query... - (27.7s)Executing query... \ (27.8s)Executing query... | (27.9s)Executing query... / (28.0s)Executing query... - (28.1s)Executing query... \ (28.2s)Executing query... | (28.3s)Executing query... / (28.7s)Executing query... - (29.6s)Executing query... \ (29.7s)Executing query... | (29.9s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_payonscan_bluebook_ext.sqlâ?Œ Testcase failed â†’ 96315 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ payonscan_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "payonscan_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `vendor`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.payonscan_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.6s)Executing query... | (5.7s)Executing query... / (5.8s)Executing query... - (5.9s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_7eleven_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9772 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_7eleven_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_7eleven_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_7eleven_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.4s)Executing query... - (3.5s)Executing query... \ (3.6s)Executing query... | (3.7s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (3.0s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (5.0s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.8s)Executing query... \ (5.9s)Executing query... | (6.0s)Executing query... / (6.1s)Executing query... - (6.2s)Executing query... \ (6.3s)Executing query... | (6.4s)Executing query... / (6.5s)Executing query... - (6.6s)Executing query... \ (6.7s)Executing query... | (7.0s)Executing query... / (7.1s)Executing query... - (7.2s)Executing query... \ (7.3s)Executing query... | (7.4s)Executing query... / (7.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_woolies_bluebook_ext.sqlâ?Œ Testcase failed â†’ 15010 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_woolies_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_woolies_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_woolies_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154055_filtered_tables_result.csvFinished query: except_distinct in 70.42s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154055.csvâœ… All queries completed successfully 
15:42:06.121 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
15:42:06.134 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
15:42:06.189 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
15:42:36.089 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_154231_schema_diff.csvFinished query: schema_compare in 4.35s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260114_154231.csvâœ… All queries completed successfully 
15:42:36.590 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
15:46:33.402 [main] INFO  com.intuit.karate - Karate version: 1.5.1
15:46:34.805 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768365994793
15:46:39.897 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
15:46:39.925 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
15:47:09.121 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)Executing query... - (4.0s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.5s)Executing query... | (4.6s)Executing query... / (4.7s)Executing query... - (4.8s)Executing query... \ (4.9s)Executing query... | (5.0s)Executing query... / (5.1s)Executing query... - (5.2s)Executing query... \ (5.3s)Executing query... | (5.4s)Executing query... / (5.5s)Executing query... - (5.6s)Executing query... \ (5.7s)Executing query... | (5.8s)Executing query... / (5.9s)Executing query... - (6.0s)Executing query... \ (6.1s)Executing query... | (6.2s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.7s)Executing query... | (6.8s)Executing query... / (6.9s)Executing query... - (7.0s)Executing query... \ (7.1s)Executing query... | (7.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (7.3s)Executing query... - (7.4s)Executing query... \ (7.5s)Executing query... | (7.6s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 7.98s â†’ output/testcase_results\sdm_rcti_nq_count_20260114_154700.csvâœ… All queries completed successfully 
15:47:12.105 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
15:47:12.146 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
15:47:12.209 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename rcti_c* 
15:47:55.347 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.4s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)Executing query... - (4.0s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.4s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154731_filtered_tables_result.csvFinished query: except_distinct in 23.62s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260114_154731.csvâœ… All queries completed successfully 
15:47:55.700 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
15:47:55.714 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
15:47:55.735 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
15:48:21.073 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.8s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260114_154815_schema_diff.csvFinished query: schema_compare in 5.20s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260114_154815.csvâœ… All queries completed successfully 
15:48:21.428 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
15:54:41.700 [main] INFO  com.intuit.karate - Karate version: 1.5.1
15:54:42.935 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1768366482910
15:54:50.395 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
15:54:50.465 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
15:56:41.729 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.9s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)Executing query... - (5.0s)Executing query... \ (5.1s)Executing query... | (5.2s)Executing query... / (5.3s)Executing query... - (5.4s)Executing query... \ (5.5s)Executing query... | (5.6s)Executing query... / (5.7s)Executing query... - (5.8s)Executing query... \ (5.9s)Executing query... | (6.0s)Executing query... / (6.1s)Executing query... - (6.2s)Executing query... \ (6.3s)Executing query... | (6.4s)Executing query... / (6.5s)Executing query... - (6.6s)Executing query... \ (6.7s)Executing query... | (6.8s)Executing query... / (6.9s)Executing query... - (7.0s)Executing query... \ (7.1s)Executing query... | (7.2s)Executing query... / (7.3s)Executing query... - (7.4s)Executing query... \ (7.5s)Executing query... | (7.6s)Executing query... / (7.7s)Executing query... - (7.8s)Executing query... \ (7.9s)Executing query... | (8.0s)Executing query... / (8.1s)Executing query... - (8.2s)Executing query... \ (8.3s)Executing query... | (8.4s)Executing query... / (8.5s)Executing query... - (8.6s)Executing query... \ (8.7s)Executing query... | (8.8s)Executing query... / (8.9s)Executing query... - (9.0s)Executing query... \ (9.1s)Executing query... | (9.2s)Executing query... / (9.3s)Executing query... - (9.4s)Executing query... \ (9.5s)Executing query... | (9.6s)Executing query... / (9.7s)Executing query... - (9.8s)Executing query... \ (9.9s)Executing query... | (10.0s)Executing query... / (10.1s)Executing query... - (10.2s)Executing query... \ (10.3s)Executing query... | (10.4s)Executing query... / (10.5s)Executing query... - (10.6s)Executing query... \ (10.7s)Executing query... | (10.8s)Executing query... / (10.9s)Executing query... - (11.0s)Executing query... \ (11.1s)Executing query... | (11.2s)Executing query... / (11.3s)Executing query... - (11.4s)Executing query... \ (11.5s)Executing query... | (11.6s)Executing query... / (11.7s)Executing query... - (11.8s)Executing query... \ (11.9s)Executing query... | (12.0s)Executing query... / (12.1s)Executing query... - (12.2s)Executing query... \ (12.3s)Executing query... | (12.4s)Executing query... / (12.5s)Executing query... - (12.6s)Executing query... \ (12.7s)Executing query... | (12.8s)Executing query... / (12.9s)Executing query... - (13.0s)Executing query... \ (13.1s)Executing query... | (13.2s)Executing query... / (13.4s)Executing query... - (13.5s)Executing query... \ (13.6s)Executing query... | (13.7s)Executing query... / (13.8s)Executing query... - (13.9s)Executing query... \ (14.0s)Executing query... | (14.1s)Executing query... / (14.2s)Executing query... - (14.3s)Executing query... \ (14.4s)Executing query... | (14.5s)Executing query... / (14.6s)Executing query... - (14.7s)Executing query... \ (14.8s)Executing query... | (14.9s)Executing query... / (15.0s)Executing query... - (15.1s)Executing query... \ (15.2s)Executing query... | (15.3s)Executing query... / (15.4s)Executing query... - (15.5s)Executing query... \ (15.6s)Executing query... | (15.7s)Executing query... / (15.8s)Executing query... - (15.9s)Executing query... \ (16.0s)Executing query... | (16.1s)Executing query... / (16.2s)Executing query... - (16.3s)Executing query... \ (16.4s)Executing query... | (16.6s)Executing query... / (16.7s)Executing query... - (16.8s)Executing query... \ (16.9s)Executing query... | (17.0s)Executing query... / (17.1s)Executing query... - (17.2s)Executing query... \ (17.3s)Executing query... | (17.4s)Executing query... / (17.5s)Executing query... - (17.6s)Executing query... \ (17.7s)Executing query... | (17.8s)Executing query... / (17.9s)Executing query... - (18.0s)Executing query... \ (18.1s)Executing query... | (18.2s)Executing query... / (18.3s)Executing query... - (18.4s)Executing query... \ (18.5s)Executing query... | (18.6s)Executing query... / (18.7s)Executing query... - (18.8s)Executing query... \ (18.9s)Executing query... | (19.0s)Executing query... / (19.1s)Executing query... - (19.2s)Executing query... \ (19.3s)Executing query... | (19.4s)Executing query... / (19.5s)Executing query... - (19.6s)Executing query... \ (20.2s)Executing query... | (20.3s)Executing query... / (20.4s)Executing query... - (20.5s)Executing query... \ (20.6s)Executing query... | (20.7s)Executing query... / (20.8s)Executing query... - (20.9s)Executing query... \ (21.0s)Executing query... | (21.1s)Executing query... / (21.2s)Executing query... - (21.3s)Executing query... \ (21.4s)Executing query... | (21.5s)Executing query... / (21.6s)Executing query... - (21.7s)Executing query... \ (21.8s)Executing query... | (21.9s)Executing query... / (22.0s)Executing query... - (22.1s)Executing query... \ (22.2s)Executing query... | (22.3s)Executing query... / (22.4s)Executing query... - (22.5s)Executing query... \ (22.6s)Executing query... | (22.7s)Executing query... / (22.8s)Executing query... - (22.9s)Executing query... \ (23.0s)Executing query... | (23.1s)Executing query... / (23.2s)Executing query... - (23.3s)Executing query... \ (23.4s)Executing query... | (23.5s)Executing query... / (23.6s)Executing query... - (23.7s)Executing query... \ (23.8s)Executing query... | (23.9s)Executing query... / (24.0s)Executing query... - (24.1s)Executing query... \ (24.2s)Executing query... | (24.3s)Executing query... / (24.4s)Executing query... - (24.5s)Executing query... \ (24.6s)Executing query... | (24.7s)Executing query... / (24.8s)Executing query... - (24.9s)Executing query... \ (25.0s)Executing query... | (25.1s)Executing query... / (25.2s)Executing query... - (25.3s)Executing query... \ (25.4s)Executing query... | (25.5s)Executing query... / (25.6s)Executing query... - (25.7s)Executing query... \ (25.8s)Executing query... | (25.9s)Executing query... / (26.0s)Executing query... - (26.1s)Executing query... \ (26.2s)Executing query... | (26.3s)Executing query... / (26.4s)Executing query... - (26.5s)Executing query... \ (26.6s)Executing query... | (26.7s)Executing query... / (26.8s)Executing query... - (26.9s)Executing query... \ (27.0s)Executing query... | (27.1s)Executing query... / (27.2s)Executing query... - (27.3s)Executing query... \ (27.4s)Executing query... | (27.5s)Executing query... / (27.6s)Executing query... - (27.7s)Executing query... \ (27.8s)Executing query... | (27.9s)Executing query... / (28.0s)Executing query... - (28.1s)Executing query... \ (28.2s)Executing query... | (28.3s)Executing query... / (28.4s)Executing query... - (28.5s)Executing query... \ (28.6s)Executing query... | (28.7s)Executing query... / (28.8s)Executing query... - (28.9s)Executing query... \ (29.0s)Executing query... | (29.1s)Executing query... / (29.2s)Executing query... - (29.3s)Executing query... \ (29.4s)Executing query... | (29.5s)Executing query... / (29.6s)Executing query... - (29.7s)Executing query... \ (29.8s)Executing query... | (29.9s)Executing query... / (30.0s)Executing query... - (30.1s)Executing query... \ (30.2s)Executing query... | (30.3s)Executing query... / (30.4s)Executing query... - (30.5s)Executing query... \ (30.6s)Executing query... | (30.7s)Executing query... / (30.8s)Executing query... - (30.9s)Executing query... \ (31.0s)Executing query... | (31.2s)Executing query... / (31.3s)Executing query... - (31.4s)Executing query... \ (31.5s)Executing query... | (31.6s)Executing query... / (31.7s)Executing query... - (32.0s)Executing query... \ (32.1s)Executing query... | (32.2s)Executing query... / (32.3s)Executing query... - (32.4s)Executing query... \ (32.5s)Executing query... | (32.6s)Executing query... / (32.7s)Executing query... - (32.8s)Executing query... \ (32.9s)Executing query... | (33.0s)Executing query... / (33.1s)Executing query... - (33.2s)Executing query... \ (33.3s)Executing query... | (33.4s)Executing query... / (33.5s)Executing query... - (33.6s)Executing query... \ (33.7s)Executing query... | (33.8s)Executing query... / (33.9s)Executing query... - (34.0s)Executing query... \ (34.1s)Executing query... | (34.2s)Executing query... / (34.3s)Executing query... - (34.4s)Executing query... \ (34.5s)Executing query... | (34.6s)Executing query... / (34.7s)Executing query... - (34.8s)Executing query... \ (34.9s)Executing query... | (35.0s)Executing query... / (35.2s)Executing query... - (35.3s)Executing query... \ (35.4s)Executing query... | (35.5s)Executing query... / (35.6s)Executing query... - (35.7s)Executing query... \ (35.8s)Executing query... | (35.9s)Executing query... / (36.0s)Executing query... - (36.1s)Executing query... \ (36.2s)Executing query... | (36.3s)Executing query... / (36.4s)Executing query... - (36.5s)Executing query... \ (36.6s)Executing query... | (36.7s)Executing query... / (36.8s)Executing query... - (36.9s)Executing query... \ (37.0s)Executing query... | (37.1s)Executing query... / (37.2s)Executing query... - (37.3s)Executing query... \ (37.4s)Executing query... | (37.5s)Executing query... / (37.6s)Executing query... - (37.7s)Executing query... \ (37.8s)Executing query... | (37.9s)Executing query... / (38.0s)Executing query... - (38.1s)Executing query... \ (38.2s)Executing query... | (38.3s)Executing query... / (38.4s)Executing query... - (38.5s)Executing query... \ (38.6s)Executing query... | (38.7s)Executing query... / (38.8s)Executing query... - (38.9s)Executing query... \ (39.0s)Executing query... | (39.1s)Executing query... / (39.2s)Executing query... - (39.3s)Executing query... \ (39.4s)Executing query... | (39.5s)Executing query... / (39.6s)Executing query... - (39.7s)Executing query... \ (39.8s)Executing query... | (39.9s)Executing query... / (40.0s)Executing query... - (40.1s)Executing query... \ (40.2s)Executing query... | (40.3s)Executing query... / (40.4s)Executing query... - (40.5s)Executing query... \ (40.6s)Executing query... | (40.7s)Executing query... / (40.8s)Executing query... - (40.9s)Executing query... \ (41.0s)Executing query... | (41.1s)Executing query... / (41.2s)Executing query... - (41.3s)Executing query... \ (41.4s)Executing query... | (41.5s)Executing query... / (41.6s)Executing query... - (41.7s)Executing query... \ (41.8s)Executing query... | (41.9s)Executing query... / (42.0s)Executing query... - (42.1s)Executing query... \ (42.2s)Executing query... | (42.3s)Executing query... / (42.4s)Executing query... - (42.5s)Executing query... \ (42.6s)Executing query... | (42.7s)Executing query... / (42.8s)Executing query... - (42.9s)Executing query... \ (43.0s)Executing query... | (43.1s)Executing query... / (43.2s)Executing query... - (43.3s)Executing query... \ (43.4s)Executing query... | (43.5s)Executing query... / (43.6s)Executing query... - (43.7s)Executing query... \ (43.8s)Executing query... | (43.9s)Executing query... / (44.0s)Executing query... - (44.1s)Executing query... \ (44.2s)Executing query... | (44.3s)Executing query... / (44.4s)Executing query... - (44.5s)Executing query... \ (44.6s)Executing query... | (44.7s)Executing query... / (44.8s)Executing query... - (44.9s)Executing query... \ (45.0s)Executing query... | (45.1s)Executing query... / (45.2s)Executing query... - (45.3s)Executing query... \ (45.4s)Executing query... | (45.5s)Executing query... / (45.6s)Executing query... - (45.7s)Executing query... \ (45.8s)Executing query... | (45.9s)Executing query... / (46.0s)Executing query... - (46.1s)Executing query... \ (46.2s)Executing query... | (46.3s)Executing query... / (46.4s)Executing query... - (46.5s)Executing query... \ (46.6s)Executing query... | (46.7s)Executing query... / (46.8s)Executing query... - (46.9s)Executing query... \ (47.0s)Executing query... | (47.1s)Executing query... / (47.2s)Executing query... - (47.3s)Executing query... \ (47.4s)Executing query... | (47.5s)Executing query... / (47.6s)Executing query... - (47.7s)Executing query... \ (47.8s)Executing query... | (47.9s)Executing query... / (48.0s)Executing query... - (48.1s)Executing query... \ (48.2s)Executing query... | (48.3s)Executing query... / (48.4s)Executing query... - (48.5s)Executing query... \ (48.6s)Executing query... | (48.7s)Executing query... / (48.8s)Executing query... - (48.9s)Executing query... \ (49.0s)Executing query... | (49.1s)Executing query... / (49.2s)Executing query... - (49.3s)Executing query... \ (49.4s)Executing query... | (49.5s)Executing query... / (49.6s)Executing query... - (49.7s)Executing query... \ (49.8s)Executing query... | (49.9s)Executing query... / (50.4s)Executing query... - (50.5s)Executing query... \ (50.6s)Executing query... | (50.7s)Executing query... / (50.8s)Executing query... - (50.9s)Executing query... \ (51.0s)Executing query... | (51.1s)Executing query... / (51.2s)Executing query... - (51.3s)Executing query... \ (51.4s)Executing query... | (51.5s)Executing query... / (51.6s)Executing query... - (51.7s)Executing query... \ (51.8s)Executing query... | (51.9s)Executing query... / (52.0s)Executing query... - (52.1s)Executing query... \ (52.2s)Executing query... | (52.3s)Executing query... / (52.4s)Executing query... - (52.5s)Executing query... \ (52.6s)Executing query... | (52.7s)Executing query... / (52.8s)Executing query... - (52.9s)Executing query... \ (53.0s)Executing query... | (53.1s)Executing query... / (53.2s)Executing query... - (53.3s)Executing query... \ (53.4s)Executing query... | (53.5s)Executing query... / (53.6s)Executing query... - (53.7s)Executing query... \ (53.8s)Executing query... | (53.9s)Executing query... / (54.0s)Executing query... - (54.1s)Executing query... \ (54.2s)Executing query... | (54.3s)Executing query... / (54.4s)Executing query... - (54.5s)Executing query... \ (54.6s)Executing query... | (54.7s)Executing query... / (54.8s)Executing query... - (54.9s)Executing query... \ (55.0s)Executing query... | (55.4s)Executing query... / (55.5s)Executing query... - (55.8s)Executing query... \ (55.9s)Executing query... | (56.0s)Executing query... / (56.1s)Executing query... - (56.2s)Executing query... \ (56.3s)Executing query... | (56.4s)Executing query... / (56.5s)Executing query... - (56.6s)Executing query... \ (56.7s)Executing query... | (56.8s)Executing query... / (56.9s)Executing query... - (57.0s)Executing query... \ (57.1s)Executing query... | (57.2s)Executing query... / (57.3s)Executing query... - (57.4s)Executing query... \ (57.5s)Executing query... | (57.6s)Executing query... / (57.7s)Executing query... - (57.8s)Executing query... \ (57.9s)Executing query... | (58.0s)Executing query... / (58.1s)Executing query... - (58.2s)Executing query... \ (58.3s)Executing query... | (58.4s)Executing query... / (58.5s)Executing query... - (58.6s)Executing query... \ (58.7s)Executing query... | (58.8s)Executing query... / (58.9s)Executing query... - (59.0s)Executing query... \ (59.1s)Executing query... | (59.2s)Executing query... / (59.3s)Executing query... - (59.4s)Executing query... \ (59.5s)Executing query... | (59.6s)Executing query... / (59.7s)Executing query... - (59.8s)Executing query... \ (59.9s)Executing query... | (60.0s)Executing query... / (60.1s)Executing query... - (60.2s)Executing query... \ (60.3s)Executing query... | (60.4s)Executing query... / (60.5s)Executing query... - (60.6s)Executing query... \ (60.7s)Executing query... | (60.8s)Executing query... / (60.9s)Executing query... - (61.0s)Executing query... \ (61.1s)Executing query... | (61.2s)Executing query... / (61.3s)Executing query... - (61.4s)Executing query... \ (61.5s)Executing query... | (61.6s)Executing query... / (61.7s)Executing query... - (61.8s)Executing query... \ (61.9s)Executing query... | (62.0s)Executing query... / (62.1s)Executing query... - (62.2s)Executing query... \ (62.3s)Executing query... | (62.4s)Executing query... / (62.5s)Executing query... - (62.6s)Executing query... \ (62.7s)Executing query... | (62.8s)Executing query... / (62.9s)Executing query... - (63.0s)Executing query... \ (63.1s)Executing query... | (63.2s)Executing query... / (63.3s)Executing query... - (63.4s)Executing query... \ (63.5s)Executing query... | (63.6s)Executing query... / (63.7s)Executing query... - (63.8s)Executing query... \ (63.9s)Executing query... | (64.0s)Executing query... / (64.1s)Executing query... - (64.2s)Executing query... \ (64.3s)Executing query... | (64.4s)Executing query... / (64.5s)Executing query... - (64.6s)Executing query... \ (64.7s)Executing query... | (64.8s)Executing query... / (64.9s)Executing query... - (65.0s)Executing query... \ (65.1s)Executing query... | (65.2s)Executing query... / (65.3s)Executing query... - (65.4s)Executing query... \ (65.5s)Executing query... | (65.6s)Executing query... / (65.7s)Executing query... - (65.8s)Executing query... \ (65.9s)Executing query... | (66.0s)Executing query... / (66.1s)Executing query... - (66.2s)Executing query... \ (66.3s)Executing query... | (66.4s)Executing query... / (66.5s)Executing query... - (66.6s)Executing query... \ (66.7s)Executing query... | (66.9s)Executing query... / (67.0s)Executing query... - (67.1s)Executing query... \ (67.2s)Executing query... | (67.3s)Executing query... / (67.4s)Executing query... - (67.5s)Executing query... \ (67.6s)Executing query... | (67.7s)Executing query... / (67.8s)Executing query... - (67.9s)Executing query... \ (68.0s)Executing query... | (68.1s)Executing query... / (68.2s)Executing query... - (68.3s)Executing query... \ (68.4s)Executing query... | (68.5s)Executing query... / (68.6s)Executing query... - (68.7s)Executing query... \ (68.8s)Executing query... | (69.1s)Executing query... / (69.2s)Executing query... - (69.3s)Executing query... \ (69.5s)Executing query... | (69.6s)Executing query... / (69.7s)Executing query... - (69.8s)Executing query... \ (69.9s)Executing query... | (70.0s)Executing query... / (70.1s)Executing query... - (70.2s)Executing query... \ (70.3s)Executing query... | (70.4s)Executing query... / (70.5s)Executing query... - (70.6s)Executing query... \ (70.7s)Executing query... | (70.8s)Executing query... / (70.9s)Executing query... - (71.0s)Executing query... \ (71.1s)Executing query... | (71.2s)Executing query... / (71.3s)Executing query... - (71.4s)Executing query... \ (71.5s)Executing query... | (71.6s)Executing query... / (71.7s)Executing query... - (71.8s)Executing query... \ (71.9s)Executing query... | (72.0s)Executing query... / (72.1s)Executing query... - (72.2s)Executing query... \ (72.3s)Executing query... | (72.4s)Executing query... / (72.5s)Executing query... - (72.6s)Executing query... \ (72.7s)Executing query... | (72.8s)Executing query... / (72.9s)Executing query... - (73.0s)Executing query... \ (73.1s)Executing query... | (73.2s)Executing query... / (73.3s)Executing query... - (73.4s)Executing query... \ (73.5s)Executing query... | (73.6s)Executing query... / (73.7s)Executing query... - (73.8s)Executing query... \ (73.9s)Executing query... | (74.0s)Executing query... / (74.1s)Executing query... - (74.2s)Executing query... \ (74.3s)Executing query... | (74.4s)Executing query... / (74.5s)Executing query... - (74.6s)Executing query... \ (74.7s)Executing query... | (74.8s)Executing query... / (74.9s)Executing query... - (75.0s)Executing query... \ (75.1s)Executing query... | (75.2s)Executing query... / (75.3s)Executing query... - (75.4s)Executing query... \ (75.5s)Executing query... | (75.6s)Executing query... / (75.7s)Executing query... - (75.8s)Executing query... \ (75.9s)Executing query... | (76.0s)Executing query... / (76.1s)Executing query... - (76.2s)Executing query... \ (76.3s)Executing query... | (76.4s)Executing query... / (76.5s)Executing query... - (76.6s)Executing query... \ (76.7s)Executing query... | (76.8s)Executing query... / (76.9s)Executing query... - (77.0s)Executing query... \ (77.1s)Executing query... | (77.2s)Executing query... / (77.3s)Executing query... - (77.4s)Executing query... \ (77.5s)Executing query... | (77.6s)Executing query... / (77.7s)Executing query... - (77.8s)Executing query... \ (77.9s)Executing query... | (78.0s)Executing query... / (78.1s)Executing query... - (78.2s)Executing query... \ (78.3s)Executing query... | (78.4s)Executing query... / (78.5s)Executing query... - (78.7s)Executing query... \ (78.8s)Executing query... | (78.9s)Executing query... / (79.0s)Executing query... - (79.1s)Executing query... \ (79.2s)Executing query... | (79.3s)Executing query... / (79.4s)Executing query... - (79.5s)Executing query... \ (79.6s)Executing query... | (79.7s)Executing query... / (79.8s)Executing query... - (79.9s)Executing query... \ (80.0s)Executing query... | (80.1s)Executing query... / (80.2s)Executing query... - (80.3s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (80.4s)Executing query... | (80.5s)Executing query... / (80.6s)Executing query... - (80.7s)Executing query... \ (80.8s)Executing query... | (80.9s)Executing query... / (81.0s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_think_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 81.46s â†’ output/testcase_results\sdm_think_nq_count_20260114_155519.csvâœ… All queries completed successfully 
15:56:44.530 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 2 of 4 (2 remaining) features/test_count.feature
15:56:44.660 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename addr* 
15:56:44.851 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename addr* 
15:57:18.463 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order',                            'customer',                            'customer_address')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_think_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)                                             âœ… Running testcases for tables starting with 'addr'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_status â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "address_status" AS TABLE_NAME,       `address_status`,       `description`,       `address_undeliverable`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_status`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (1.2s)Executing query... \ (1.4s)Executing query... | (1.7s)Executing query... / (1.9s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ address_type â–¶â–¶â–¶â–¶ Generated SQL:SELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-prd.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "address_type" AS TABLE_NAME,       `address_type`,       `description`,       `row_version`FROM `ncau-data-newsquery-sit.sdm_think_nq.address_type`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_think_nq_except_distinct_20260114_155706_filtered_tables_result.csvFinished query: except_distinct in 11.40s â†’ output/testcase_results\sdm_think_nq_except_distinct_20260114_155706.csvâœ… All queries completed successfully 
15:57:19.218 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 3 of 4 (1 remaining) features/test_except_distinct.feature
15:57:19.594 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
15:57:19.650 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
15:57:48.252 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_think_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.6s)Executing query... \ (0.8s)Executing query... | (1.0s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_think_nq_schema_compare_20260114_155742_schema_diff.csvFinished query: schema_compare in 5.27s â†’ output/testcase_results\sdm_think_nq_schema_compare_20260114_155742.csvâœ… All queries completed successfully 
15:57:49.075 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 4 of 4 (0 remaining) features/test_schema_compare.feature
09:56:56.094 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:56:57.485 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769142417473
09:58:22.526 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:58:23.051 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769142503041
09:58:47.703 [main] INFO  com.intuit.karate - Karate version: 1.5.1
09:58:48.474 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769142528466
09:58:52.708 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:58:52.938 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
09:59:27.841 [1769142532964] WARN  com.intuit.karate.shell.Command - exit code was non-zero: 1 - [python, src/main/python/run_query.py, --query, count] working dir: null
09:59:27.848 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_gbaba_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_gbaba_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_gbaba_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.5s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)                                             Error running query count: 404 Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location US; reason: notFound, message: Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location USLocation: USJob ID: 156c4759-3d0a-4f1c-8b73-124c6c9ad2d4Fatal error: 404 Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location US; reason: notFound, message: Not found: Dataset ncau-data-newsquery-prd:sdm_gbaba_nq was not found in location USLocation: USJob ID: 156c4759-3d0a-4f1c-8b73-124c6c9ad2d4 
09:59:29.835 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_count.feature
19:13:19.977 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:13:21.456 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769694201448
19:13:27.991 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
19:13:28.113 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
19:14:19.931 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinct_fullloadâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME NOT IN ('customer',                            'customer_address',                            'customer_address_ext',                            'customer_ext',                            'demographic',                            'news_customer_contract',                            'news_demographic_ex',                            'news_ext_customer_redemption',                            'news_financial_transaction',                            'news_interactions',                            'news_payment_account_ext',                            'order_item',                            'order_item_ext',                            'order_item_note',                            'paybreak',                            'payment',                            'payment_account',                            'payment_reversed_payment',                            'service',                            'service_ext',                            'gbaba_act_xref',                            'ad_custom_fields_export',                            'customers_export',                            'display_ads_export',                            'insert_ads_export',                            'online_ad_export2',                            'order_custom_fields_export',                            'order_export2',                            'order_item_audience_segment',                            'order_item_metadata',                            'order_item_price_item',                            'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.4s)Executing query... - (3.5s)                                             Finished query: except_distinct_fullload in 4.01s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_191415.csvâœ… All queries completed successfully 
19:14:23.250 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct_deltaload.feature
19:58:43.279 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:58:44.219 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769696924212
19:58:50.810 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
19:58:50.995 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
19:59:43.111 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.2s)Executing query... \ (1.4s)Executing query... | (1.6s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.5s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (2.0s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (3.9s)Executing query... | (4.0s)Executing query... / (4.1s)Executing query... - (4.2s)Executing query... \ (4.3s)Executing query... | (4.4s)Executing query... / (4.5s)Executing query... - (4.6s)Executing query... \ (4.7s)Executing query... | (4.8s)Executing query... / (4.9s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.4s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.2s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.6s)Executing query... | (2.7s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.9s)Executing query... | (6.3s)Executing query... / (6.5s)Executing query... - (6.6s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_195916_filtered_tables_result.csvFinished query: except_distinct in 25.67s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260129_195916.csvâœ… All queries completed successfully 
19:59:46.827 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
20:01:09.124 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:01:09.839 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769697069830
20:01:15.183 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
20:01:15.392 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
20:01:50.615 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinct_fullloadâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME NOT IN ('customer',                            'customer_address',                            'customer_address_ext',                            'customer_ext',                            'demographic',                            'news_customer_contract',                            'news_demographic_ex',                            'news_ext_customer_redemption',                            'news_financial_transaction',                            'news_interactions',                            'news_payment_account_ext',                            'order_item',                            'order_item_ext',                            'order_item_note',                            'paybreak',                            'payment',                            'payment_account',                            'payment_reversed_payment',                            'service',                            'service_ext',                            'gbaba_act_xref',                            'ad_custom_fields_export',                            'customers_export',                            'display_ads_export',                            'insert_ads_export',                            'online_ad_export2',                            'order_custom_fields_export',                            'order_export2',                            'order_item_audience_segment',                            'order_item_metadata',                            'order_item_price_item',                            'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.8s)Executing query... / (1.0s)Executing query... - (1.2s)Executing query... \ (1.4s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.4s)Executing query... \ (3.5s)                                             Finished query: except_distinct_fullload in 3.91s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_200146.csvâœ… All queries completed successfully 
20:01:54.461 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct_deltaload.feature
20:02:18.538 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:02:19.290 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769697139284
20:02:23.096 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
20:02:23.160 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
20:02:59.687 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.2s)Executing query... / (1.4s)Executing query... - (1.6s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.4s)Executing query... | (2.6s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.6s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)Executing query... \ (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.6s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.6s)Executing query... | (4.9s)Executing query... / (5.2s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200238_filtered_tables_result.csvFinished query: except_distinct in 20.53s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200238.csvâœ… All queries completed successfully 
20:03:02.574 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
20:05:21.760 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:05:22.496 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769697322486
20:05:26.375 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
20:05:26.633 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
20:05:46.857 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinct_fullloadâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME NOT IN ('customer',                            'customer_address',                            'customer_address_ext',                            'customer_ext',                            'demographic',                            'news_customer_contract',                            'news_demographic_ex',                            'news_ext_customer_redemption',                            'news_financial_transaction',                            'news_interactions',                            'news_payment_account_ext',                            'order_item',                            'order_item_ext',                            'order_item_note',                            'paybreak',                            'payment',                            'payment_account',                            'payment_reversed_payment',                            'service',                            'service_ext',                            'gbaba_act_xref',                            'ad_custom_fields_export',                            'customers_export',                            'display_ads_export',                            'insert_ads_export',                            'online_ad_export2',                            'order_custom_fields_export',                            'order_export2',                            'order_item_audience_segment',                            'order_item_metadata',                            'order_item_price_item',                            'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)                                             Finished query: except_distinct_fullload in 3.81s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_200542.csvâœ… All queries completed successfully 
20:05:49.228 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct_fullload.feature
20:08:35.384 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:08:36.089 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769697516083
20:08:41.866 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
20:08:41.951 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
20:09:21.320 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.3s)Executing query... / (2.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (2.7s)Executing query... \ (2.8s)Executing query... | (2.9s)Executing query... / (3.1s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (1.3s)Executing query... / (1.5s)Executing query... - (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.3s)Executing query... | (3.5s)Executing query... / (4.8s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.4s)Executing query... \ (0.7s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (4.0s)Executing query... | (4.1s)Executing query... / (4.2s)Executing query... - (4.3s)Executing query... \ (4.4s)Executing query... | (4.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.7s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200859_filtered_tables_result.csvFinished query: except_distinct in 21.49s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260129_200859.csvâœ… All queries completed successfully 
20:09:26.742 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
20:18:59.184 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:19:00.549 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769698140525
20:19:10.816 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
20:19:10.926 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
20:20:27.391 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinct_fullloadâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME NOT IN ('customer',                            'customer_address',                            'customer_address_ext',                            'customer_ext',                            'demographic',                            'news_customer_contract',                            'news_demographic_ex',                            'news_ext_customer_redemption',                            'news_financial_transaction',                            'news_interactions',                            'news_payment_account_ext',                            'order_item',                            'order_item_ext',                            'order_item_note',                            'paybreak',                            'payment',                            'payment_account',                            'payment_reversed_payment',                            'service',                            'service_ext',                            'gbaba_act_xref',                            'ad_custom_fields_export',                            'customers_export',                            'display_ads_export',                            'insert_ads_export',                            'online_ad_export2',                            'order_custom_fields_export',                            'order_export2',                            'order_item_audience_segment',                            'order_item_metadata',                            'order_item_price_item',                            'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.6s)Executing query... | (0.9s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.4s)Executing query... | (1.6s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.2s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.3s)Executing query... | (3.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (3.7s)Executing query... - (3.8s)Executing query... \ (4.0s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.3s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (1.1s)Executing query... / (1.3s)Executing query... - (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.3s)Executing query... - (1.7s)Executing query... \ (1.9s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.9s)Executing query... \ (3.3s)Executing query... | (3.5s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (6.2s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (1.0s)Executing query... | (1.2s)Executing query... / (1.4s)Executing query... - (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.9s)Executing query... / (5.0s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_202000_filtered_tables_result.csvFinished query: except_distinct_fullload in 23.91s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260129_202000.csvâœ… All queries completed successfully 
20:20:30.749 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct_fullload.feature
20:21:30.858 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:21:31.519 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769698291512
20:21:36.118 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_deltaload --tablename 'rcti_c*' 
20:21:36.364 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_deltaload --tablename 'rcti_c*' 
20:21:56.824 [1769698296389] WARN  com.intuit.karate.shell.Command - exit code was non-zero: 1 - [python, src/main/python/run_query.py, --query, except_distinct_deltaload, --tablename, rcti_c*] working dir: null
20:21:56.849 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinct_deltaloadâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME IN ('customer',                        'customer_address',                        'customer_address_ext',                        'customer_ext',                        'demographic',                        'news_customer_contract',                        'news_demographic_ex',                        'news_ext_customer_redemption',                        'news_financial_transaction',                        'news_interactions',                        'news_payment_account_ext',                        'order_item',                        'order_item_ext',                        'order_item_note',                        'paybreak',                        'payment',                        'payment_account',                        'payment_reversed_payment',                        'service',                        'service_ext',                        'gbaba_act_xref',                        'ad_custom_fields_export',                        'customers_export',                        'display_ads_export',                        'insert_ads_export',                        'online_ad_export2',                        'order_custom_fields_export',                        'order_export2',                        'order_item_audience_segment',                        'order_item_metadata',                        'order_item_price_item',                        'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.6s)Executing query... - (0.8s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.3s)Executing query... - (1.5s)Executing query... \ (1.7s)Executing query... | (1.9s)Executing query... / (2.1s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.4s)                                             Error running query except_distinct_deltaload: â?Œ No testcases found matching tables starting with 'rcti_c'.Fatal error: â?Œ No testcases found matching tables starting with 'rcti_c'. 
20:21:59.495 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct_deltaload.feature
20:25:26.285 [main] INFO  com.intuit.karate - Karate version: 1.5.1
20:25:27.628 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1769698527622
20:25:32.700 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
20:25:32.841 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
20:26:14.250 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.5s)Executing query... \ (0.6s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.5s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (2.6s)Executing query... / (2.8s)Executing query... - (3.0s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.1s)Executing query... \ (2.2s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.5s)Executing query... \ (2.7s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (4.0s)Executing query... / (4.6s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.1s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)Executing query... | (3.7s)Executing query... / (3.8s)Executing query... - (3.9s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.6s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260129_202553_filtered_tables_result.csvFinished query: except_distinct in 20.84s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260129_202553.csvâœ… All queries completed successfully 
20:26:19.751 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
10:59:59.006 [main] INFO  com.intuit.karate - Karate version: 1.5.1
11:00:00.845 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770010200834
11:00:06.534 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
11:00:06.687 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
11:01:12.290 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.1s)Executing query... / (3.2s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.6s)Executing query... | (0.7s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.3s)Executing query... / (2.4s)Executing query... - (2.6s)Executing query... \ (2.7s)Executing query... | (2.9s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)Executing query... | (3.3s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.8s)Executing query... \ (5.2s)Executing query... | (5.3s)Executing query... / (5.4s)Executing query... - (5.5s)Executing query... \ (5.6s)Executing query... | (5.7s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (1.5s)Executing query... | (1.7s)Executing query... / (1.8s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.0s)Executing query... \ (2.1s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.2s)Executing query... - (3.3s)Executing query... \ (3.4s)Executing query... | (3.5s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.4s)Executing query... / (6.9s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.6s)Executing query... \ (1.7s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (1.8s)Executing query... / (1.9s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260202_110046_filtered_tables_result.csvFinished query: except_distinct in 25.61s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260202_110046.csvâœ… All queries completed successfully 
11:01:15.655 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
18:15:32.004 [main] INFO  com.intuit.karate - Karate version: 1.5.1
18:15:32.900 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770016532892
18:15:39.481 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
18:15:39.550 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
18:16:20.117 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.8s)Executing query... - (0.9s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.6s)Executing query... - (3.7s)Executing query... \ (3.8s)Executing query... | (3.9s)Executing query... / (4.0s)Executing query... - (4.1s)Executing query... \ (4.2s)Executing query... | (4.3s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.6s)Executing query... | (4.7s)Executing query... / (4.8s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)Executing query... - (5.3s)Executing query... \ (5.4s)Executing query... | (5.5s)Executing query... / (5.6s)Executing query... - (5.7s)Executing query... \ (5.8s)Executing query... | (5.9s)Executing query... / (6.0s)Executing query... - (6.1s)Executing query... \ (6.2s)Executing query... | (6.3s)Executing query... / (6.4s)Executing query... - (6.5s)Executing query... \ (6.6s)Executing query... | (6.7s)Executing query... / (6.8s)Executing query... - (6.9s)Executing query... \ (7.0s)Executing query... | (7.1s)Executing query... / (7.2s)Executing query... - (7.3s)Executing query... \ (7.4s)Executing query... | (7.5s)Executing query... / (7.6s)Executing query... - (7.7s)Executing query... \ (7.8s)Executing query... | (7.9s)Executing query... / (8.0s)Executing query... - (8.1s)Executing query... \ (8.2s)Executing query... | (8.3s)Executing query... / (8.4s)Executing query... - (8.5s)Executing query... \ (8.6s)Executing query... | (8.7s)Executing query... / (8.8s)Executing query... - (8.9s)Executing query... \ (9.0s)Executing query... | (9.1s)Executing query... / (9.2s)Executing query... - (9.4s)Executing query... \ (9.5s)Executing query... | (9.6s)Executing query... / (9.7s)Executing query... - (9.8s)Executing query... \ (9.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (10.0s)Executing query... / (10.1s)Executing query... - (10.2s)Executing query... \ (10.3s)Executing query... | (10.4s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 10.74s â†’ output/testcase_results\sdm_rcti_nq_count_20260202_181609.csvâœ… All queries completed successfully 
18:16:22.937 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_count.feature
18:17:35.428 [main] INFO  com.intuit.karate - Karate version: 1.5.1
18:17:36.310 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770016656252
18:17:41.317 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
18:17:41.391 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
18:18:06.545 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.4s)Executing query... \ (0.5s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (0.9s)Executing query... | (1.0s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (1.9s)Executing query... / (2.0s)Executing query... - (2.2s)Executing query... \ (2.3s)Executing query... | (2.4s)Executing query... / (2.5s)Executing query... - (2.7s)Executing query... \ (2.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.5s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260202_181801_schema_diff.csvFinished query: schema_compare in 4.27s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260202_181801.csvâœ… All queries completed successfully 
18:18:10.022 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_schema_compare.feature
18:56:48.165 [main] INFO  com.intuit.karate - Karate version: 1.5.1
18:56:49.307 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770038809296
18:56:53.638 [main] INFO  com.intuit.karate - [print] Inside schema_compare.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
18:56:53.766 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query schema_compare 
18:57:20.279 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: schema_compareâ–¶ Generated SQL:WITH prod_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     sit_schema AS  (SELECT TABLE_NAME,          COLUMN_NAME,          data_type,          is_nullable   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`),     all_columns AS  (-- Get all unique table/column combinations from both datasets SELECT TABLE_NAME,        COLUMN_NAME   FROM prod_schema   UNION DISTINCT SELECT TABLE_NAME,                         COLUMN_NAME   FROM sit_schema)SELECT c.table_name,       c.column_name,       p.data_type AS prod_type,       n.data_type AS prod_nq_type,       p.is_nullable AS prod_nullable,       n.is_nullable AS prod_nq_nullable,       CASE           WHEN p.data_type IS DISTINCT                FROM n.data_type THEN 'TYPE_MISMATCH'           WHEN p.is_nullable IS DISTINCT                FROM n.is_nullable THEN 'NULLABILITY_MISMATCH'           ELSE 'MATCH'       END AS diff_statusFROM all_columns cLEFT JOIN prod_schema p ON c.table_name = p.table_nameAND c.column_name = p.column_nameLEFT JOIN sit_schema n ON c.table_name = n.table_nameAND c.column_name = n.column_nameWHERE c.table_name NOT IN ('cart',                           'order',                           'customer',                           'customer_address')ORDER BY c.table_name,         c.column_name;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.9s)Executing query... / (1.2s)Executing query... - (1.3s)Executing query... \ (1.4s)Executing query... | (1.5s)Executing query... / (1.6s)Executing query... - (1.8s)Executing query... \ (2.0s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.8s)Executing query... - (2.9s)Executing query... \ (3.0s)Executing query... | (3.1s)Executing query... / (3.3s)Executing query... - (3.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (3.5s)Executing query... | (3.6s)Executing query... / (3.7s)Executing query... - (3.8s)                                             ðŸ“? Schema differences saved: output/failed_testcases\sdm_rcti_nq_schema_compare_20260202_185714_schema_diff.csvFinished query: schema_compare in 4.87s â†’ output/testcase_results\sdm_rcti_nq_schema_compare_20260202_185714.csvâœ… All queries completed successfully 
18:57:22.903 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_schema_compare.feature
18:57:53.186 [main] INFO  com.intuit.karate - Karate version: 1.5.1
18:57:54.335 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770038874328
18:57:59.140 [main] INFO  com.intuit.karate - [print] Inside count.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
18:57:59.522 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query count 
18:58:26.438 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: countâ–¶ Generated SQL:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order')ORDER BY 1,         3;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.6s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.1s)Executing query... / (2.2s)Executing query... - (2.3s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.4s)Executing query... / (3.5s)Executing query... - (3.6s)Executing query... \ (3.7s)Executing query... | (3.8s)Executing query... / (3.9s)Executing query... - (4.0s)Executing query... \ (4.1s)Executing query... | (4.2s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.5s)Executing query... | (4.6s)Executing query... / (4.7s)Executing query... - (4.8s)Executing query... \ (4.9s)Executing query... | (5.0s)Executing query... / (5.1s)Executing query... - (5.2s)Executing query... \ (5.3s)Executing query... | (5.4s)Executing query... / (5.5s)Executing query... - (5.6s)Executing query... \ (5.7s)Executing query... | (5.8s)Executing query... / (5.9s)Executing query... - (6.0s)Executing query... \ (6.1s)Executing query... | (6.2s)Executing query... / (6.3s)Executing query... - (6.4s)Executing query... \ (6.5s)Executing query... | (6.6s)Executing query... / (6.7s)Executing query... - (6.8s)Executing query... \ (6.9s)Executing query... | (7.0s)Executing query... / (7.1s)Executing query... - (7.2s)Executing query... \ (7.3s)Executing query... | (7.4s)Executing query... / (7.5s)Executing query... - (7.6s)Executing query... \ (7.7s)Executing query... | (7.8s)Executing query... / (7.9s)Executing query... - (8.0s)Executing query... \ (8.1s)Executing query... | (8.2s)Executing query... / (8.3s)Executing query... - (8.4s)Executing query... \ (8.5s)Executing query... | (8.6s)Executing query... / (8.7s)Executing query... - (8.8s)Executing query... \ (8.9s)Executing query... | (9.0s)Executing query... / (9.1s)Executing query... - (9.2s)Executing query... \ (9.3s)Executing query... | (9.4s)Executing query... / (9.5s)Executing query... - (9.6s)Executing query... \ (9.7s)Executing query... | (9.8s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (9.9s)Executing query... - (10.0s)Executing query... \ (10.1s)Executing query... | (10.2s)                                             âš ï¸? Saved count mismatch SQL â†’ output/failed_testcases\sdm_rcti_nq_count_mismatch.sqlâ?Œ DIFF FOUNDâ–¶ SQL Preview:WITH prod AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-04') AND DATE('2025-11-09')),     prod_nq AS  (SELECT TABLE_NAME,          PARSE_DATE('%Y%m%d', partition_id) AS partition_date,          total_rows   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.PARTITIONS`   WHERE partition_id NOT LIKE '%NULL%'     AND PARSE_DATE('%Y%m%d', partition_id) BETWEEN DATE('2025-11-05') AND DATE('2025-11-10')),     info_table AS  (SELECT TABLE_NAME   FROM `ncau-data-newsquery-sit.sdm_rcti_nq.INFORMATION_SCHEMA.TABLES`)SELECT i.table_name,       a.partition_date AS sit_prtn_date,       b.partition_date AS prd_prtn_date,       a.total_rows AS sit_count,       b.total_rows AS prd_count,       a.total_rows - b.total_rows AS diffFROM info_table iLEFT JOIN prod_nq a ON i.table_name = a.table_nameLEFT JOIN prod b ON i.table_name = b.table_nameWHERE i.table_name NOT IN ('cart',                           'order')ORDER BY 1,         3;--------------------------------------------------------------------------------Finished query: count in 10.58s â†’ output/testcase_results\sdm_rcti_nq_count_20260202_185815.csvâœ… All queries completed successfully 
18:58:30.581 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_count.feature
18:59:13.586 [main] INFO  com.intuit.karate - Karate version: 1.5.1
18:59:14.295 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770038954285
18:59:17.743 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
18:59:17.788 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct --tablename 'rcti_c*' 
18:59:57.233 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinctâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.5s)Executing query... - (0.7s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.2s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.8s)Executing query... \ (1.9s)Executing query... | (2.0s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.6s)Executing query... | (2.8s)Executing query... / (3.0s)Executing query... - (3.1s)Executing query... \ (3.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.6s)Executing query... \ (3.7s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.7s)Executing query... | (1.8s)Executing query... / (1.9s)Executing query... - (2.1s)Executing query... \ (2.4s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.7s)Executing query... \ (3.0s)Executing query... | (3.3s)Executing query... / (4.5s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.6s)Executing query... / (0.7s)Executing query... - (0.8s)Executing query... \ (1.0s)Executing query... | (1.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (1.3s)Executing query... - (1.5s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.6s)Executing query... / (0.9s)Executing query... - (1.4s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (2.0s)Executing query... - (2.5s)Executing query... \ (2.7s)Executing query... | (2.8s)Executing query... / (3.0s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (4.0s)Executing query... / (4.4s)Executing query... - (4.5s)Executing query... \ (4.7s)Executing query... | (4.9s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_20260202_185933_filtered_tables_result.csvFinished query: except_distinct in 22.63s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_20260202_185933.csvâœ… All queries completed successfully 
18:59:59.836 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct.feature
19:00:56.328 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:00:57.203 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770039057192
19:01:00.556 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
19:01:00.675 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_fullload --tablename 'rcti_c*' 
19:01:40.712 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinct_fullloadâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME NOT IN ('customer',                            'customer_address',                            'customer_address_ext',                            'customer_ext',                            'demographic',                            'news_customer_contract',                            'news_demographic_ex',                            'news_ext_customer_redemption',                            'news_financial_transaction',                            'news_interactions',                            'news_payment_account_ext',                            'order_item',                            'order_item_ext',                            'order_item_note',                            'paybreak',                            'payment',                            'payment_account',                            'payment_reversed_payment',                            'service',                            'service_ext',                            'gbaba_act_xref',                            'ad_custom_fields_export',                            'customers_export',                            'display_ads_export',                            'insert_ads_export',                            'online_ad_export2',                            'order_custom_fields_export',                            'order_export2',                            'order_item_audience_segment',                            'order_item_metadata',                            'order_item_price_item',                            'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.8s)Executing query... \ (1.0s)Executing query... | (1.1s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.8s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (2.6s)Executing query... | (2.8s)Executing query... / (2.9s)                                             âœ… Running testcases for tables starting with 'rcti_c'Executing EXCEPT DISTINCT testcases...â–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.7s)Executing query... / (1.1s)Executing query... - (1.2s)Executing query... \ (1.3s)Executing query... | (1.4s)Executing query... / (1.5s)Executing query... - (1.6s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_caltex_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_caltex_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_caltex_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.3s)Executing query... \ (0.4s)Executing query... | (0.5s)Executing query... / (0.6s)Executing query... - (0.7s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.5s)Executing query... - (1.7s)Executing query... \ (1.8s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.5s)Executing query... | (2.6s)Executing query... / (2.7s)Executing query... - (2.8s)Executing query... \ (2.9s)Executing query... | (3.0s)Executing query... / (3.1s)Executing query... - (3.2s)Executing query... \ (3.3s)Executing query... | (3.5s)Executing query... / (3.6s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_bluebook_ext.sqlâ?Œ Testcase failed â†’ 9167 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)                                             âœ” Testcase passed â†’ no differences foundâ–¶â–¶â–¶ Running testcase [prod-SIT] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)Executing query... / (1.7s)Executing query... - (1.9s)Executing query... \ (2.0s)Executing query... | (2.2s)Executing query... / (2.3s)Executing query... - (2.4s)Executing query... \ (2.6s)Executing query... | (2.8s)Executing query... / (2.9s)Executing query... - (3.0s)Executing query... \ (3.1s)Executing query... | (3.3s)Executing query... / (3.4s)Executing query... - (3.6s)Executing query... \ (3.9s)Executing query... | (4.1s)Executing query... / (4.3s)Executing query... - (4.4s)Executing query... \ (4.5s)Executing query... | (4.6s)Executing query... / (4.7s)Executing query... - (4.9s)Executing query... \ (5.0s)Executing query... | (5.1s)Executing query... / (5.2s)                                             âš ï¸? Saved failing SQL â†’ output/failed_testcases\prod-SIT_rcti_coles_sm_bluebook_ext.sqlâ?Œ Testcase failed â†’ 11486 differing row(s) foundâ–¶â–¶â–¶ Running testcase [SIT-prod] for table â†’ rcti_coles_sm_bluebook_ext â–¶â–¶â–¶â–¶ Generated SQL:SELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-sit.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-05" AND "2025-11-10"EXCEPT DISTINCTSELECT "rcti_coles_sm_bluebook_ext" AS TABLE_NAME,       `pubid`,       `pubdate`,       `routeid`,       `periodsalescharge`,       `perioddrawcopycount`,       `periodsalescopycount`,       `periodreturns`,       `periodchargerate`,       `periodrevenuecharge`,       `periodreturnscharge`,       `prevperioddrawcopycount`,       `prevperiodsalescopycount`,       `prevperiodreturns`,       `prevperiodchargerate`,       `prevperiodrevenuecharge`,       `prevperiodreturnscharge`FROM `ncau-data-newsquery-prd.sdm_rcti_nq.rcti_coles_sm_bluebook_ext`WHERE dw_partition_date BETWEEN "2025-11-04" AND "2025-11-09";--------------------------------------------------------------------------------Executing query... | (0.0s)Executing query... / (0.1s)Executing query... - (0.2s)Executing query... \ (0.3s)Executing query... | (0.4s)Executing query... / (0.5s)Executing query... - (0.6s)Executing query... \ (0.7s)Executing query... | (0.8s)Executing query... / (0.9s)Executing query... - (1.0s)Executing query... \ (1.1s)Executing query... | (1.2s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... / (1.3s)Executing query... - (1.4s)Executing query... \ (1.5s)Executing query... | (1.6s)                                             âœ” Testcase passed â†’ no differences foundðŸ“? Filtered dataset results saved: output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260202_190118_filtered_tables_result.csvFinished query: except_distinct_fullload in 21.47s â†’ output/testcase_results\sdm_rcti_nq_except_distinct_fullload_20260202_190118.csvâœ… All queries completed successfully 
19:01:43.088 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct_fullload.feature
19:02:27.158 [main] INFO  com.intuit.karate - Karate version: 1.5.1
19:02:28.245 [main] INFO  com.intuit.karate.Suite - backed up existing 'target\karate-reports' dir to: target\karate-reports_1770039148235
19:02:33.498 [main] INFO  com.intuit.karate - [print] Inside except_distinct.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_deltaload --tablename 'rcti_c*' 
19:02:33.567 [main] INFO  com.intuit.karate - [print] Inside run-query.feature: pythonCmd ===>  python src/main/python/run_query.py --query except_distinct_deltaload --tablename 'rcti_c*' 
19:02:54.954 [1770039153830] WARN  com.intuit.karate.shell.Command - exit code was non-zero: 1 - [python, src/main/python/run_query.py, --query, except_distinct_deltaload, --tablename, rcti_c*] working dir: null
19:02:55.039 [main] INFO  com.intuit.karate - [print] result ===>  Starting query execution framework...Running query: except_distinct_deltaloadâ–¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME IN ('customer',                        'customer_address',                        'customer_address_ext',                        'customer_ext',                        'demographic',                        'news_customer_contract',                        'news_demographic_ex',                        'news_ext_customer_redemption',                        'news_financial_transaction',                        'news_interactions',                        'news_payment_account_ext',                        'order_item',                        'order_item_ext',                        'order_item_note',                        'paybreak',                        'payment',                        'payment_account',                        'payment_reversed_payment',                        'service',                        'service_ext',                        'gbaba_act_xref',                        'ad_custom_fields_export',                        'customers_export',                        'display_ads_export',                        'insert_ads_export',                        'online_ad_export2',                        'order_custom_fields_export',                        'order_export2',                        'order_item_audience_segment',                        'order_item_metadata',                        'order_item_price_item',                        'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-04', '" AND "', '2025-11-09', '" ', ' EXCEPT DISTINCT ', 'SELECT "', TABLE_NAME, '" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN "', '2025-11-05', '" AND "', '2025-11-10', '";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... / (0.2s)Executing query... - (0.4s)Executing query... \ (0.8s)Executing query... | (0.9s)Executing query... / (1.0s)Executing query... - (1.1s)Executing query... \ (1.2s)Executing query... | (1.3s)Executing query... / (1.4s)Executing query... - (1.5s)Executing query... \ (1.6s)Executing query... | (1.7s)Executing query... / (1.8s)Executing query... - (2.0s)Executing query... \ (2.3s)Executing query... | (2.5s)Executing query... / (2.6s)Executing query... - (2.8s)Executing query... \ (2.9s)D:\Users\ganesany\AppData\Roaming\Python\Python311\site-packages\google\cloud\bigquery\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.2s)Executing query... / (3.3s)Executing query... - (3.4s)Executing query... \ (3.5s)                                             Error running query except_distinct_deltaload: â?Œ No testcases found matching tables starting with 'rcti_c'.Fatal error: â?Œ No testcases found matching tables starting with 'rcti_c'. 
19:02:58.621 [main] INFO  com.intuit.karate.Suite - <<pass>> feature 1 of 1 (0 remaining) features/test_except_distinct_deltaload.feature
