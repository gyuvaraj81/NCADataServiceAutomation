{"failedCount":0,"prefixedPath":"features\/test_except_distinct_deltaload.feature","packageQualifiedName":"features.test_except_distinct_deltaload","loopIndex":-1,"relativePath":"features\/test_except_distinct_deltaload.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":3947786,"startTime":1770039153273,"endTime":1770039153277,"millis":3.947786,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def query = 'except_distinct_deltaload'"}},{"result":{"nanos":190044270,"startTime":1770039153282,"endTime":1770039153472,"millis":190.04427,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":1,"text":"def tablename = karate.properties['tablename'] ? karate.properties['tablename'] : '*'"}},{"result":{"nanos":17795351,"startTime":1770039153474,"endTime":1770039153492,"millis":17.795351,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":2,"text":"def pythonCmd = buildPythonCmd(query, tablename)"}},{"result":{"nanos":24768491,"startTime":1770039153492,"endTime":1770039153517,"millis":24.768491,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":3,"text":"print 'Inside except_distinct.feature: pythonCmd ===> ',pythonCmd"},"stepLog":"19:02:33.515 [print] Inside except_distinct.feature: pythonCmd ===>  python src\/main\/python\/run_query.py --query except_distinct_deltaload --tablename 'rcti_c*' \n"},{"result":{"nanos":21791758146,"startTime":1770039153518,"endTime":1770039175310,"millis":21791.758146,"status":"passed"},"step":{"line":11,"prefix":"*","index":0,"text":"call read('run-query.feature')"},"callResults":[{"failedCount":0,"prefixedPath":"features\/run-query.feature","packageQualifiedName":"features.run-query","loopIndex":-1,"relativePath":"features\/run-query.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":230236490,"startTime":1770039153566,"endTime":1770039153796,"millis":230.23649,"status":"passed"},"step":{"comments":["# Run the Python script"],"line":5,"prefix":"*","index":0,"text":"print 'Inside run-query.feature: pythonCmd ===> ', pythonCmd"},"stepLog":"19:02:33.795 [print] Inside run-query.feature: pythonCmd ===>  python src\/main\/python\/run_query.py --query except_distinct_deltaload --tablename 'rcti_c*' \n"},{"result":{"nanos":21238912363,"startTime":1770039153796,"endTime":1770039175035,"millis":21238.912363,"status":"passed"},"step":{"line":6,"prefix":"*","index":1,"text":"def result = karate.exec(pythonCmd)"}},{"result":{"nanos":77928850,"startTime":1770039175036,"endTime":1770039175114,"millis":77.92885,"status":"passed"},"step":{"line":7,"prefix":"*","index":2,"text":"print 'result ===> ', result"},"stepLog":"19:02:55.055 [print] result ===>  Starting query execution framework...Running query: except_distinct_deltaloadâ\u2013¶ Generated SQL:WITH table_info AS  (SELECT table_catalog,          table_schema,          TABLE_NAME,          STRING_AGG(CONCAT('`', COLUMN_NAME, '`'), ','                     ORDER BY ordinal_position) AS columns   FROM `ncau-data-newsquery-prd.sdm_rcti_nq.INFORMATION_SCHEMA.COLUMNS`   WHERE COLUMN_NAME NOT IN ('nq_batch_id',                             'dgw_batch_id',                             'dw_batch_id',                             'dw_ingest_time',                             'dw_partition_date',                             'dw_publish_time',                             'dw_source_object_name',                             'soft_error_fields',                             'extra_data_payload')     AND TABLE_NAME NOT IN ('appc_send_log',                            'appc_send_log_0715',                            'contactsf',                            'emailobject',                            'pushmessagedetail',                            'smsdetailsummary',                            'cart',                            'order')     AND TABLE_NAME IN ('customer',                        'customer_address',                        'customer_address_ext',                        'customer_ext',                        'demographic',                        'news_customer_contract',                        'news_demographic_ex',                        'news_ext_customer_redemption',                        'news_financial_transaction',                        'news_interactions',                        'news_payment_account_ext',                        'order_item',                        'order_item_ext',                        'order_item_note',                        'paybreak',                        'payment',                        'payment_account',                        'payment_reversed_payment',                        'service',                        'service_ext',                        'gbaba_act_xref',                        'ad_custom_fields_export',                        'customers_export',                        'display_ads_export',                        'insert_ads_export',                        'online_ad_export2',                        'order_custom_fields_export',                        'order_export2',                        'order_item_audience_segment',                        'order_item_metadata',                        'order_item_price_item',                        'order_items')   GROUP BY table_catalog,            table_schema,            TABLE_NAME)SELECT 'SIT-prod' AS scenario,       TABLE_NAME,       CONCAT('SELECT \"', TABLE_NAME, '\" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN \"', '2025-11-05', '\" AND \"', '2025-11-10', '\" ', ' EXCEPT DISTINCT ', 'SELECT \"', TABLE_NAME, '\" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN \"', '2025-11-04', '\" AND \"', '2025-11-09', '\";') AS testcaseFROM table_infoUNION ALLSELECT 'prod-SIT' AS scenario,       TABLE_NAME,       CONCAT('SELECT \"', TABLE_NAME, '\" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-prd', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN \"', '2025-11-04', '\" AND \"', '2025-11-09', '\" ', ' EXCEPT DISTINCT ', 'SELECT \"', TABLE_NAME, '\" AS table_name, ', columns, ' FROM `', 'ncau-data-newsquery-sit', '.', 'sdm_rcti_nq', '.', TABLE_NAME, '` ', 'WHERE dw_partition_date BETWEEN \"', '2025-11-05', '\" AND \"', '2025-11-10', '\";') AS testcaseFROM table_infoORDER BY TABLE_NAME;Executing query... | (0.0s)Executing query... \/ (0.2s)Executing query... - (0.4s)Executing query... \\ (0.8s)Executing query... | (0.9s)Executing query... \/ (1.0s)Executing query... - (1.1s)Executing query... \\ (1.2s)Executing query... | (1.3s)Executing query... \/ (1.4s)Executing query... - (1.5s)Executing query... \\ (1.6s)Executing query... | (1.7s)Executing query... \/ (1.8s)Executing query... - (2.0s)Executing query... \\ (2.3s)Executing query... | (2.5s)Executing query... \/ (2.6s)Executing query... - (2.8s)Executing query... \\ (2.9s)D:\\Users\\ganesany\\AppData\\Roaming\\Python\\Python311\\site-packages\\google\\cloud\\bigquery\\table.py:1994: UserWarning: BigQuery Storage module not found, fetch data with the REST endpoint instead.  warnings.warn(Executing query... | (3.2s)Executing query... \/ (3.3s)Executing query... - (3.4s)Executing query... \\ (3.5s)                                             Error running query except_distinct_deltaload: â�Œ No testcases found matching tables starting with 'rcti_c'.Fatal error: â�Œ No testcases found matching tables starting with 'rcti_c'. \n"}],"executorName":"main","line":3,"name":"Execute run-query.py and check output files","description":"","durationMillis":21547.077703,"startTime":1770039153565,"failed":false,"refId":"[1:3]","endTime":1770039175114,"exampleIndex":-1}],"callDepth":1,"name":"Run run-query.py and verify outputs","description":"","resultDate":"2026-02-02 07:02:55 pm","durationMillis":21547.077703,"passedCount":1}]}],"line":10,"description":"","durationMillis":22028.314044,"failed":false,"tags":["regression"],"executorName":"main","name":"SIT and PROD counts must match","startTime":1770039152679,"refId":"[1:10]","endTime":1770039175310,"exampleIndex":-1}],"callDepth":0,"name":"Validate row data","description":"","resultDate":"2026-02-02 07:02:55 pm","durationMillis":22028.314044,"passedCount":1}